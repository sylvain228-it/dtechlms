import{j as e,R as o,r as V,L as C,a as T}from"./app-CjIWy3eH.js";import{S as P}from"./form-SFwPvtEA.js";import{B as n}from"./button-CExzQmZc.js";import{C as h}from"./checkbox-BgoqiFgf.js";import{D as w,a as v,b as S,c as I,d as z,e as c,f as A,g as p}from"./dropdown-menu-DUsmAPKS.js";import{u as _,T as E,a as H,b as u,c as L,f as j,d as K,e as f,E as B,g as O,h as U,i as $,j as q}from"./table-ChSHwvVD.js";import{s as g,h as G}from"./tasks-gWUZeaAY.js";import{z as J,A as Q,j as W}from"./type-DDACwUq3.js";import{c as X,e as Y,s as Z,d as ee}from"./index-CU8SWGOj.js";import{F as se}from"./index-lBAoiumE.js";import{F as te}from"./index-BijvCOwp.js";import{I as ie,b as le}from"./index-B6s6UZ6a.js";import{M as ae}from"./index-CHnKU68i.js";import{C as re}from"./chevron-down-B3Mn7iN-.js";import"./app-DfLmVDUM.js";import"./index-C4soMqjN.js";import"./index-BnYBuebb.js";import"./utils-AnTb9DBe.js";import"./index-OYVf1Zwz.js";import"./index-DnZUlvAx.js";import"./index-WBmQTPp2.js";import"./index-DdCDBdhx.js";import"./check-C6ufmhQW.js";import"./createLucideIcon-i13MEz2U.js";import"./index-aXAQScOB.js";import"./index-CgNbq55-.js";import"./index-Cx1mEBwh.js";import"./index-CPWTBhsT.js";import"./index-DIo9abDA.js";import"./index-DLvqQGle.js";import"./index-BqTge0le.js";import"./index-CMWG4mbA.js";import"./lexical-headless-BCA5NgA9.js";import"./nodes-B8QjlgCe.js";import"./iconBase-ZLoFHiO_.js";const b=[{id:"select",header:({table:s})=>e.jsx(h,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:i=>s.toggleAllPageRowsSelected(!!i),"aria-label":"Sélectionner tout"}),cell:({row:s})=>e.jsx(h,{checked:s.getIsSelected(),onCheckedChange:i=>s.toggleSelected(!!i),"aria-label":"Sélectionner la ligne"}),enableSorting:!1,enableHiding:!1},{accessorKey:"title",header:"Titre",cell:({row:s})=>e.jsx("div",{className:"capitalize",children:g(s.getValue("title"),0,40)})},{accessorKey:"scope",header:"Portée",cell:({row:s})=>e.jsx("div",{className:"capitalize",children:g(Q(s.getValue("scope")),0,20)})},{accessorKey:"is_visible",header:"Visibilité",cell:({row:s})=>e.jsx("div",{className:`capitalize ${s.getValue("is_visible")==1?"text-green-600":"text-red-600"}`,children:s.getValue("is_visible")==1?"Visible":"Invisible"})},{accessorKey:"activity_type",header:"Type",cell:({row:s})=>e.jsx("div",{className:"capitalize",children:g(W(s.getValue("activity_type")),0,20)})},{id:"actions",enableHiding:!1,cell:({row:s})=>{const i=s.original,d=i.parent_course?Y([i.parent_course?.slug??"",i.slug]).url:"#";function m(a){a.preventDefault(),confirm("Êtes-vous sûr de vouloir supprimer cette lesson ?")&&i.parent_course&&T.delete(ee([i.parent_course?.id??"",i.id]))}return e.jsxs(w,{children:[e.jsx(v,{asChild:!0,children:e.jsxs(n,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Ouvrir"}),e.jsx(B,{})]})}),e.jsxs(S,{align:"end",children:[e.jsx(z,{children:"Actions"}),e.jsx(c,{onClick:()=>navigator.clipboard.writeText(i.title),children:"Copier le titre"}),e.jsx(A,{}),e.jsx(C,{href:i.parent_course?Z([i.parent_course?.slug??"",i.id]):"#",children:e.jsxs(c,{children:["Détails",e.jsx(p,{children:e.jsx(te,{className:"text-blue-500"})})]})}),e.jsxs(c,{onClick:a=>G(a,i.resources_summary??"",d),children:["Modifier",e.jsx(p,{children:e.jsx(se,{className:"text-blue-500"})})]}),e.jsxs(c,{onClick:m,children:["Supprimer",e.jsx(p,{children:e.jsx(ae,{className:"text-red-500"})})]})]})]})}}];function Be({activities:s,course:i}){const[d,m]=o.useState([]),[a,x]=o.useState(void 0),[y,N]=o.useState([]),[M,R]=o.useState({}),[D,k]=o.useState({}),F=V.useMemo(()=>a?(s||[]).filter(t=>t.scope==a):s,[s,a]),l=_({data:F,columns:b,onSortingChange:m,onColumnFiltersChange:N,getCoreRowModel:q(),getPaginationRowModel:$(),getSortedRowModel:U(),getFilteredRowModel:O(),onColumnVisibilityChange:R,onRowSelectionChange:k,state:{sorting:d,columnFilters:y,columnVisibility:M,rowSelection:D}});return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"mb-3 flex flex-col justify-between gap-2 lg:flex-row lg:gap-4",children:[e.jsxs("div",{className:"flex w-full flex-col items-center justify-between gap-4 sm:flex-row",children:[e.jsx("input",{placeholder:"Filtrer par titre...",value:l.getColumn("title")?.getFilterValue()??"",onChange:t=>l.getColumn("title")?.setFilterValue(t.target.value),className:"form-input w-full"}),e.jsxs(w,{children:[e.jsx(v,{asChild:!0,children:e.jsxs(n,{variant:"outline",children:["Colonne ",e.jsx(re,{})]})}),e.jsx(S,{align:"end",children:l.getAllColumns().filter(t=>t.getCanHide()).map(t=>e.jsx(I,{className:"capitalize",checked:t.getIsVisible(),onCheckedChange:r=>t.toggleVisibility(!!r),children:t.id},t.id))})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(C,{href:X(i.slug),className:"btn-primary flex w-full items-center justify-center bg-app-blue !py-1 text-center text-white",children:["Ajouter ",e.jsx(ie,{size:30})]})})]}),e.jsxs("div",{className:"my-4 flex items-center gap-6",children:[e.jsx("div",{className:"w-full",children:e.jsx(P,{options:J,label:"",emptyOption:"Filtrer par portée",value:a??"",onChange:t=>{t!=a&&x(t)}})}),a&&e.jsx(n,{onClick:()=>{x(void 0)},className:"mt-2 bg-red-100 p-2",children:e.jsx(le,{size:25,className:"text-red-500"})})]}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs(E,{children:[e.jsx(H,{children:l.getHeaderGroups().map(t=>e.jsx(u,{children:t.headers.map(r=>e.jsx(L,{children:r.isPlaceholder?null:j(r.column.columnDef.header,r.getContext())},r.id))},t.id))}),e.jsx(K,{children:l.getRowModel().rows?.length?l.getRowModel().rows.map(t=>e.jsx(u,{"data-state":t.getIsSelected()&&"selected",children:t.getVisibleCells().map(r=>e.jsx(f,{children:j(r.column.columnDef.cell,r.getContext())},r.id))},t.id)):e.jsx(u,{children:e.jsx(f,{colSpan:b.length,className:"h-24 text-center",children:"Pas de résultats."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsxs("div",{className:"flex-1 text-sm text-muted-foreground",children:[l.getFilteredSelectedRowModel().rows.length," sur"," ",l.getFilteredRowModel().rows.length," ligne(s) sélectionné(s)."]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>l.previousPage(),disabled:!l.getCanPreviousPage(),children:"Précédent"}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>l.nextPage(),disabled:!l.getCanNextPage(),children:"Suivant"})]})]})]})}export{b as columns,Be as default};

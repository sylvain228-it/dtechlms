import{R as a,j as e}from"./app-klcUL3EL.js";import{B as f}from"./button-Bh8WI1Ty.js";import{b as _,I as T,a as g}from"./input-group-BmzAthWK.js";import{S as j}from"./spinner-2t8r_D1R.js";import{a as U,s as A}from"./index-DIHBWcL6.js";import{S as y}from"./search-lzJ3zhHt.js";import"./app-Ci7uHgFL.js";import"./index-A7wesXx6.js";import"./index-Ds5qzORP.js";import"./index-CyaJm5Nq.js";import"./utils-e8IeQt0G.js";import"./input-DzuxS5O4.js";import"./createLucideIcon-DknjQr1d.js";import"./index-CMWG4mbA.js";function F({teacherId:d}){const[b,v]=a.useState(""),[s,u]=a.useState(void 0),[m,l]=a.useState(!1),[h,c]=a.useState(!1),[p,n]=a.useState(null);async function S(t){try{l(!0);const r=await(await fetch(`${A().url}?search_key=${t}`,{method:"GET"})).json();console.log("result",r),l(!1),r.user?(u(r.user),n(null)):(console.error("Utilisateur non trouvé"),console.error("result.message",r.message),n(r.message||"Utilisateur non trouvé"),u(void 0))}catch(o){n("Une erreur est survenue lors de la recherche."),l(!1),console.error("Erreur",o)}}function N(){S(b)}function w(t){if(t.preventDefault(),!s||!d)return;c(!0);const o={user_id:s.id,teacher_id:d};async function r(){try{const i=await fetch(`${U().url}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify(o)}),x=await i.json();console.log("result",x),c(!1),i.status===200?window.location.reload():(console.error("Échec de l'assignation"),n(x.message||"Échec de l'assignation"))}catch(i){c(!1),console.error("Erreur",i)}}r()}return e.jsxs("div",{className:"mt-6 border-t border-gray-100 pt-6",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-gray-700",children:"Assigner ce profil à un utilisateur"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Cette fonctionnalité permet d'associer ce profil d'enseignant à un compte utilisateur existant sur la plateforme."}),e.jsxs("div",{className:"mt-4",children:[e.jsxs(_,{className:"mb-3 w-full rounded-3xl py-5 focus:outline-0 focus-visible:outline-0",children:[e.jsx(T,{name:"search_key",onChange:t=>v(t.target.value),placeholder:"Entrer son numéro ou son email"}),e.jsx(g,{children:e.jsx(y,{})}),e.jsx(g,{align:"inline-end",children:e.jsxs(f,{disabled:m,className:"btn-primary",onClick:N,children:[m&&e.jsx(j,{}),e.jsx(y,{}),"Vérifier"]})})]}),s&&e.jsx("div",{className:"mb-4 rounded-lg border border-gray-200 bg-gray-50 p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email}),e.jsx("p",{className:"text-sm text-gray-500",children:s.phone_number})]}),e.jsx("div",{className:"rounded-full bg-green-100 p-2",children:e.jsx("svg",{className:"h-5 w-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}),p&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-200 bg-red-50 p-4 shadow-sm",children:e.jsx("p",{className:"text-sm text-red-600",children:p})}),s&&e.jsx("form",{method:"POST",onSubmit:w,children:e.jsxs(f,{disabled:h,type:"submit",className:"btn-primary",children:[h&&e.jsx(j,{}),"Assigner un utilisateur"]})})]})]})}export{F as default};

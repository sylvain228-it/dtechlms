import{R as n,j as e}from"./app-BzXwBPBx.js";import{B as f}from"./button-DpCkL2lj.js";import{b as _,I as C,a as g}from"./input-group-eor9wxyn.js";import{S as j}from"./spinner-CIZwnsdn.js";import{a as E,s as T}from"./index-BqTge0le.js";import{S as y}from"./search-N_1dfqU-.js";import"./app-BlAWqAGg.js";import"./index-D1DaFm8C.js";import"./index-CmvPZPYG.js";import"./index-CyaJm5Nq.js";import"./utils-e8IeQt0G.js";import"./input-Dbi88rSi.js";import"./createLucideIcon-BboBuA9R.js";import"./index-CMWG4mbA.js";function F({course:a}){const[b,S]=n.useState(""),[s,u]=n.useState(void 0),[m,c]=n.useState(!1),[h,d]=n.useState(!1),[p,o]=n.useState(null);async function v(r){try{c(!0);const t=await(await fetch(`${T(a.slug).url}?search_key=${r.toLowerCase()}`,{method:"GET"})).json();console.log("result",t),c(!1),t.student?(u(t.student),o(null)):(console.error("Etudiant non trouvé"),console.error("result.message",t.message),o(t.message||"Etudiant non trouvé"),u(void 0))}catch(i){o("Une erreur est survenue lors de la recherche."),c(!1),console.error("Erreur",i)}}function N(){v(b)}function w(r){if(r.preventDefault(),!s||!a)return;d(!0);const i={student_id:s.id,course_id:a.id};async function t(){try{const l=await fetch(`${E(a.slug).url}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify(i)}),x=await l.json();console.log("result",x),d(!1),l.status===200?window.location.reload():(console.error("Échec de l'assignation"),o(x.message||"Échec de l'assignation"))}catch(l){d(!1),console.error("Erreur",l)}}t()}return e.jsxs("div",{className:"mt-6 border-t border-gray-100 pt-6",children:[e.jsx("h3",{className:"mb-3 text-xl font-semibold text-gray-700",children:"Assigner ce cours à un étudiant"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Cette fonctionnalité permet d'associer ce cours à un étudiant existant sur la plateforme."}),e.jsxs("div",{className:"mt-4",children:[e.jsxs(_,{className:"mb-3 w-full rounded-3xl py-5 focus:outline-0 focus-visible:outline-0",children:[e.jsx(C,{name:"search_key",onChange:r=>S(r.target.value),placeholder:"Entrer son numéro ou son email"}),e.jsx(g,{children:e.jsx(y,{})}),e.jsx(g,{align:"inline-end",children:e.jsxs(f,{disabled:m,className:"btn-primary",onClick:N,children:[m&&e.jsx(j,{}),e.jsx(y,{}),"Vérifier"]})})]}),s&&e.jsx("div",{className:"mb-4 rounded-lg border border-gray-200 bg-gray-50 p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email}),e.jsx("p",{className:"text-sm text-gray-500",children:s.phone_number})]}),e.jsx("div",{className:"rounded-full bg-green-100 p-2",children:e.jsx("svg",{className:"h-5 w-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}),p&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-200 bg-red-50 p-4 shadow-sm",children:e.jsx("p",{className:"text-sm text-red-600",children:p})}),s&&e.jsx("form",{method:"POST",onSubmit:w,children:e.jsxs(f,{disabled:h,type:"submit",className:"btn-primary",children:[h&&e.jsx(j,{}),"Associer l'étudiant(e)"]})})]})]})}export{F as default};

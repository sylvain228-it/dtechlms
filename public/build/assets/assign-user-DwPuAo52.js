import{R as a,j as e}from"./app-BOmU1wmL.js";import{B as f}from"./button-BXeYMGgI.js";import{b as _,I as A,a as g}from"./input-group-BHZW5HF8.js";import{S as j}from"./spinner--AHlGxP7.js";import{S as y}from"./search-CS9TKoj2.js";import"./app-VvtKnDwK.js";import"./index-sq8JxwLA.js";import"./index-CtUadT9n.js";import"./index-CyaJm5Nq.js";import"./utils-e8IeQt0G.js";import"./input-BasXNOLM.js";import"./createLucideIcon-DUOuwx2-.js";function q({studentId:c}){const[b,S]=a.useState(""),[r,d]=a.useState(void 0),[u,i]=a.useState(!1),[m,l]=a.useState(!1),[p,o]=a.useState(null);async function N(t){try{i(!0);const n={search_key:t},s=await(await fetch("/dtech-partner/etudiants/api/search-user",{method:"POST",headers:{Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify(n)})).json();console.log("result",s),i(!1),s.user?(d(s.user),o(null)):(console.error("Utilisateur non trouvé"),console.error("result.message",s.message),o(s.message||"Utilisateur non trouvé"),d(void 0))}catch(n){o("Une erreur est survenue lors de la recherche."),i(!1),console.error("Erreur",n)}}function v(){N(b)}function w(t){if(t.preventDefault(),!r||!c)return;l(!0);const n={user_id:r.id,student_id:c};async function h(){try{const s=await fetch("/dtech-partner/etudiants/api/assign-to-user",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify(n)}),x=await s.json();console.log("result",x),l(!1),s.status===200?window.location.reload():(console.error("Échec de l'assignation"),o(x.message||"Échec de l'assignation"))}catch(s){l(!1),console.error("Erreur",s)}}h()}return e.jsxs("div",{className:"mt-6 border-t border-gray-100 pt-6",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-gray-700",children:"Assigner ce profil à un utilisateur"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Cette fonctionnalité permet d'associer ce profil étudiant à un compte utilisateur existant sur la plateforme."}),e.jsxs("div",{className:"mt-4",children:[e.jsxs(_,{className:"mb-3 w-full rounded-3xl py-5 focus:outline-0 focus-visible:outline-0",children:[e.jsx(A,{name:"search_key",onChange:t=>S(t.target.value),placeholder:"Entrer son numéro ou son email"}),e.jsx(g,{children:e.jsx(y,{})}),e.jsx(g,{align:"inline-end",children:e.jsxs(f,{disabled:u,className:"btn-primary",onClick:v,children:[u&&e.jsx(j,{}),e.jsx(y,{}),"Vérifier"]})})]}),r&&e.jsx("div",{className:"mb-4 rounded-lg border border-gray-200 bg-gray-50 p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[r.first_name," ",r.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:r.email}),e.jsx("p",{className:"text-sm text-gray-500",children:r.phone_number})]}),e.jsx("div",{className:"rounded-full bg-green-100 p-2",children:e.jsx("svg",{className:"h-5 w-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}),p&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-200 bg-red-50 p-4 shadow-sm",children:e.jsx("p",{className:"text-sm text-red-600",children:p})}),r&&e.jsx("form",{method:"POST",onSubmit:w,children:e.jsxs(f,{disabled:m,type:"submit",className:"btn-primary",children:[m&&e.jsx(j,{}),"Assigner un utilisateur"]})})]})]})}export{q as default};

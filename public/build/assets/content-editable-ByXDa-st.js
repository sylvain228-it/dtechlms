import{L as X,y as N,l as L,o as j,U as F,p as R,q as M,v as ee,K as z,J as te,A as ne,B as H,C as re,P as oe,F as ae,G as ie,H as I,M as se,Q as le,S as V,T as ue,V as ce,W as de,Y as fe,Z as pe,_ as G}from"./nodes-CSrlFqt9.js";import{r as d,j as y,c as me}from"./app-BzXwBPBx.js";import{r as P}from"./index-BZwf-zK1.js";function he(e){const t=window.location.origin,n=r=>{if(r.origin!==t)return;const i=e.getRootElement();if(document.activeElement!==i)return;const a=r.data;if(typeof a=="string"){let o;try{o=JSON.parse(a)}catch{return}if(o&&o.protocol==="nuanria_messaging"&&o.type==="request"){const s=o.payload;if(s&&s.functionId==="makeChanges"){const l=s.args;if(l){const[u,c,g,v,b]=l;e.update(()=>{const m=X();if(N(m)){const S=m.anchor;let h=S.getNode(),p=0,f=0;if(L(h)&&u>=0&&c>=0&&(p=u,f=u+c,m.setTextNodeRange(h,p,h,f)),p===f&&g===""||(m.insertRawText(g),h=S.getNode()),L(h)){p=v,f=v+b;const x=h.getTextContentSize();p=p>x?x:p,f=f>x?x:f,m.setTextNodeRange(h,p,h,f)}r.stopImmediatePropagation()}})}}}}};return window.addEventListener("message",n,!0),()=>{window.removeEventListener("message",n,!0)}}function Oe({defaultSelection:e}){const[t]=j();return d.useEffect(()=>{t.focus(()=>{const n=document.activeElement,r=t.getRootElement();r===null||n!==null&&r.contains(n)||r.focus({preventScroll:!0})},{defaultSelection:e})},[e,t]),null}const ye=d.createContext(null),A={didCatch:!1,error:null};class ge extends d.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=A}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var n,r,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];(n=(r=this.props).onReset)===null||n===void 0||n.call(r,{args:a,reason:"imperative-api"}),this.setState(A)}}componentDidCatch(t,n){var r,i;(r=(i=this.props).onError)===null||r===void 0||r.call(i,t,n)}componentDidUpdate(t,n){const{didCatch:r}=this.state,{resetKeys:i}=this.props;if(r&&n.error!==null&&Ee(t.resetKeys,i)){var a,o;(a=(o=this.props).onReset)===null||a===void 0||a.call(o,{next:i,prev:t.resetKeys,reason:"keys"}),this.setState(A)}}render(){const{children:t,fallbackRender:n,FallbackComponent:r,fallback:i}=this.props,{didCatch:a,error:o}=this.state;let s=t;if(a){const l={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")s=n(l);else if(r)s=d.createElement(r,l);else if(i!==void 0)s=i;else throw o}return d.createElement(ye.Provider,{value:{didCatch:a,error:o,resetErrorBoundary:this.resetErrorBoundary}},s)}}function Ee(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==t.length||e.some((n,r)=>!Object.is(n,t[r]))}function He({children:e,onError:t}){return y.jsx(ge,{fallback:y.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:t,children:e})}function ve(e,t,n,r,i){if(e===null||n.size===0&&r.size===0&&!i)return 0;const a=t._selection,o=e._selection;if(i)return 1;if(!(N(a)&&N(o)&&o.isCollapsed()&&a.isCollapsed()))return 0;const s=(function(p,f,x){const k=p._nodeMap,C=[];for(const w of f){const E=k.get(w);E!==void 0&&C.push(E)}for(const[w,E]of x){if(!E)continue;const B=k.get(w);B===void 0||ie(B)||C.push(B)}return C})(t,n,r);if(s.length===0)return 0;if(s.length>1){const p=t._nodeMap,f=p.get(a.anchor.key),x=p.get(o.anchor.key);return f&&x&&!e._nodeMap.has(f.__key)&&L(f)&&f.__text.length===1&&a.anchor.offset===1?2:0}const l=s[0],u=e._nodeMap.get(l.__key);if(!L(u)||!L(l)||u.__mode!==l.__mode)return 0;const c=u.__text,g=l.__text;if(c===g)return 0;const v=a.anchor,b=o.anchor;if(v.key!==b.key||v.type!=="text")return 0;const m=v.offset,S=b.offset,h=g.length-c.length;return h===1&&S===m-1?2:h===-1&&S===m+1?3:h===-1&&S===m?4:0}function xe(e,t){let n=Date.now(),r=0;return(i,a,o,s,l,u)=>{const c=Date.now();if(u.has(H))return r=0,n=c,2;const g=ve(i,a,s,l,e.isComposing()),v=(()=>{const b=o===null||o.editor===e,m=u.has(oe);if(!m&&b&&u.has(ae))return 0;if(i===null)return 1;const S=a._selection;if(!(s.size>0||l.size>0))return S!==null?0:2;const h=typeof t=="number"?t:t.peek();return m===!1&&g!==0&&g===r&&c<n+h&&b||s.size===1&&(function(p,f,x){const k=f._nodeMap.get(p),C=x._nodeMap.get(p),w=f._selection,E=x._selection;return!(N(w)&&N(E)&&w.anchor.type==="element"&&w.focus.type==="element"&&E.anchor.type==="text"&&E.focus.type==="text"||!L(k)||!L(C)||k.__parent!==C.__parent)&&JSON.stringify(f.read(()=>k.exportJSON()))===JSON.stringify(x.read(()=>C.exportJSON()))})(Array.from(s)[0],i,a)?0:1})();return n=c,r=g,v}}function T(e){e.undoStack=[],e.redoStack=[],e.current=null}function Q(e,t,n){const r=xe(e,n);return F(e.registerCommand(re,()=>((function(a,o){const s=o.redoStack,l=o.undoStack;if(l.length!==0){const u=o.current,c=l.pop();u!==null&&(s.push(u),a.dispatchCommand(R,!0)),l.length===0&&a.dispatchCommand(M,!1),o.current=c||null,c&&c.editor.setEditorState(c.editorState,{tag:H})}})(e,t),!0),z),e.registerCommand(ne,()=>((function(a,o){const s=o.redoStack,l=o.undoStack;if(s.length!==0){const u=o.current;u!==null&&(l.push(u),a.dispatchCommand(M,!0));const c=s.pop();s.length===0&&a.dispatchCommand(R,!1),o.current=c||null,c&&c.editor.setEditorState(c.editorState,{tag:H})}})(e,t),!0),z),e.registerCommand(te,()=>(T(t),!1),z),e.registerCommand(ee,()=>(T(t),e.dispatchCommand(R,!1),e.dispatchCommand(M,!1),!0),z),e.registerUpdateListener(({editorState:a,prevEditorState:o,dirtyLeaves:s,dirtyElements:l,tags:u})=>{const c=t.current,g=t.redoStack,v=t.undoStack,b=c===null?null:c.editorState;if(c!==null&&a===b)return;const m=r(o,a,c,s,l,u);if(m===1)g.length!==0&&(t.redoStack=[],e.dispatchCommand(R,!1)),c!==null&&(v.push({...c}),e.dispatchCommand(M,!0));else if(m===2)return;t.current={editor:e,editorState:a}}))}function W(){return{current:null,redoStack:[],undoStack:[]}}const O=I({build:(e,{delay:t,createInitialHistoryState:n,disabled:r})=>ce({delay:t,disabled:r,historyState:n(e)}),config:ue({createInitialHistoryState:W,delay:300,disabled:typeof window>"u"}),name:"@lexical/history/History",register:(e,t,n)=>{const r=n.getOutput();return V(()=>r.disabled.value?void 0:Q(e,r.historyState.value,r.delay))}});I({dependencies:[se(O,{createInitialHistoryState:()=>{throw new Error("SharedHistory did not inherit parent history")},disabled:!0})],name:"@lexical/history/SharedHistory",register(e,t,n){const{output:r}=n.getDependency(O),i=(function(o){return o?le(o,O.name):null})(e._parentEditor);if(!i)return()=>{};const a=i.output;return V(()=>de(()=>{r.delay.value=a.delay.value,r.historyState.value=a.historyState.value,r.disabled.value=a.disabled.value}))}});function Ie({delay:e,externalHistoryState:t}){const[n]=j();return(function(r,i,a=1e3){const o=d.useMemo(()=>i||W(),[i]);d.useEffect(()=>Q(r,o,a),[a,r,o])})(n,t,e),null}const be=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?d.useLayoutEffect:d.useEffect;function Se(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function we(){return(function(e){const[t]=j(),n=d.useMemo(()=>e(t),[t,e]),[r,i]=d.useState(()=>n.initialValueFn()),a=d.useRef(r);return be(()=>{const{initialValueFn:o,subscribe:s}=n,l=o();return a.current!==l&&(a.current=l,i(l)),s(u=>{a.current=u,i(u)})},[n,e]),r})(Se)}const Ce=I({name:"@lexical/react/ReactProvider"});function ke(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const i of t)r.append("v",i);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const J=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?d.useLayoutEffect:d.useEffect;function _e({editor:e,ErrorBoundary:t}){return(function(n,r){const[i,a]=d.useState(()=>n.getDecorators());return J(()=>n.registerDecoratorListener(o=>{P.flushSync(()=>{a(o)})}),[n]),d.useEffect(()=>{a(n.getDecorators())},[n]),d.useMemo(()=>{const o=[],s=Object.keys(i);for(let l=0;l<s.length;l++){const u=s[l],c=y.jsx(r,{onError:v=>n._onError(v),children:y.jsx(d.Suspense,{fallback:null,children:i[u]})}),g=n.getElementByKey(u);g!==null&&o.push(P.createPortal(c,g,u))}return o},[r,i,n])})(e,t)}function Le({editor:e,ErrorBoundary:t}){return(function(n){const r=pe.maybeFromEditor(n);if(r&&r.hasExtensionByName(Ce.name)){for(const i of["@lexical/plain-text","@lexical/rich-text"])r.hasExtensionByName(i)&&ke(320,i);return!0}return!1})(e)?null:y.jsx(_e,{editor:e,ErrorBoundary:t})}function $(e){return e.getEditorState().read(G(e.isComposing()))}function Je({contentEditable:e,placeholder:t=null,ErrorBoundary:n}){const[r]=j();return(function(i){J(()=>F(fe(i),he(i)),[i])})(r),y.jsxs(y.Fragment,{children:[e,y.jsx(Be,{content:t}),y.jsx(Le,{editor:r,ErrorBoundary:n})]})}function Be({content:e}){const[t]=j(),n=(function(i){const[a,o]=d.useState(()=>$(i));return J(()=>{function s(){const l=$(i);o(l)}return s(),F(i.registerUpdateListener(()=>{s()}),i.registerEditableListener(()=>{s()}))},[i]),a})(t),r=we();return n?typeof e=="function"?e(r):e:null}const Y=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?d.useLayoutEffect:d.useEffect;function je({editor:e,ariaActiveDescendant:t,ariaAutoComplete:n,ariaControls:r,ariaDescribedBy:i,ariaErrorMessage:a,ariaExpanded:o,ariaInvalid:s,ariaLabel:l,ariaLabelledBy:u,ariaMultiline:c,ariaOwns:g,ariaRequired:v,autoCapitalize:b,className:m,id:S,role:h="textbox",spellCheck:p=!0,style:f,tabIndex:x,"data-testid":k,...C},w){const[E,B]=d.useState(e.isEditable()),U=d.useCallback(_=>{_&&_.ownerDocument&&_.ownerDocument.defaultView?e.setRootElement(_):e.setRootElement(null)},[e]),Z=d.useMemo(()=>(function(..._){return K=>{for(const D of _)typeof D=="function"?D(K):D!=null&&(D.current=K)}})(w,U),[U,w]);return Y(()=>(B(e.isEditable()),e.registerEditableListener(_=>{B(_)})),[e]),y.jsx("div",{"aria-activedescendant":E?t:void 0,"aria-autocomplete":E?n:"none","aria-controls":E?r:void 0,"aria-describedby":i,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":E&&h==="combobox"?!!o:void 0,...s!=null?{"aria-invalid":s}:{},"aria-label":l,"aria-labelledby":u,"aria-multiline":c,"aria-owns":E?g:void 0,"aria-readonly":!E||void 0,"aria-required":v,autoCapitalize:b,className:m,contentEditable:E,"data-testid":k,id:S,ref:Z,role:h,spellCheck:p,style:f,tabIndex:x,...C})}const Ne=d.forwardRef(je);function q(e){return e.getEditorState().read(G(e.isComposing()))}const De=d.forwardRef(Re);function Re(e,t){const{placeholder:n,...r}=e,[i]=j();return y.jsxs(y.Fragment,{children:[y.jsx(Ne,{editor:i,...r,ref:t}),n!=null&&y.jsx(Me,{editor:i,content:n})]})}function Me({content:e,editor:t}){const n=(function(o){const[s,l]=d.useState(()=>q(o));return Y(()=>{function u(){const c=q(o);l(c)}return u(),F(o.registerUpdateListener(()=>{u()}),o.registerEditableListener(()=>{u()}))},[o]),s})(t),[r,i]=d.useState(t.isEditable());if(d.useLayoutEffect(()=>(i(t.isEditable()),t.registerEditableListener(o=>{i(o)})),[t]),!n)return null;let a=null;return typeof e=="function"?a=e(r):e!==null&&(a=e),a===null?null:y.jsx("div",{"aria-hidden":!0,children:a})}function Ue(e){const t=me.c(7),{placeholder:n,className:r,placeholderClassName:i}=e,a=r??"ContentEditable__root relative block min-h-72 min-h-full overflow-auto px-8 py-4 focus:outline-none",o=i??"pointer-events-none absolute top-0 left-0 overflow-hidden px-8 py-[18px] text-ellipsis text-muted-foreground select-none";let s;t[0]!==n||t[1]!==o?(s=y.jsx("div",{className:o,children:n}),t[0]=n,t[1]=o,t[2]=s):s=t[2];let l;return t[3]!==n||t[4]!==a||t[5]!==s?(l=y.jsx(De,{className:a,"aria-placeholder":n,placeholder:s}),t[3]=n,t[4]=a,t[5]=s,t[6]=l):l=t[6],l}export{Ue as C,Je as L,we as a,Ie as b,He as n,Oe as o};

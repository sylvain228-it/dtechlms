import{u as C,r as b,b as B,R as m,j as e,a as S}from"./app-CjIWy3eH.js";import{I as l,S as M,F as R,T as L,C as O}from"./form-SFwPvtEA.js";import{B as p}from"./button-CExzQmZc.js";import{b as G,I as K,a as V}from"./input-group-X2fy6Tco.js";import{S as E}from"./spinner-Bb2x751J.js";import{I as $}from"./institut-layouts-BcHxCBFu.js";import{u as z,f as J,s as Q}from"./index-DIHBWcL6.js";import{a as H}from"./index-Ck4J3t7f.js";import{S as W}from"./search-Dx3AsdWN.js";import"./app-DfLmVDUM.js";import"./index-C4soMqjN.js";import"./index-BnYBuebb.js";import"./utils-AnTb9DBe.js";import"./input-yCXFspsm.js";import"./createLucideIcon-i13MEz2U.js";import"./tasks-gWUZeaAY.js";import"./index-BqTge0le.js";import"./index-CMWG4mbA.js";import"./lexical-headless-BCA5NgA9.js";import"./nodes-B8QjlgCe.js";import"./page-banner-IgGXIOfs.js";import"./index-CHnKU68i.js";import"./iconBase-ZLoFHiO_.js";import"./arrow-left-DAnQtW-a.js";import"./app-logo-icon-hvVxL52x.js";import"./divider-D-eLoZ7M.js";import"./avatar-8Q0-AYNg.js";import"./index-OYVf1Zwz.js";import"./index-DnZUlvAx.js";import"./index-Cx1mEBwh.js";import"./dropdown-menu-DUsmAPKS.js";import"./index-aXAQScOB.js";import"./index-CgNbq55-.js";import"./index-CPWTBhsT.js";import"./index-DdCDBdhx.js";import"./index-DIo9abDA.js";import"./index-DLvqQGle.js";import"./check-C6ufmhQW.js";import"./avatar-fallback-DKyWtIhb.js";import"./use-initials-GDEZD6-s.js";import"./index-BtCACXPK.js";import"./index-5dwg6Nh6.js";import"./index-DMEIf3eg.js";import"./index-BCspIYgb.js";import"./index-V0aQkvK_.js";import"./index-Bfjphteo.js";import"./index-DD88zi8k.js";import"./index-CvwxozaB.js";import"./index-CwtRjVPi.js";import"./index-DRwoOeWz.js";import"./index-DXT9ONqy.js";import"./index-lBAoiumE.js";import"./index-Di1vi8wQ.js";import"./index-B6m0Xa0K.js";import"./gauge-au9SJ6qx.js";import"./message-circle-CqdwJGEq.js";import"./settings-P3TSVHSR.js";import"./log-out-Bz_ayeBV.js";import"./x-CvJE1FTX.js";import"./menu-F5M2EXT6.js";function ar(){const{errors:t}=C().props,[c,f]=b.useState(""),[u,v]=b.useState(!1),{teacher:s}=C().props,{data:a,setData:i}=B({first_name:s==null?"":s.first_name,last_name:s==null?"":s.last_name,email:s==null?"":s.email,phone_number:s==null?"":s.phone_number,whatsapp_number:s==null?"":s.whatsapp_number,create_new_user:!1,birth_date:s==null?"":s.birth_date?new Date(s.birth_date).toISOString().split("T")[0]:"",gender:s==null?"":s.gender,qualification:s==null?"":s.qualification,diplom:s==null?"":s.diplom,exp_year:s==null?"":s.exp_year,country:s==null?"":s.country,city:s==null?"":s.city,address:s==null?"":s.address,bio:s==null?"":s.bio,specialties:[],online_teaching:s==null?!1:s.online_teaching===1,status:"inactive",user_id:"",profile_picture:null}),j=s==null||s.user_id==null,[y,k]=m.useState(""),[o,h]=m.useState(void 0),[_,x]=m.useState(!1),[N,g]=m.useState(null);async function I(r){try{x(!0);const d=await(await fetch(`${Q().url}?search_key=${r}`,{method:"GET"})).json();console.log("result",d),x(!1),d.user?(h(d.user),g(null)):(console.error("Utilisateur non trouvé"),console.error("result.message",d.message),g(d.message||"Utilisateur non trouvé"),h(void 0))}catch(n){g("Une erreur est survenue lors de la recherche."),x(!1),console.error("Erreur",n)}}function F(){I(y)}function q(r){r.preventDefault(),o&&(i("user_id",o.id.toString()),i("first_name",o?.first_name),i("last_name",o.last_name),i("email",o.email),i("phone_number",o.phone_number))}function D(r){r.preventDefault(),h(void 0),i("user_id",""),i("first_name",""),i("last_name",""),i("email",""),i("phone_number","")}b.useEffect(()=>{s!=null&&s.specialties!=null&&JSON.parse(s.specialties).map(n=>{n.trim()&&!a.specialties.includes(n)&&i("specialties",[...a.specialties,n])})},[a.specialties,i,s]);const w=()=>{c.trim()&&!a.specialties.includes(c)&&(i("specialties",[...a.specialties,c]),f(""))},A=r=>{i("specialties",a.specialties.filter(n=>n!==r))},U=r=>{r.preventDefault(),v(!0);async function n(){const d={...a,_method:s==null?"post":"put"};s!=null?S.post(z(s.id),d,{forceFormData:!0}):S.post(J(),d)}n().then(()=>{v(!1)})},P=[{key:"M",value:"Masculin"},{key:"F",value:"Féminin"},{key:"O",value:"Autre"}],T=a.first_name&&a.last_name&&a.email&&a.phone_number;return e.jsx($,{title:s==null?"Ajouter un Enseignant":"Modifier l'Enseignant",children:e.jsxs("div",{className:"mx-auto mt-8 mb-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s==null?"Ajouter un Enseignant":"Modifier l'Enseignant"}),e.jsxs("p",{className:"mt-2 text-gray-600",children:["Complétez le formulaire ci-dessous pour",s==null?" créer un nouveau profil d'enseignant":" modifier un profil d'enseignant existant"]})]}),e.jsxs("form",{onSubmit:U,method:"POST",className:"space-y-8 rounded-xl border border-gray-200 bg-white p-8 shadow-lg",children:[j&&e.jsx("div",{className:"mt-6 grid grid-cols-1 gap-6",children:e.jsxs("div",{className:"rounded-lg border bg-white p-4 shadow-sm",children:[e.jsx("h2",{className:"text-md font-medium text-gray-900",children:"Enseignant à déjà un compte?/Rechercher"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"mb-3",children:e.jsxs(G,{className:"w-full rounded-3xl py-5 focus:outline-0 focus-visible:outline-0",children:[e.jsx(K,{name:"search_key",onChange:r=>k(r.target.value),placeholder:"Entrer son numéro, son email ou identifiant"}),e.jsx(V,{align:"inline-end",children:e.jsxs(p,{disabled:_||y==="",className:"btn-primary",onClick:F,children:[_&&e.jsx(E,{}),e.jsx(W,{}),"Vérifier"]})})]})}),o&&e.jsx("div",{className:"mb-4 rounded-lg border border-gray-200 bg-gray-50 p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[o.first_name," ",o.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:o.email}),e.jsx("p",{className:"text-sm text-gray-500",children:o.phone_number})]}),e.jsx("div",{className:"rounded-full bg-green-100 p-2",children:e.jsx("svg",{className:"h-5 w-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}),N&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-200 bg-red-50 p-4 shadow-sm",children:e.jsx("p",{className:"text-sm text-red-600",children:N})}),o&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{onClick:q,type:"submit",className:"btn-primary",children:"Appliquer"}),e.jsx(p,{onClick:D,type:"submit",className:"btn-primary !bg-red-500",children:e.jsx(H,{})})]})]})]})}),e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"mb-6 text-lg font-semibold text-gray-800",children:"Informations Personnelles"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(l,{label:"Prénom",value:a.first_name,onChange:r=>i("first_name",r),error:t.first_name,required:!0,placeholder:"ex: Jean"}),e.jsx(l,{label:"Nom",value:a.last_name,onChange:r=>i("last_name",r),error:t.last_name,required:!0,placeholder:"ex: Dupont"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(l,{label:"Email",type:"email",value:a.email,onChange:r=>i("email",r),error:t.email,required:!0,placeholder:"ex: jean.dupont@example.com"}),e.jsx(l,{label:"Téléphone",type:"tel",value:a.phone_number,onChange:r=>i("phone_number",r),error:t.phone_number,required:!0,placeholder:"ex: +22861234567"}),e.jsx(l,{label:"Numéro whatsapp",type:"tel",value:a.whatsapp_number,onChange:r=>i("whatsapp_number",r),error:t.whatsapp_number,placeholder:"ex: +22861234567"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(l,{label:"Date de Naissance",type:"date",value:a.birth_date??"",onChange:r=>i("birth_date",r),error:t.birth_date}),e.jsx(M,{label:"Sexe",value:a.gender,onChange:r=>i("gender",r),options:P,error:t.gender})]})]}),e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"mb-6 text-lg font-semibold text-gray-800",children:"Qualifications Professionnelles"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(l,{label:"Qualification",value:a.qualification,onChange:r=>i("qualification",r),error:t.qualification,placeholder:"ex: Bac+3"}),e.jsx(l,{label:"Diplôme",value:a.diplom,onChange:r=>i("diplom",r),error:t.diplom,placeholder:"ex: Licence en Informatique"}),e.jsx(l,{label:"Années d'Expérience",type:"number",value:a.exp_year,onChange:r=>i("exp_year",r),error:t.exp_year,placeholder:"ex: 5"})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(R,{label:"Spécialités",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:c,onChange:r=>f(r.target.value),onKeyDown:r=>{r.key==="Enter"&&(r.preventDefault(),w())},placeholder:"Ajouter une spécialité...",className:"flex-1 rounded-lg border border-gray-300 bg-gray-50 px-4 py-2 transition focus:border-blue-500 focus:bg-white focus:ring-2 focus:ring-blue-200 focus:outline-none"}),e.jsx("button",{type:"button",onClick:w,className:"rounded-lg bg-gray-600 px-4 py-2 text-white transition hover:bg-gray-700",children:"Ajouter"})]}),a.specialties.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:a.specialties.map(r=>e.jsxs("span",{className:"flex items-center gap-2 rounded-full bg-blue-100 px-3 py-1 text-sm text-blue-700",children:[r,e.jsx("button",{type:"button",onClick:()=>A(r),className:"text-blue-500 hover:text-blue-700",children:"×"})]},r))})]})})]}),e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"mb-6 text-lg font-semibold text-gray-800",children:"Localisation"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3",children:[e.jsx(l,{label:"Pays",value:a.country,onChange:r=>i("country",r),error:t.country,placeholder:"ex: Togo"}),e.jsx(l,{label:"Ville",value:a.city,onChange:r=>i("city",r),error:t.city,placeholder:"ex: Lomé"}),e.jsx(l,{label:"Adresse",value:a.address,onChange:r=>i("address",r),error:t.address,placeholder:"ex: 123 Rue de la Paix"})]})]}),e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"mb-6 text-lg font-semibold text-gray-800",children:"Biographie & Description"}),e.jsx(L,{label:"Biographie",value:a.bio,onChange:r=>i("bio",r),error:t.bio,placeholder:"Décrivez votre expérience, vos spécialités et votre approche pédagogique...",rows:5})]}),j&&e.jsx("div",{children:a.user_id!=""&&o!=null?e.jsxs("div",{className:"w-full bg-green-100 p-3 text-green-600",children:["Utilisateur trouvé : ",o.email]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full bg-amber-100 p-3 text-amber-600",children:["Un compte utilisateur n'a pas été sélectionné,"," ",e.jsx("b",{children:"cocher cette case pour créer un nouveau compte qui sera associer à cet enseignant avec ses informations."})]}),e.jsx("div",{className:"mt-2 pb-6",children:e.jsx("div",{className:"space-y-4",children:e.jsx(O,{label:"Créer un nouveau compte",checked:a.create_new_user,onChange:r=>i("create_new_user",r)})})})]})}),e.jsxs("div",{className:"flex gap-4 border-gray-200 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"flex-1 rounded-lg border border-gray-300 bg-white px-6 py-2 font-medium text-gray-700 transition hover:bg-gray-50",children:"Annuler"}),e.jsxs(p,{type:"submit",disabled:u||!T,className:"btn-primary flex-1",children:[u&&e.jsx(E,{}),u?`${s==null?"Enregistrement en cours...":"Mise à jour en cours..."}`:`${s==null?"Créer l'Enseignant":"Modifier l'Enseignant"}`]})]})]})]})})}export{ar as default};

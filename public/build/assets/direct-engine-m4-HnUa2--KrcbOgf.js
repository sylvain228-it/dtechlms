import{a as on,B as y,W as x,Z as mt,b as Jt,w as qt,P as L,U as hn,c as Dn,M as bn,E as Te,T as ae,A as Xe,k as fn,d as fe,q as Qt,G as Zt,V as pn,Y as pt,e as An,f as en,h as En,_ as Ye,O as Mn,L as yn,z as Ft,D as Je,i as qe,j as tn,o as Gn,r as nn,g as lt,y as Pe,S as ie,K as Sn}from"./pdf-viewer-CPTx-G0p.js";import{h as Cn,l as Tn}from"./browser-awZxztMA-DP8ttsSz-BXar5zKR.js";import"./app-DeYJtq_f.js";import"./app-BCy0fQWz.js";var At,xn=(At=import.meta.url,async function(H={}){var r,t,o,e=H,u=new Promise((n,a)=>{t=n,o=a});["_EPDF_GetMetaKeyCount","_EPDF_GetMetaKeyName","_EPDF_GetMetaTrapped","_EPDF_GetPageRotationByIndex","_EPDF_HasMetaText","_EPDF_IsEncrypted","_EPDF_IsOwnerUnlocked","_EPDF_PNG_EncodeRGBA","_EPDF_RemoveEncryption","_EPDF_RenderAnnotBitmap","_EPDF_SetEncryption","_EPDF_SetMetaText","_EPDF_SetMetaTrapped","_EPDF_UnlockOwnerPermissions","_EPDFAction_CreateGoTo","_EPDFAction_CreateGoToNamed","_EPDFAction_CreateLaunch","_EPDFAction_CreateRemoteGoToByName","_EPDFAction_CreateRemoteGoToDest","_EPDFAction_CreateURI","_EPDFAnnot_ClearColor","_EPDFAnnot_GenerateAppearance","_EPDFAnnot_GenerateAppearanceWithBlend","_EPDFAnnot_GetBlendMode","_EPDFAnnot_GetBorderDashPattern","_EPDFAnnot_GetBorderDashPatternCount","_EPDFAnnot_GetBorderEffect","_EPDFAnnot_GetBorderStyle","_EPDFAnnot_GetColor","_EPDFAnnot_GetDefaultAppearance","_EPDFAnnot_GetIcon","_EPDFAnnot_GetIntent","_EPDFAnnot_GetLineEndings","_EPDFAnnot_GetOpacity","_EPDFAnnot_GetRectangleDifferences","_EPDFAnnot_GetRichContent","_EPDFAnnot_GetTextAlignment","_EPDFAnnot_GetVerticalAlignment","_EPDFAnnot_SetBorderDashPattern","_EPDFAnnot_SetBorderStyle","_EPDFAnnot_SetColor","_EPDFAnnot_SetDefaultAppearance","_EPDFAnnot_SetIcon","_EPDFAnnot_SetIntent","_EPDFAnnot_SetLine","_EPDFAnnot_SetLineEndings","_EPDFAnnot_SetLinkedAnnot","_EPDFAnnot_SetOpacity","_EPDFAnnot_SetTextAlignment","_EPDFAnnot_SetVerticalAlignment","_EPDFAnnot_SetVertices","_EPDFAnnot_UpdateAppearanceToRect","_EPDFAttachment_GetDescription","_EPDFAttachment_GetIntegerValue","_EPDFAttachment_SetDescription","_EPDFAttachment_SetSubtype","_EPDFBookmark_AppendChild","_EPDFBookmark_Clear","_EPDFBookmark_ClearTarget","_EPDFBookmark_Create","_EPDFBookmark_Delete","_EPDFBookmark_InsertAfter","_EPDFBookmark_SetAction","_EPDFBookmark_SetDest","_EPDFBookmark_SetTitle","_EPDFCatalog_GetLanguage","_EPDFDest_CreateRemoteView","_EPDFDest_CreateRemoteXYZ","_EPDFDest_CreateView","_EPDFDest_CreateXYZ","_EPDFNamedDest_Remove","_EPDFNamedDest_SetDest","_EPDFPage_CreateAnnot","_EPDFPage_GetAnnotByName","_EPDFPage_GetAnnotCountRaw","_EPDFPage_GetAnnotRaw","_EPDFPage_RemoveAnnotByName","_EPDFPage_RemoveAnnotRaw","_EPDFText_RedactInQuads","_EPDFText_RedactInRect","_FORM_CanRedo","_FORM_CanUndo","_FORM_DoDocumentAAction","_FORM_DoDocumentJSAction","_FORM_DoDocumentOpenAction","_FORM_DoPageAAction","_FORM_ForceToKillFocus","_FORM_GetFocusedAnnot","_FORM_GetFocusedText","_FORM_GetSelectedText","_FORM_IsIndexSelected","_FORM_OnAfterLoadPage","_FORM_OnBeforeClosePage","_FORM_OnChar","_FORM_OnFocus","_FORM_OnKeyDown","_FORM_OnKeyUp","_FORM_OnLButtonDoubleClick","_FORM_OnLButtonDown","_FORM_OnLButtonUp","_FORM_OnMouseMove","_FORM_OnMouseWheel","_FORM_OnRButtonDown","_FORM_OnRButtonUp","_FORM_Redo","_FORM_ReplaceAndKeepSelection","_FORM_ReplaceSelection","_FORM_SelectAllText","_FORM_SetFocusedAnnot","_FORM_SetIndexSelected","_FORM_Undo","_FPDF_AddInstalledFont","_FPDF_CloseDocument","_FPDF_ClosePage","_FPDF_CloseXObject","_FPDF_CopyViewerPreferences","_FPDF_CountNamedDests","_FPDF_CreateClipPath","_FPDF_CreateNewDocument","_FPDF_DestroyClipPath","_FPDF_DestroyLibrary","_FPDF_DeviceToPage","_FPDF_DocumentHasValidCrossReferenceTable","_FPDF_FFLDraw","_FPDF_FreeDefaultSystemFontInfo","_FPDF_GetDefaultSystemFontInfo","_FPDF_GetDefaultTTFMap","_FPDF_GetDefaultTTFMapCount","_FPDF_GetDefaultTTFMapEntry","_FPDF_GetDocPermissions","_FPDF_GetDocUserPermissions","_FPDF_GetFileIdentifier","_FPDF_GetFileVersion","_FPDF_GetFormType","_FPDF_GetLastError","_FPDF_GetMetaText","_FPDF_GetNamedDest","_FPDF_GetNamedDestByName","_FPDF_GetPageAAction","_FPDF_GetPageBoundingBox","_FPDF_GetPageCount","_FPDF_GetPageHeight","_FPDF_GetPageHeightF","_FPDF_GetPageLabel","_FPDF_GetPageSizeByIndex","_FPDF_GetPageSizeByIndexF","_FPDF_GetPageWidth","_FPDF_GetPageWidthF","_FPDF_GetSecurityHandlerRevision","_FPDF_GetSignatureCount","_FPDF_GetSignatureObject","_FPDF_GetTrailerEnds","_FPDF_GetXFAPacketContent","_FPDF_GetXFAPacketCount","_FPDF_GetXFAPacketName","_FPDF_ImportNPagesToOne","_FPDF_ImportPages","_FPDF_ImportPagesByIndex","_FPDF_InitLibrary","_FPDF_InitLibraryWithConfig","_FPDF_LoadCustomDocument","_FPDF_LoadDocument","_FPDF_LoadMemDocument","_FPDF_LoadMemDocument64","_FPDF_LoadPage","_FPDF_LoadXFA","_FPDF_MovePages","_FPDF_NewFormObjectFromXObject","_FPDF_NewXObjectFromPage","_FPDF_PageToDevice","_FPDF_RemoveFormFieldHighlight","_FPDF_RenderPage_Close","_FPDF_RenderPage_Continue","_FPDF_RenderPageBitmap","_FPDF_RenderPageBitmap_Start","_FPDF_RenderPageBitmapWithColorScheme_Start","_FPDF_RenderPageBitmapWithMatrix","_FPDF_SaveAsCopy","_FPDF_SaveWithVersion","_FPDF_SetFormFieldHighlightAlpha","_FPDF_SetFormFieldHighlightColor","_FPDF_SetSandBoxPolicy","_FPDF_SetSystemFontInfo","_FPDF_StructElement_Attr_CountChildren","_FPDF_StructElement_Attr_GetBlobValue","_FPDF_StructElement_Attr_GetBooleanValue","_FPDF_StructElement_Attr_GetChildAtIndex","_FPDF_StructElement_Attr_GetCount","_FPDF_StructElement_Attr_GetName","_FPDF_StructElement_Attr_GetNumberValue","_FPDF_StructElement_Attr_GetStringValue","_FPDF_StructElement_Attr_GetType","_FPDF_StructElement_Attr_GetValue","_FPDF_StructElement_CountChildren","_FPDF_StructElement_GetActualText","_FPDF_StructElement_GetAltText","_FPDF_StructElement_GetAttributeAtIndex","_FPDF_StructElement_GetAttributeCount","_FPDF_StructElement_GetChildAtIndex","_FPDF_StructElement_GetChildMarkedContentID","_FPDF_StructElement_GetID","_FPDF_StructElement_GetLang","_FPDF_StructElement_GetMarkedContentID","_FPDF_StructElement_GetMarkedContentIdAtIndex","_FPDF_StructElement_GetMarkedContentIdCount","_FPDF_StructElement_GetObjType","_FPDF_StructElement_GetParent","_FPDF_StructElement_GetStringAttribute","_FPDF_StructElement_GetTitle","_FPDF_StructElement_GetType","_FPDF_StructTree_Close","_FPDF_StructTree_CountChildren","_FPDF_StructTree_GetChildAtIndex","_FPDF_StructTree_GetForPage","_FPDF_VIEWERREF_GetDuplex","_FPDF_VIEWERREF_GetName","_FPDF_VIEWERREF_GetNumCopies","_FPDF_VIEWERREF_GetPrintPageRange","_FPDF_VIEWERREF_GetPrintPageRangeCount","_FPDF_VIEWERREF_GetPrintPageRangeElement","_FPDF_VIEWERREF_GetPrintScaling","_FPDFAction_GetDest","_FPDFAction_GetFilePath","_FPDFAction_GetType","_FPDFAction_GetURIPath","_FPDFAnnot_AddFileAttachment","_FPDFAnnot_AddInkStroke","_FPDFAnnot_AppendAttachmentPoints","_FPDFAnnot_AppendObject","_FPDFAnnot_CountAttachmentPoints","_FPDFAnnot_GetAP","_FPDFAnnot_GetAttachmentPoints","_FPDFAnnot_GetBorder","_FPDFAnnot_GetColor","_FPDFAnnot_GetFileAttachment","_FPDFAnnot_GetFlags","_FPDFAnnot_GetFocusableSubtypes","_FPDFAnnot_GetFocusableSubtypesCount","_FPDFAnnot_GetFontColor","_FPDFAnnot_GetFontSize","_FPDFAnnot_GetFormAdditionalActionJavaScript","_FPDFAnnot_GetFormControlCount","_FPDFAnnot_GetFormControlIndex","_FPDFAnnot_GetFormFieldAlternateName","_FPDFAnnot_GetFormFieldAtPoint","_FPDFAnnot_GetFormFieldExportValue","_FPDFAnnot_GetFormFieldFlags","_FPDFAnnot_GetFormFieldName","_FPDFAnnot_GetFormFieldType","_FPDFAnnot_GetFormFieldValue","_FPDFAnnot_GetInkListCount","_FPDFAnnot_GetInkListPath","_FPDFAnnot_GetLine","_FPDFAnnot_GetLink","_FPDFAnnot_GetLinkedAnnot","_FPDFAnnot_GetNumberValue","_FPDFAnnot_GetObject","_FPDFAnnot_GetObjectCount","_FPDFAnnot_GetOptionCount","_FPDFAnnot_GetOptionLabel","_FPDFAnnot_GetRect","_FPDFAnnot_GetStringValue","_FPDFAnnot_GetSubtype","_FPDFAnnot_GetValueType","_FPDFAnnot_GetVertices","_FPDFAnnot_HasAttachmentPoints","_FPDFAnnot_HasKey","_FPDFAnnot_IsChecked","_FPDFAnnot_IsObjectSupportedSubtype","_FPDFAnnot_IsOptionSelected","_FPDFAnnot_IsSupportedSubtype","_FPDFAnnot_RemoveInkList","_FPDFAnnot_RemoveObject","_FPDFAnnot_SetAP","_FPDFAnnot_SetAttachmentPoints","_FPDFAnnot_SetBorder","_FPDFAnnot_SetColor","_FPDFAnnot_SetFlags","_FPDFAnnot_SetFocusableSubtypes","_FPDFAnnot_SetFontColor","_FPDFAnnot_SetFormFieldFlags","_FPDFAnnot_SetRect","_FPDFAnnot_SetStringValue","_FPDFAnnot_SetURI","_FPDFAnnot_UpdateObject","_FPDFAttachment_GetFile","_FPDFAttachment_GetName","_FPDFAttachment_GetStringValue","_FPDFAttachment_GetSubtype","_FPDFAttachment_GetValueType","_FPDFAttachment_HasKey","_FPDFAttachment_SetFile","_FPDFAttachment_SetStringValue","_FPDFAvail_Create","_FPDFAvail_Destroy","_FPDFAvail_GetDocument","_FPDFAvail_GetFirstPageNum","_FPDFAvail_IsDocAvail","_FPDFAvail_IsFormAvail","_FPDFAvail_IsLinearized","_FPDFAvail_IsPageAvail","_FPDFBitmap_Create","_FPDFBitmap_CreateEx","_FPDFBitmap_Destroy","_FPDFBitmap_FillRect","_FPDFBitmap_GetBuffer","_FPDFBitmap_GetFormat","_FPDFBitmap_GetHeight","_FPDFBitmap_GetStride","_FPDFBitmap_GetWidth","_FPDFBookmark_Find","_FPDFBookmark_GetAction","_FPDFBookmark_GetCount","_FPDFBookmark_GetDest","_FPDFBookmark_GetFirstChild","_FPDFBookmark_GetNextSibling","_FPDFBookmark_GetTitle","_FPDFCatalog_IsTagged","_FPDFCatalog_SetLanguage","_FPDFClipPath_CountPaths","_FPDFClipPath_CountPathSegments","_FPDFClipPath_GetPathSegment","_FPDFDest_GetDestPageIndex","_FPDFDest_GetLocationInPage","_FPDFDest_GetView","_FPDFDoc_AddAttachment","_FPDFDoc_CloseJavaScriptAction","_FPDFDoc_DeleteAttachment","_FPDFDOC_ExitFormFillEnvironment","_FPDFDoc_GetAttachment","_FPDFDoc_GetAttachmentCount","_FPDFDoc_GetJavaScriptAction","_FPDFDoc_GetJavaScriptActionCount","_FPDFDoc_GetPageMode","_FPDFDOC_InitFormFillEnvironment","_FPDFFont_Close","_FPDFFont_GetAscent","_FPDFFont_GetBaseFontName","_FPDFFont_GetDescent","_FPDFFont_GetFamilyName","_FPDFFont_GetFlags","_FPDFFont_GetFontData","_FPDFFont_GetGlyphPath","_FPDFFont_GetGlyphWidth","_FPDFFont_GetIsEmbedded","_FPDFFont_GetItalicAngle","_FPDFFont_GetWeight","_FPDFFormObj_CountObjects","_FPDFFormObj_GetObject","_FPDFFormObj_RemoveObject","_FPDFGlyphPath_CountGlyphSegments","_FPDFGlyphPath_GetGlyphPathSegment","_FPDFImageObj_GetBitmap","_FPDFImageObj_GetIccProfileDataDecoded","_FPDFImageObj_GetImageDataDecoded","_FPDFImageObj_GetImageDataRaw","_FPDFImageObj_GetImageFilter","_FPDFImageObj_GetImageFilterCount","_FPDFImageObj_GetImageMetadata","_FPDFImageObj_GetImagePixelSize","_FPDFImageObj_GetRenderedBitmap","_FPDFImageObj_LoadJpegFile","_FPDFImageObj_LoadJpegFileInline","_FPDFImageObj_SetBitmap","_FPDFImageObj_SetMatrix","_FPDFJavaScriptAction_GetName","_FPDFJavaScriptAction_GetScript","_FPDFLink_CloseWebLinks","_FPDFLink_CountQuadPoints","_FPDFLink_CountRects","_FPDFLink_CountWebLinks","_FPDFLink_Enumerate","_FPDFLink_GetAction","_FPDFLink_GetAnnot","_FPDFLink_GetAnnotRect","_FPDFLink_GetDest","_FPDFLink_GetLinkAtPoint","_FPDFLink_GetLinkZOrderAtPoint","_FPDFLink_GetQuadPoints","_FPDFLink_GetRect","_FPDFLink_GetTextRange","_FPDFLink_GetURL","_FPDFLink_LoadWebLinks","_FPDFPage_CloseAnnot","_FPDFPage_CountObjects","_FPDFPage_CreateAnnot","_FPDFPage_Delete","_FPDFPage_Flatten","_FPDFPage_FormFieldZOrderAtPoint","_FPDFPage_GenerateContent","_FPDFPage_GetAnnot","_FPDFPage_GetAnnotCount","_FPDFPage_GetAnnotIndex","_FPDFPage_GetArtBox","_FPDFPage_GetBleedBox","_FPDFPage_GetCropBox","_FPDFPage_GetDecodedThumbnailData","_FPDFPage_GetMediaBox","_FPDFPage_GetObject","_FPDFPage_GetRawThumbnailData","_FPDFPage_GetRotation","_FPDFPage_GetThumbnailAsBitmap","_FPDFPage_GetTrimBox","_FPDFPage_HasFormFieldAtPoint","_FPDFPage_HasTransparency","_FPDFPage_InsertClipPath","_FPDFPage_InsertObject","_FPDFPage_InsertObjectAtIndex","_FPDFPage_New","_FPDFPage_RemoveAnnot","_FPDFPage_RemoveObject","_FPDFPage_SetArtBox","_FPDFPage_SetBleedBox","_FPDFPage_SetCropBox","_FPDFPage_SetMediaBox","_FPDFPage_SetRotation","_FPDFPage_SetTrimBox","_FPDFPage_TransformAnnots","_FPDFPage_TransFormWithClip","_FPDFPageObj_AddMark","_FPDFPageObj_CountMarks","_FPDFPageObj_CreateNewPath","_FPDFPageObj_CreateNewRect","_FPDFPageObj_CreateTextObj","_FPDFPageObj_Destroy","_FPDFPageObj_GetBounds","_FPDFPageObj_GetClipPath","_FPDFPageObj_GetDashArray","_FPDFPageObj_GetDashCount","_FPDFPageObj_GetDashPhase","_FPDFPageObj_GetFillColor","_FPDFPageObj_GetIsActive","_FPDFPageObj_GetLineCap","_FPDFPageObj_GetLineJoin","_FPDFPageObj_GetMark","_FPDFPageObj_GetMarkedContentID","_FPDFPageObj_GetMatrix","_FPDFPageObj_GetRotatedBounds","_FPDFPageObj_GetStrokeColor","_FPDFPageObj_GetStrokeWidth","_FPDFPageObj_GetType","_FPDFPageObj_HasTransparency","_FPDFPageObj_NewImageObj","_FPDFPageObj_NewTextObj","_FPDFPageObj_RemoveMark","_FPDFPageObj_SetBlendMode","_FPDFPageObj_SetDashArray","_FPDFPageObj_SetDashPhase","_FPDFPageObj_SetFillColor","_FPDFPageObj_SetIsActive","_FPDFPageObj_SetLineCap","_FPDFPageObj_SetLineJoin","_FPDFPageObj_SetMatrix","_FPDFPageObj_SetStrokeColor","_FPDFPageObj_SetStrokeWidth","_FPDFPageObj_Transform","_FPDFPageObj_TransformClipPath","_FPDFPageObj_TransformF","_FPDFPageObjMark_CountParams","_FPDFPageObjMark_GetName","_FPDFPageObjMark_GetParamBlobValue","_FPDFPageObjMark_GetParamIntValue","_FPDFPageObjMark_GetParamKey","_FPDFPageObjMark_GetParamStringValue","_FPDFPageObjMark_GetParamValueType","_FPDFPageObjMark_RemoveParam","_FPDFPageObjMark_SetBlobParam","_FPDFPageObjMark_SetIntParam","_FPDFPageObjMark_SetStringParam","_FPDFPath_BezierTo","_FPDFPath_Close","_FPDFPath_CountSegments","_FPDFPath_GetDrawMode","_FPDFPath_GetPathSegment","_FPDFPath_LineTo","_FPDFPath_MoveTo","_FPDFPath_SetDrawMode","_FPDFPathSegment_GetClose","_FPDFPathSegment_GetPoint","_FPDFPathSegment_GetType","_FPDFSignatureObj_GetByteRange","_FPDFSignatureObj_GetContents","_FPDFSignatureObj_GetDocMDPPermission","_FPDFSignatureObj_GetReason","_FPDFSignatureObj_GetSubFilter","_FPDFSignatureObj_GetTime","_FPDFText_ClosePage","_FPDFText_CountChars","_FPDFText_CountRects","_FPDFText_FindClose","_FPDFText_FindNext","_FPDFText_FindPrev","_FPDFText_FindStart","_FPDFText_GetBoundedText","_FPDFText_GetCharAngle","_FPDFText_GetCharBox","_FPDFText_GetCharIndexAtPos","_FPDFText_GetCharIndexFromTextIndex","_FPDFText_GetCharOrigin","_FPDFText_GetFillColor","_FPDFText_GetFontInfo","_FPDFText_GetFontSize","_FPDFText_GetFontWeight","_FPDFText_GetLooseCharBox","_FPDFText_GetMatrix","_FPDFText_GetRect","_FPDFText_GetSchCount","_FPDFText_GetSchResultIndex","_FPDFText_GetStrokeColor","_FPDFText_GetText","_FPDFText_GetTextIndexFromCharIndex","_FPDFText_GetTextObject","_FPDFText_GetUnicode","_FPDFText_HasUnicodeMapError","_FPDFText_IsGenerated","_FPDFText_IsHyphen","_FPDFText_LoadCidType2Font","_FPDFText_LoadFont","_FPDFText_LoadPage","_FPDFText_LoadStandardFont","_FPDFText_SetCharcodes","_FPDFText_SetText","_FPDFTextObj_GetFont","_FPDFTextObj_GetFontSize","_FPDFTextObj_GetRenderedBitmap","_FPDFTextObj_GetText","_FPDFTextObj_GetTextRenderMode","_FPDFTextObj_SetTextRenderMode","_PDFiumExt_CloseFileWriter","_PDFiumExt_CloseFormFillInfo","_PDFiumExt_ExitFormFillEnvironment","_PDFiumExt_GetFileWriterData","_PDFiumExt_GetFileWriterSize","_PDFiumExt_Init","_PDFiumExt_InitFormFillEnvironment","_PDFiumExt_OpenFileWriter","_PDFiumExt_OpenFormFillInfo","_PDFiumExt_SaveAsCopy","_malloc","_free","_memory","___indirect_function_table","onRuntimeInitialized"].forEach(n=>{Object.getOwnPropertyDescriptor(u,n)||Object.defineProperty(u,n,{get:()=>z("You are getting "+n+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js"),set:()=>z("You are setting "+n+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")})});var m=typeof window=="object",d=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type;var _,P,b=!m&&!d,p=Object.assign({},e),M="./this.program",E="";if(b){if(typeof window=="object"||typeof importScripts=="function")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");P=n=>{if(typeof readbuffer=="function")return new Uint8Array(readbuffer(n));let a=read(n,"binary");return T(typeof a=="object"),a},_=n=>new Promise((a,s)=>{setTimeout(()=>a(P(n)))}),globalThis.clearTimeout??=n=>{},globalThis.setTimeout??=n=>typeof n=="function"?n():z(),typeof print<"u"&&(globalThis.console??={},console.log=print,console.warn=console.error=globalThis.printErr??print)}else{if(!m&&!d)throw new Error("environment detection error");if(d?E=self.location.href:typeof document<"u"&&document.currentScript&&(E=document.currentScript.src),At&&(E=At),E=E.startsWith("blob:")?"":E.substr(0,E.replace(/[?#].*/,"").lastIndexOf("/")+1),typeof window!="object"&&typeof importScripts!="function")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");d&&(P=n=>{var a=new XMLHttpRequest;return a.open("GET",n,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),_=n=>(T(!Ge(n),"readAsync does not work with file:// URLs"),fetch(n,{credentials:"same-origin"}).then(a=>a.ok?a.arrayBuffer():Promise.reject(new Error(a.status+" : "+a.url))))}var G,v=e.print||console.log.bind(console),C=e.printErr||console.error.bind(console);Object.assign(e,p),p=null,G="fetchSettings",Object.getOwnPropertyDescriptor(e,G)&&z(`\`Module.${G}\` was supplied but \`${G}\` not included in INCOMING_MODULE_JS_API`),e.arguments&&e.arguments,Be("arguments","arguments_"),e.thisProgram&&(M=e.thisProgram),Be("thisProgram","thisProgram"),T(e.memoryInitializerPrefixURL===void 0,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),T(e.pthreadMainPrefixURL===void 0,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),T(e.cdInitializerPrefixURL===void 0,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),T(e.filePackagePrefixURL===void 0,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),T(e.read===void 0,"Module.read option was removed"),T(e.readAsync===void 0,"Module.readAsync option was removed (modify readAsync in JS)"),T(e.readBinary===void 0,"Module.readBinary option was removed (modify readBinary in JS)"),T(e.setWindowTitle===void 0,"Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)"),T(e.TOTAL_MEMORY===void 0,"Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),Be("asm","wasmExports"),Be("readAsync","readAsync"),Be("readBinary","readBinary"),Be("setWindowTitle","setWindowTitle");var R,U=e.wasmBinary;Be("wasmBinary","wasmBinary"),typeof WebAssembly!="object"&&C("no native wasm support detected");var V,$,X,oe,O,K,ue,ge,pe=!1;function T(n,a){n||z("Assertion failed"+(a?": "+a:""))}function Re(){var n=R.buffer;e.HEAP8=V=new Int8Array(n),e.HEAP16=X=new Int16Array(n),e.HEAPU8=$=new Uint8Array(n),e.HEAPU16=oe=new Uint16Array(n),e.HEAP32=O=new Int32Array(n),e.HEAPU32=K=new Uint32Array(n),e.HEAPF32=ue=new Float32Array(n),e.HEAPF64=ge=new Float64Array(n)}function Ae(){if(!pe){var n=ft();n==0&&(n+=4);var a=K[n>>2],s=K[n+4>>2];a==34821223&&s==2310721022||z(`Stack overflow! Stack cookie has been overwritten at ${Qe(n)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${Qe(s)} ${Qe(a)}`),K[0]!=1668509029&&z("Runtime error: The application has corrupted its heap memory area (address zero)!")}}T(!e.STACK_SIZE,"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time"),T(typeof Int32Array<"u"&&typeof Float64Array<"u"&&Int32Array.prototype.subarray!=null&&Int32Array.prototype.set!=null,"JS engine does not provide full typed array support"),T(!e.wasmMemory,"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),T(!e.INITIAL_MEMORY,"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");var ze=[],dt=[],Ie=[],Ee=!1;function rt(n){ze.unshift(n)}function ot(n){Ie.unshift(n)}T(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),T(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),T(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),T(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var de=0,_e=null,xe=null,Me={};function je(n){for(var a=n;;){if(!Me[n])return n;n=a+Math.random()}}function ve(n){de++,e.monitorRunDependencies?.(de),n?(T(!Me[n]),Me[n]=1,_e===null&&typeof setInterval<"u"&&(_e=setInterval(()=>{if(pe)return clearInterval(_e),void(_e=null);var a=!1;for(var s in Me)a||(a=!0,C("still waiting on run dependencies:")),C(`dependency: ${s}`);a&&C("(end of list)")},1e4))):C("warning: run dependency added without ID")}function me(n){if(de--,e.monitorRunDependencies?.(de),n?(T(Me[n]),delete Me[n]):C("warning: run dependency removed without ID"),de==0&&(_e!==null&&(clearInterval(_e),_e=null),xe)){var a=xe;xe=null,a()}}function z(n){e.onAbort?.(n),C(n="Aborted("+n+")"),pe=!0;var a=new WebAssembly.RuntimeError(n);throw o(a),a}var Oe,N,Z,ye=n=>n.startsWith("data:application/octet-stream;base64,"),Ge=n=>n.startsWith("file://");function i(n,a){return(...s)=>{T(Ee,`native function \`${n}\` called before runtime initialization`);var l=Fe[n];return T(l,`exported native function \`${n}\` not found`),T(s.length<=a,`native function \`${n}\` called with ${s.length} args but expects ${a}`),l(...s)}}function an(){if(e.locateFile){var n="pdfium.wasm";return ye(n)?n:(a=n,e.locateFile?e.locateFile(a,E):E+a)}var a;return b?"pdfium.wasm":new URL("/build/assets/pdfium-SLl32sEO.wasm",import.meta.url).href}function St(n){if(n==Oe&&U)return new Uint8Array(U);if(P)return P(n);throw"both async and sync fetching of the wasm failed"}function Ct(n,a,s){return(function(l){return U?Promise.resolve().then(()=>St(l)):_(l).then(c=>new Uint8Array(c),()=>St(l))})(n).then(l=>WebAssembly.instantiate(l,a)).then(s,l=>{C(`failed to asynchronously prepare wasm: ${l}`),Ge(Oe)&&C(`warning: Loading from a file URI (${Oe}) is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing`),z(l)})}if((()=>{var n=new Int16Array(1),a=new Int8Array(n.buffer);if(n[0]=25459,a[0]!==115||a[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"})(),e.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");function Be(n,a,s=!0){Object.getOwnPropertyDescriptor(e,n)||Object.defineProperty(e,n,{configurable:!0,get(){z(`\`Module.${n}\` has been replaced by \`${a}\``+(s?" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)":""))}})}function Tt(n){return n==="FS_createPath"||n==="FS_createDataFile"||n==="FS_createPreloadedFile"||n==="FS_unlink"||n==="addRunDependency"||n==="FS_createLazyFile"||n==="FS_createDevice"||n==="removeRunDependency"}function xt(n,a){typeof globalThis>"u"||Object.getOwnPropertyDescriptor(globalThis,n)||Object.defineProperty(globalThis,n,{configurable:!0,get(){a()}})}function vt(n,a){xt(n,()=>{Le(`\`${n}\` is not longer defined by emscripten. ${a}`)})}function Ot(n){Object.getOwnPropertyDescriptor(e,n)||Object.defineProperty(e,n,{configurable:!0,get(){var a=`'${n}' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)`;Tt(n)&&(a+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),z(a)}})}vt("buffer","Please use HEAP8.buffer or wasmMemory.buffer"),vt("asm","Please use wasmExports instead");var _t=n=>{n.forEach(a=>a(e))};e.noExitRuntime;var Qe=n=>(T(typeof n=="number"),"0x"+(n>>>=0).toString(16).padStart(8,"0")),he=n=>Ht(n),De=()=>Xt(),Le=n=>{Le.shown||={},Le.shown[n]||(Le.shown[n]=1,C(n))},kt=typeof TextDecoder<"u"?new TextDecoder:void 0,He=(n,a=0,s=NaN)=>{for(var l=a+s,c=a;n[c]&&!(c>=l);)++c;if(c-a>16&&n.buffer&&kt)return kt.decode(n.subarray(a,c));for(var g="";a<c;){var f=n[a++];if(128&f){var A=63&n[a++];if((224&f)!=192){var S=63&n[a++];if((240&f)==224?f=(15&f)<<12|A<<6|S:((248&f)!=240&&Le("Invalid UTF-8 leading byte "+Qe(f)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),f=(7&f)<<18|A<<12|S<<6|63&n[a++]),f<65536)g+=String.fromCharCode(f);else{var I=f-65536;g+=String.fromCharCode(55296|I>>10,56320|1023&I)}}else g+=String.fromCharCode((31&f)<<6|A)}else g+=String.fromCharCode(f)}return g},Ne=(n,a)=>(T(typeof n=="number",`UTF8ToString expects a number (got ${typeof n})`),n?He($,n,a):"");function at(){T(Y.varargs!=null);var n=O[+Y.varargs>>2];return Y.varargs+=4,n}var Ke=at,q={isAbs:n=>n.charAt(0)==="/",splitPath:n=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(n).slice(1),normalizeArray:(n,a)=>{for(var s=0,l=n.length-1;l>=0;l--){var c=n[l];c==="."?n.splice(l,1):c===".."?(n.splice(l,1),s++):s&&(n.splice(l,1),s--)}if(a)for(;s;s--)n.unshift("..");return n},normalize:n=>{var a=q.isAbs(n),s=n.substr(-1)==="/";return(n=q.normalizeArray(n.split("/").filter(l=>!!l),!a).join("/"))||a||(n="."),n&&s&&(n+="/"),(a?"/":"")+n},dirname:n=>{var a=q.splitPath(n),s=a[0],l=a[1];return s||l?(l&&(l=l.substr(0,l.length-1)),s+l):"."},basename:n=>{if(n==="/")return"/";var a=(n=(n=q.normalize(n)).replace(/\/$/,"")).lastIndexOf("/");return a===-1?n:n.substr(a+1)},join:(...n)=>q.normalize(n.join("/")),join2:(n,a)=>q.normalize(n+"/"+a)},wt=n=>(wt=(()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return a=>crypto.getRandomValues(a);z("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: (array) => { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")})())(n),Se={resolve:(...n)=>{for(var a="",s=!1,l=n.length-1;l>=-1&&!s;l--){var c=l>=0?n[l]:F.cwd();if(typeof c!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!c)return"";a=c+"/"+a,s=q.isAbs(c)}return(s?"/":"")+(a=q.normalizeArray(a.split("/").filter(g=>!!g),!s).join("/"))||"."},relative:(n,a)=>{function s(I){for(var j=0;j<I.length&&I[j]==="";j++);for(var k=I.length-1;k>=0&&I[k]==="";k--);return j>k?[]:I.slice(j,k-j+1)}n=Se.resolve(n).substr(1),a=Se.resolve(a).substr(1);for(var l=s(n.split("/")),c=s(a.split("/")),g=Math.min(l.length,c.length),f=g,A=0;A<g;A++)if(l[A]!==c[A]){f=A;break}var S=[];for(A=f;A<l.length;A++)S.push("..");return(S=S.concat(c.slice(f))).join("/")}},ct=[],Ze=n=>{for(var a=0,s=0;s<n.length;++s){var l=n.charCodeAt(s);l<=127?a++:l<=2047?a+=2:l>=55296&&l<=57343?(a+=4,++s):a+=3}return a},Pt=(n,a,s,l)=>{if(T(typeof n=="string",`stringToUTF8Array expects a string (got ${typeof n})`),!(l>0))return 0;for(var c=s,g=s+l-1,f=0;f<n.length;++f){var A=n.charCodeAt(f);if(A>=55296&&A<=57343&&(A=65536+((1023&A)<<10)|1023&n.charCodeAt(++f)),A<=127){if(s>=g)break;a[s++]=A}else if(A<=2047){if(s+1>=g)break;a[s++]=192|A>>6,a[s++]=128|63&A}else if(A<=65535){if(s+2>=g)break;a[s++]=224|A>>12,a[s++]=128|A>>6&63,a[s++]=128|63&A}else{if(s+3>=g)break;A>1114111&&Le("Invalid Unicode code point "+Qe(A)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),a[s++]=240|A>>18,a[s++]=128|A>>12&63,a[s++]=128|A>>6&63,a[s++]=128|63&A}}return a[s]=0,s-c};function Rt(n,a,s){var l=Ze(n)+1,c=new Array(l),g=Pt(n,c,0,c.length);return c.length=g,c}var ke,Ve,Ue={ttys:[],init(){},shutdown(){},register(n,a){Ue.ttys[n]={input:[],output:[],ops:a},F.registerDevice(n,Ue.stream_ops)},stream_ops:{open(n){var a=Ue.ttys[n.node.rdev];if(!a)throw new F.ErrnoError(43);n.tty=a,n.seekable=!1},close(n){n.tty.ops.fsync(n.tty)},fsync(n){n.tty.ops.fsync(n.tty)},read(n,a,s,l,c){if(!n.tty||!n.tty.ops.get_char)throw new F.ErrnoError(60);for(var g=0,f=0;f<l;f++){var A;try{A=n.tty.ops.get_char(n.tty)}catch{throw new F.ErrnoError(29)}if(A===void 0&&g===0)throw new F.ErrnoError(6);if(A==null)break;g++,a[s+f]=A}return g&&(n.node.timestamp=Date.now()),g},write(n,a,s,l,c){if(!n.tty||!n.tty.ops.put_char)throw new F.ErrnoError(60);try{for(var g=0;g<l;g++)n.tty.ops.put_char(n.tty,a[s+g])}catch{throw new F.ErrnoError(29)}return l&&(n.node.timestamp=Date.now()),g}},default_tty_ops:{get_char:n=>(()=>{if(!ct.length){var a=null;if(typeof window<"u"&&typeof window.prompt=="function"?(a=window.prompt("Input: "))!==null&&(a+=`
`):typeof readline=="function"&&(a=readline())&&(a+=`
`),!a)return null;ct=Rt(a)}return ct.shift()})(),put_char(n,a){a===null||a===10?(v(He(n.output)),n.output=[]):a!=0&&n.output.push(a)},fsync(n){n.output&&n.output.length>0&&(v(He(n.output)),n.output=[])},ioctl_tcgets:n=>({c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}),ioctl_tcsets:(n,a,s)=>0,ioctl_tiocgwinsz:n=>[24,80]},default_tty1_ops:{put_char(n,a){a===null||a===10?(C(He(n.output)),n.output=[]):a!=0&&n.output.push(a)},fsync(n){n.output&&n.output.length>0&&(C(He(n.output)),n.output=[])}}},It=(n,a)=>(T(a,"alignment argument is required"),Math.ceil(n/a)*a),jt=n=>{n=It(n,65536);var a=cn(65536,n);return a&&((s,l)=>{$.fill(0,s,s+l)})(a,n),a},W={ops_table:null,mount:n=>W.createNode(null,"/",16895,0),createNode(n,a,s,l){if(F.isBlkdev(s)||F.isFIFO(s))throw new F.ErrnoError(63);W.ops_table||={dir:{node:{getattr:W.node_ops.getattr,setattr:W.node_ops.setattr,lookup:W.node_ops.lookup,mknod:W.node_ops.mknod,rename:W.node_ops.rename,unlink:W.node_ops.unlink,rmdir:W.node_ops.rmdir,readdir:W.node_ops.readdir,symlink:W.node_ops.symlink},stream:{llseek:W.stream_ops.llseek}},file:{node:{getattr:W.node_ops.getattr,setattr:W.node_ops.setattr},stream:{llseek:W.stream_ops.llseek,read:W.stream_ops.read,write:W.stream_ops.write,allocate:W.stream_ops.allocate,mmap:W.stream_ops.mmap,msync:W.stream_ops.msync}},link:{node:{getattr:W.node_ops.getattr,setattr:W.node_ops.setattr,readlink:W.node_ops.readlink},stream:{}},chrdev:{node:{getattr:W.node_ops.getattr,setattr:W.node_ops.setattr},stream:F.chrdev_stream_ops}};var c=F.createNode(n,a,s,l);return F.isDir(c.mode)?(c.node_ops=W.ops_table.dir.node,c.stream_ops=W.ops_table.dir.stream,c.contents={}):F.isFile(c.mode)?(c.node_ops=W.ops_table.file.node,c.stream_ops=W.ops_table.file.stream,c.usedBytes=0,c.contents=null):F.isLink(c.mode)?(c.node_ops=W.ops_table.link.node,c.stream_ops=W.ops_table.link.stream):F.isChrdev(c.mode)&&(c.node_ops=W.ops_table.chrdev.node,c.stream_ops=W.ops_table.chrdev.stream),c.timestamp=Date.now(),n&&(n.contents[a]=c,n.timestamp=c.timestamp),c},getFileDataAsTypedArray:n=>n.contents?n.contents.subarray?n.contents.subarray(0,n.usedBytes):new Uint8Array(n.contents):new Uint8Array(0),expandFileStorage(n,a){var s=n.contents?n.contents.length:0;if(!(s>=a)){a=Math.max(a,s*(s<1048576?2:1.125)>>>0),s!=0&&(a=Math.max(a,256));var l=n.contents;n.contents=new Uint8Array(a),n.usedBytes>0&&n.contents.set(l.subarray(0,n.usedBytes),0)}},resizeFileStorage(n,a){if(n.usedBytes!=a)if(a==0)n.contents=null,n.usedBytes=0;else{var s=n.contents;n.contents=new Uint8Array(a),s&&n.contents.set(s.subarray(0,Math.min(a,n.usedBytes))),n.usedBytes=a}},node_ops:{getattr(n){var a={};return a.dev=F.isChrdev(n.mode)?n.id:1,a.ino=n.id,a.mode=n.mode,a.nlink=1,a.uid=0,a.gid=0,a.rdev=n.rdev,F.isDir(n.mode)?a.size=4096:F.isFile(n.mode)?a.size=n.usedBytes:F.isLink(n.mode)?a.size=n.link.length:a.size=0,a.atime=new Date(n.timestamp),a.mtime=new Date(n.timestamp),a.ctime=new Date(n.timestamp),a.blksize=4096,a.blocks=Math.ceil(a.size/a.blksize),a},setattr(n,a){a.mode!==void 0&&(n.mode=a.mode),a.timestamp!==void 0&&(n.timestamp=a.timestamp),a.size!==void 0&&W.resizeFileStorage(n,a.size)},lookup(n,a){throw F.genericErrors[44]},mknod:(n,a,s,l)=>W.createNode(n,a,s,l),rename(n,a,s){if(F.isDir(n.mode)){var l;try{l=F.lookupNode(a,s)}catch{}if(l)for(var c in l.contents)throw new F.ErrnoError(55)}delete n.parent.contents[n.name],n.parent.timestamp=Date.now(),n.name=s,a.contents[s]=n,a.timestamp=n.parent.timestamp},unlink(n,a){delete n.contents[a],n.timestamp=Date.now()},rmdir(n,a){var s=F.lookupNode(n,a);for(var l in s.contents)throw new F.ErrnoError(55);delete n.contents[a],n.timestamp=Date.now()},readdir(n){var a=[".",".."];for(var s of Object.keys(n.contents))a.push(s);return a},symlink(n,a,s){var l=W.createNode(n,a,41471,0);return l.link=s,l},readlink(n){if(!F.isLink(n.mode))throw new F.ErrnoError(28);return n.link}},stream_ops:{read(n,a,s,l,c){var g=n.node.contents;if(c>=n.node.usedBytes)return 0;var f=Math.min(n.node.usedBytes-c,l);if(T(f>=0),f>8&&g.subarray)a.set(g.subarray(c,c+f),s);else for(var A=0;A<f;A++)a[s+A]=g[c+A];return f},write(n,a,s,l,c,g){if(T(!(a instanceof ArrayBuffer)),a.buffer===V.buffer&&(g=!1),!l)return 0;var f=n.node;if(f.timestamp=Date.now(),a.subarray&&(!f.contents||f.contents.subarray)){if(g)return T(c===0,"canOwn must imply no weird position inside the file"),f.contents=a.subarray(s,s+l),f.usedBytes=l,l;if(f.usedBytes===0&&c===0)return f.contents=a.slice(s,s+l),f.usedBytes=l,l;if(c+l<=f.usedBytes)return f.contents.set(a.subarray(s,s+l),c),l}if(W.expandFileStorage(f,c+l),f.contents.subarray&&a.subarray)f.contents.set(a.subarray(s,s+l),c);else for(var A=0;A<l;A++)f.contents[c+A]=a[s+A];return f.usedBytes=Math.max(f.usedBytes,c+l),l},llseek(n,a,s){var l=a;if(s===1?l+=n.position:s===2&&F.isFile(n.node.mode)&&(l+=n.node.usedBytes),l<0)throw new F.ErrnoError(28);return l},allocate(n,a,s){W.expandFileStorage(n.node,a+s),n.node.usedBytes=Math.max(n.node.usedBytes,a+s)},mmap(n,a,s,l,c){if(!F.isFile(n.node.mode))throw new F.ErrnoError(43);var g,f,A=n.node.contents;if(2&c||!A||A.buffer!==V.buffer){if(f=!0,!(g=jt(a)))throw new F.ErrnoError(48);A&&((s>0||s+a<A.length)&&(A=A.subarray?A.subarray(s,s+a):Array.prototype.slice.call(A,s,s+a)),V.set(A,g))}else f=!1,g=A.byteOffset;return{ptr:g,allocated:f}},msync:(n,a,s,l,c)=>(W.stream_ops.write(n,a,0,l,s,!1),0)}},sn=e.preloadPlugins||[],gt=(n,a)=>{var s=0;return n&&(s|=365),a&&(s|=146),s},Bt={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135},F={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:class extends Error{constructor(n){for(var a in super(Ee?(s=>Ne(Pn(s)))(n):""),this.name="ErrnoError",this.errno=n,Bt)if(Bt[a]===n){this.code=a;break}}},genericErrors:{},filesystems:null,syncFSRequests:0,readFiles:{},FSStream:class{constructor(){this.shared={}}get object(){return this.node}set object(n){this.node=n}get isRead(){return(2097155&this.flags)!=1}get isWrite(){return!!(2097155&this.flags)}get isAppend(){return 1024&this.flags}get flags(){return this.shared.flags}set flags(n){this.shared.flags=n}get position(){return this.shared.position}set position(n){this.shared.position=n}},FSNode:class{constructor(n,a,s,l){n||(n=this),this.parent=n,this.mount=n.mount,this.mounted=null,this.id=F.nextInode++,this.name=a,this.mode=s,this.node_ops={},this.stream_ops={},this.rdev=l,this.readMode=365,this.writeMode=146}get read(){return(this.mode&this.readMode)===this.readMode}set read(n){n?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(n){n?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return F.isDir(this.mode)}get isDevice(){return F.isChrdev(this.mode)}},lookupPath(n,a={}){if(!(n=Se.resolve(n)))return{path:"",node:null};if((a=Object.assign({follow_mount:!0,recurse_count:0},a)).recurse_count>8)throw new F.ErrnoError(32);for(var s=n.split("/").filter(I=>!!I),l=F.root,c="/",g=0;g<s.length;g++){var f=g===s.length-1;if(f&&a.parent)break;if(l=F.lookupNode(l,s[g]),c=q.join2(c,s[g]),F.isMountpoint(l)&&(!f||f&&a.follow_mount)&&(l=l.mounted.root),!f||a.follow)for(var A=0;F.isLink(l.mode);){var S=F.readlink(c);if(c=Se.resolve(q.dirname(c),S),l=F.lookupPath(c,{recurse_count:a.recurse_count+1}).node,A++>40)throw new F.ErrnoError(32)}}return{path:c,node:l}},getPath(n){for(var a;;){if(F.isRoot(n)){var s=n.mount.mountpoint;return a?s[s.length-1]!=="/"?`${s}/${a}`:s+a:s}a=a?`${n.name}/${a}`:n.name,n=n.parent}},hashName(n,a){for(var s=0,l=0;l<a.length;l++)s=(s<<5)-s+a.charCodeAt(l)|0;return(n+s>>>0)%F.nameTable.length},hashAddNode(n){var a=F.hashName(n.parent.id,n.name);n.name_next=F.nameTable[a],F.nameTable[a]=n},hashRemoveNode(n){var a=F.hashName(n.parent.id,n.name);if(F.nameTable[a]===n)F.nameTable[a]=n.name_next;else for(var s=F.nameTable[a];s;){if(s.name_next===n){s.name_next=n.name_next;break}s=s.name_next}},lookupNode(n,a){var s=F.mayLookup(n);if(s)throw new F.ErrnoError(s);for(var l=F.hashName(n.id,a),c=F.nameTable[l];c;c=c.name_next){var g=c.name;if(c.parent.id===n.id&&g===a)return c}return F.lookup(n,a)},createNode(n,a,s,l){T(typeof n=="object");var c=new F.FSNode(n,a,s,l);return F.hashAddNode(c),c},destroyNode(n){F.hashRemoveNode(n)},isRoot:n=>n===n.parent,isMountpoint:n=>!!n.mounted,isFile:n=>(61440&n)==32768,isDir:n=>(61440&n)==16384,isLink:n=>(61440&n)==40960,isChrdev:n=>(61440&n)==8192,isBlkdev:n=>(61440&n)==24576,isFIFO:n=>(61440&n)==4096,isSocket:n=>!(49152&~n),flagsToPermissionString(n){var a=["r","w","rw"][3&n];return 512&n&&(a+="w"),a},nodePermissions:(n,a)=>F.ignorePermissions||(!a.includes("r")||292&n.mode)&&(!a.includes("w")||146&n.mode)&&(!a.includes("x")||73&n.mode)?0:2,mayLookup(n){if(!F.isDir(n.mode))return 54;var a=F.nodePermissions(n,"x");return a||(n.node_ops.lookup?0:2)},mayCreate(n,a){try{return F.lookupNode(n,a),20}catch{}return F.nodePermissions(n,"wx")},mayDelete(n,a,s){var l;try{l=F.lookupNode(n,a)}catch(g){return g.errno}var c=F.nodePermissions(n,"wx");if(c)return c;if(s){if(!F.isDir(l.mode))return 54;if(F.isRoot(l)||F.getPath(l)===F.cwd())return 10}else if(F.isDir(l.mode))return 31;return 0},mayOpen:(n,a)=>n?F.isLink(n.mode)?32:F.isDir(n.mode)&&(F.flagsToPermissionString(a)!=="r"||512&a)?31:F.nodePermissions(n,F.flagsToPermissionString(a)):44,MAX_OPEN_FDS:4096,nextfd(){for(var n=0;n<=F.MAX_OPEN_FDS;n++)if(!F.streams[n])return n;throw new F.ErrnoError(33)},getStreamChecked(n){var a=F.getStream(n);if(!a)throw new F.ErrnoError(8);return a},getStream:n=>F.streams[n],createStream:(n,a=-1)=>(T(a>=-1),n=Object.assign(new F.FSStream,n),a==-1&&(a=F.nextfd()),n.fd=a,F.streams[a]=n,n),closeStream(n){F.streams[n]=null},dupStream(n,a=-1){var s=F.createStream(n,a);return s.stream_ops?.dup?.(s),s},chrdev_stream_ops:{open(n){var a=F.getDevice(n.node.rdev);n.stream_ops=a.stream_ops,n.stream_ops.open?.(n)},llseek(){throw new F.ErrnoError(70)}},major:n=>n>>8,minor:n=>255&n,makedev:(n,a)=>n<<8|a,registerDevice(n,a){F.devices[n]={stream_ops:a}},getDevice:n=>F.devices[n],getMounts(n){for(var a=[],s=[n];s.length;){var l=s.pop();a.push(l),s.push(...l.mounts)}return a},syncfs(n,a){typeof n=="function"&&(a=n,n=!1),F.syncFSRequests++,F.syncFSRequests>1&&C(`warning: ${F.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var s=F.getMounts(F.root.mount),l=0;function c(f){return T(F.syncFSRequests>0),F.syncFSRequests--,a(f)}function g(f){if(f)return g.errored?void 0:(g.errored=!0,c(f));++l>=s.length&&c(null)}s.forEach(f=>{if(!f.type.syncfs)return g(null);f.type.syncfs(f,n,g)})},mount(n,a,s){if(typeof n=="string")throw n;var l,c=s==="/",g=!s;if(c&&F.root)throw new F.ErrnoError(10);if(!c&&!g){var f=F.lookupPath(s,{follow_mount:!1});if(s=f.path,l=f.node,F.isMountpoint(l))throw new F.ErrnoError(10);if(!F.isDir(l.mode))throw new F.ErrnoError(54)}var A={type:n,opts:a,mountpoint:s,mounts:[]},S=n.mount(A);return S.mount=A,A.root=S,c?F.root=S:l&&(l.mounted=A,l.mount&&l.mount.mounts.push(A)),S},unmount(n){var a=F.lookupPath(n,{follow_mount:!1});if(!F.isMountpoint(a.node))throw new F.ErrnoError(28);var s=a.node,l=s.mounted,c=F.getMounts(l);Object.keys(F.nameTable).forEach(f=>{for(var A=F.nameTable[f];A;){var S=A.name_next;c.includes(A.mount)&&F.destroyNode(A),A=S}}),s.mounted=null;var g=s.mount.mounts.indexOf(l);T(g!==-1),s.mount.mounts.splice(g,1)},lookup:(n,a)=>n.node_ops.lookup(n,a),mknod(n,a,s){var l=F.lookupPath(n,{parent:!0}).node,c=q.basename(n);if(!c||c==="."||c==="..")throw new F.ErrnoError(28);var g=F.mayCreate(l,c);if(g)throw new F.ErrnoError(g);if(!l.node_ops.mknod)throw new F.ErrnoError(63);return l.node_ops.mknod(l,c,a,s)},create:(n,a)=>(a=a!==void 0?a:438,a&=4095,a|=32768,F.mknod(n,a,0)),mkdir:(n,a)=>(a=a!==void 0?a:511,a&=1023,a|=16384,F.mknod(n,a,0)),mkdirTree(n,a){for(var s=n.split("/"),l="",c=0;c<s.length;++c)if(s[c]){l+="/"+s[c];try{F.mkdir(l,a)}catch(g){if(g.errno!=20)throw g}}},mkdev:(n,a,s)=>(s===void 0&&(s=a,a=438),a|=8192,F.mknod(n,a,s)),symlink(n,a){if(!Se.resolve(n))throw new F.ErrnoError(44);var s=F.lookupPath(a,{parent:!0}).node;if(!s)throw new F.ErrnoError(44);var l=q.basename(a),c=F.mayCreate(s,l);if(c)throw new F.ErrnoError(c);if(!s.node_ops.symlink)throw new F.ErrnoError(63);return s.node_ops.symlink(s,l,n)},rename(n,a){var s,l,c=q.dirname(n),g=q.dirname(a),f=q.basename(n),A=q.basename(a);if(s=F.lookupPath(n,{parent:!0}).node,l=F.lookupPath(a,{parent:!0}).node,!s||!l)throw new F.ErrnoError(44);if(s.mount!==l.mount)throw new F.ErrnoError(75);var S,I=F.lookupNode(s,f),j=Se.relative(n,g);if(j.charAt(0)!==".")throw new F.ErrnoError(28);if((j=Se.relative(a,c)).charAt(0)!==".")throw new F.ErrnoError(55);try{S=F.lookupNode(l,A)}catch{}if(I!==S){var k=F.isDir(I.mode),w=F.mayDelete(s,f,k);if(w)throw new F.ErrnoError(w);if(w=S?F.mayDelete(l,A,k):F.mayCreate(l,A))throw new F.ErrnoError(w);if(!s.node_ops.rename)throw new F.ErrnoError(63);if(F.isMountpoint(I)||S&&F.isMountpoint(S))throw new F.ErrnoError(10);if(l!==s&&(w=F.nodePermissions(s,"w")))throw new F.ErrnoError(w);F.hashRemoveNode(I);try{s.node_ops.rename(I,l,A),I.parent=l}catch(B){throw B}finally{F.hashAddNode(I)}}},rmdir(n){var a=F.lookupPath(n,{parent:!0}).node,s=q.basename(n),l=F.lookupNode(a,s),c=F.mayDelete(a,s,!0);if(c)throw new F.ErrnoError(c);if(!a.node_ops.rmdir)throw new F.ErrnoError(63);if(F.isMountpoint(l))throw new F.ErrnoError(10);a.node_ops.rmdir(a,s),F.destroyNode(l)},readdir(n){var a=F.lookupPath(n,{follow:!0}).node;if(!a.node_ops.readdir)throw new F.ErrnoError(54);return a.node_ops.readdir(a)},unlink(n){var a=F.lookupPath(n,{parent:!0}).node;if(!a)throw new F.ErrnoError(44);var s=q.basename(n),l=F.lookupNode(a,s),c=F.mayDelete(a,s,!1);if(c)throw new F.ErrnoError(c);if(!a.node_ops.unlink)throw new F.ErrnoError(63);if(F.isMountpoint(l))throw new F.ErrnoError(10);a.node_ops.unlink(a,s),F.destroyNode(l)},readlink(n){var a=F.lookupPath(n).node;if(!a)throw new F.ErrnoError(44);if(!a.node_ops.readlink)throw new F.ErrnoError(28);return Se.resolve(F.getPath(a.parent),a.node_ops.readlink(a))},stat(n,a){var s=F.lookupPath(n,{follow:!a}).node;if(!s)throw new F.ErrnoError(44);if(!s.node_ops.getattr)throw new F.ErrnoError(63);return s.node_ops.getattr(s)},lstat:n=>F.stat(n,!0),chmod(n,a,s){var l;if(!(l=typeof n=="string"?F.lookupPath(n,{follow:!s}).node:n).node_ops.setattr)throw new F.ErrnoError(63);l.node_ops.setattr(l,{mode:4095&a|-4096&l.mode,timestamp:Date.now()})},lchmod(n,a){F.chmod(n,a,!0)},fchmod(n,a){var s=F.getStreamChecked(n);F.chmod(s.node,a)},chown(n,a,s,l){var c;if(!(c=typeof n=="string"?F.lookupPath(n,{follow:!l}).node:n).node_ops.setattr)throw new F.ErrnoError(63);c.node_ops.setattr(c,{timestamp:Date.now()})},lchown(n,a,s){F.chown(n,a,s,!0)},fchown(n,a,s){var l=F.getStreamChecked(n);F.chown(l.node,a,s)},truncate(n,a){if(a<0)throw new F.ErrnoError(28);var s;if(!(s=typeof n=="string"?F.lookupPath(n,{follow:!0}).node:n).node_ops.setattr)throw new F.ErrnoError(63);if(F.isDir(s.mode))throw new F.ErrnoError(31);if(!F.isFile(s.mode))throw new F.ErrnoError(28);var l=F.nodePermissions(s,"w");if(l)throw new F.ErrnoError(l);s.node_ops.setattr(s,{size:a,timestamp:Date.now()})},ftruncate(n,a){var s=F.getStreamChecked(n);if(!(2097155&s.flags))throw new F.ErrnoError(28);F.truncate(s.node,a)},utime(n,a,s){var l=F.lookupPath(n,{follow:!0}).node;l.node_ops.setattr(l,{timestamp:Math.max(a,s)})},open(n,a,s){if(n==="")throw new F.ErrnoError(44);var l;if(s=64&(a=typeof a=="string"?(A=>{var S={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[A];if(S===void 0)throw new Error(`Unknown file open mode: ${A}`);return S})(a):a)?4095&(s=s===void 0?438:s)|32768:0,typeof n=="object")l=n;else{n=q.normalize(n);try{l=F.lookupPath(n,{follow:!(131072&a)}).node}catch{}}var c=!1;if(64&a)if(l){if(128&a)throw new F.ErrnoError(20)}else l=F.mknod(n,s,0),c=!0;if(!l)throw new F.ErrnoError(44);if(F.isChrdev(l.mode)&&(a&=-513),65536&a&&!F.isDir(l.mode))throw new F.ErrnoError(54);if(!c){var g=F.mayOpen(l,a);if(g)throw new F.ErrnoError(g)}512&a&&!c&&F.truncate(l,0),a&=-131713;var f=F.createStream({node:l,path:F.getPath(l),flags:a,seekable:!0,position:0,stream_ops:l.stream_ops,ungotten:[],error:!1});return f.stream_ops.open&&f.stream_ops.open(f),!e.logReadFiles||1&a||n in F.readFiles||(F.readFiles[n]=1),f},close(n){if(F.isClosed(n))throw new F.ErrnoError(8);n.getdents&&(n.getdents=null);try{n.stream_ops.close&&n.stream_ops.close(n)}catch(a){throw a}finally{F.closeStream(n.fd)}n.fd=null},isClosed:n=>n.fd===null,llseek(n,a,s){if(F.isClosed(n))throw new F.ErrnoError(8);if(!n.seekable||!n.stream_ops.llseek)throw new F.ErrnoError(70);if(s!=0&&s!=1&&s!=2)throw new F.ErrnoError(28);return n.position=n.stream_ops.llseek(n,a,s),n.ungotten=[],n.position},read(n,a,s,l,c){if(T(s>=0),l<0||c<0)throw new F.ErrnoError(28);if(F.isClosed(n))throw new F.ErrnoError(8);if((2097155&n.flags)==1)throw new F.ErrnoError(8);if(F.isDir(n.node.mode))throw new F.ErrnoError(31);if(!n.stream_ops.read)throw new F.ErrnoError(28);var g=c!==void 0;if(g){if(!n.seekable)throw new F.ErrnoError(70)}else c=n.position;var f=n.stream_ops.read(n,a,s,l,c);return g||(n.position+=f),f},write(n,a,s,l,c,g){if(T(s>=0),l<0||c<0)throw new F.ErrnoError(28);if(F.isClosed(n))throw new F.ErrnoError(8);if(!(2097155&n.flags))throw new F.ErrnoError(8);if(F.isDir(n.node.mode))throw new F.ErrnoError(31);if(!n.stream_ops.write)throw new F.ErrnoError(28);n.seekable&&1024&n.flags&&F.llseek(n,0,2);var f=c!==void 0;if(f){if(!n.seekable)throw new F.ErrnoError(70)}else c=n.position;var A=n.stream_ops.write(n,a,s,l,c,g);return f||(n.position+=A),A},allocate(n,a,s){if(F.isClosed(n))throw new F.ErrnoError(8);if(a<0||s<=0)throw new F.ErrnoError(28);if(!(2097155&n.flags))throw new F.ErrnoError(8);if(!F.isFile(n.node.mode)&&!F.isDir(n.node.mode))throw new F.ErrnoError(43);if(!n.stream_ops.allocate)throw new F.ErrnoError(138);n.stream_ops.allocate(n,a,s)},mmap(n,a,s,l,c){if(2&l&&!(2&c)&&(2097155&n.flags)!=2)throw new F.ErrnoError(2);if((2097155&n.flags)==1)throw new F.ErrnoError(2);if(!n.stream_ops.mmap)throw new F.ErrnoError(43);if(!a)throw new F.ErrnoError(28);return n.stream_ops.mmap(n,a,s,l,c)},msync:(n,a,s,l,c)=>(T(s>=0),n.stream_ops.msync?n.stream_ops.msync(n,a,s,l,c):0),ioctl(n,a,s){if(!n.stream_ops.ioctl)throw new F.ErrnoError(59);return n.stream_ops.ioctl(n,a,s)},readFile(n,a={}){if(a.flags=a.flags||0,a.encoding=a.encoding||"binary",a.encoding!=="utf8"&&a.encoding!=="binary")throw new Error(`Invalid encoding type "${a.encoding}"`);var s,l=F.open(n,a.flags),c=F.stat(n).size,g=new Uint8Array(c);return F.read(l,g,0,c,0),a.encoding==="utf8"?s=He(g):a.encoding==="binary"&&(s=g),F.close(l),s},writeFile(n,a,s={}){s.flags=s.flags||577;var l=F.open(n,s.flags,s.mode);if(typeof a=="string"){var c=new Uint8Array(Ze(a)+1),g=Pt(a,c,0,c.length);F.write(l,c,0,g,void 0,s.canOwn)}else{if(!ArrayBuffer.isView(a))throw new Error("Unsupported data type");F.write(l,a,0,a.byteLength,void 0,s.canOwn)}F.close(l)},cwd:()=>F.currentPath,chdir(n){var a=F.lookupPath(n,{follow:!0});if(a.node===null)throw new F.ErrnoError(44);if(!F.isDir(a.node.mode))throw new F.ErrnoError(54);var s=F.nodePermissions(a.node,"x");if(s)throw new F.ErrnoError(s);F.currentPath=a.path},createDefaultDirectories(){F.mkdir("/tmp"),F.mkdir("/home"),F.mkdir("/home/web_user")},createDefaultDevices(){F.mkdir("/dev"),F.registerDevice(F.makedev(1,3),{read:()=>0,write:(l,c,g,f,A)=>f}),F.mkdev("/dev/null",F.makedev(1,3)),Ue.register(F.makedev(5,0),Ue.default_tty_ops),Ue.register(F.makedev(6,0),Ue.default_tty1_ops),F.mkdev("/dev/tty",F.makedev(5,0)),F.mkdev("/dev/tty1",F.makedev(6,0));var n=new Uint8Array(1024),a=0,s=()=>(a===0&&(a=wt(n).byteLength),n[--a]);F.createDevice("/dev","random",s),F.createDevice("/dev","urandom",s),F.mkdir("/dev/shm"),F.mkdir("/dev/shm/tmp")},createSpecialDirectories(){F.mkdir("/proc");var n=F.mkdir("/proc/self");F.mkdir("/proc/self/fd"),F.mount({mount(){var a=F.createNode(n,"fd",16895,73);return a.node_ops={lookup(s,l){var c=+l,g=F.getStreamChecked(c),f={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>g.path}};return f.parent=f,f}},a}},{},"/proc/self/fd")},createStandardStreams(n,a,s){n?F.createDevice("/dev","stdin",n):F.symlink("/dev/tty","/dev/stdin"),a?F.createDevice("/dev","stdout",null,a):F.symlink("/dev/tty","/dev/stdout"),s?F.createDevice("/dev","stderr",null,s):F.symlink("/dev/tty1","/dev/stderr");var l=F.open("/dev/stdin",0),c=F.open("/dev/stdout",1),g=F.open("/dev/stderr",1);T(l.fd===0,`invalid handle for stdin (${l.fd})`),T(c.fd===1,`invalid handle for stdout (${c.fd})`),T(g.fd===2,`invalid handle for stderr (${g.fd})`)},staticInit(){[44].forEach(n=>{F.genericErrors[n]=new F.ErrnoError(n),F.genericErrors[n].stack="<generic error, no stack>"}),F.nameTable=new Array(4096),F.mount(W,{},"/"),F.createDefaultDirectories(),F.createDefaultDevices(),F.createSpecialDirectories(),F.filesystems={MEMFS:W}},init(n,a,s){T(!F.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),F.initialized=!0,n??=e.stdin,a??=e.stdout,s??=e.stderr,F.createStandardStreams(n,a,s)},quit(){F.initialized=!1,_n(0);for(var n=0;n<F.streams.length;n++){var a=F.streams[n];a&&F.close(a)}},findObject(n,a){var s=F.analyzePath(n,a);return s.exists?s.object:null},analyzePath(n,a){try{n=(l=F.lookupPath(n,{follow:!a})).path}catch{}var s={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var l=F.lookupPath(n,{parent:!0});s.parentExists=!0,s.parentPath=l.path,s.parentObject=l.node,s.name=q.basename(n),l=F.lookupPath(n,{follow:!a}),s.exists=!0,s.path=l.path,s.object=l.node,s.name=l.node.name,s.isRoot=l.path==="/"}catch(c){s.error=c.errno}return s},createPath(n,a,s,l){n=typeof n=="string"?n:F.getPath(n);for(var c=a.split("/").reverse();c.length;){var g=c.pop();if(g){var f=q.join2(n,g);try{F.mkdir(f)}catch{}n=f}}return f},createFile(n,a,s,l,c){var g=q.join2(typeof n=="string"?n:F.getPath(n),a),f=gt(l,c);return F.create(g,f)},createDataFile(n,a,s,l,c,g){var f=a;n&&(n=typeof n=="string"?n:F.getPath(n),f=a?q.join2(n,a):n);var A=gt(l,c),S=F.create(f,A);if(s){if(typeof s=="string"){for(var I=new Array(s.length),j=0,k=s.length;j<k;++j)I[j]=s.charCodeAt(j);s=I}F.chmod(S,146|A);var w=F.open(S,577);F.write(w,s,0,s.length,0,g),F.close(w),F.chmod(S,A)}},createDevice(n,a,s,l){var c=q.join2(typeof n=="string"?n:F.getPath(n),a),g=gt(!!s,!!l);F.createDevice.major??=64;var f=F.makedev(F.createDevice.major++,0);return F.registerDevice(f,{open(A){A.seekable=!1},close(A){l?.buffer?.length&&l(10)},read(A,S,I,j,k){for(var w=0,B=0;B<j;B++){var Q;try{Q=s()}catch{throw new F.ErrnoError(29)}if(Q===void 0&&w===0)throw new F.ErrnoError(6);if(Q==null)break;w++,S[I+B]=Q}return w&&(A.node.timestamp=Date.now()),w},write(A,S,I,j,k){for(var w=0;w<j;w++)try{l(S[I+w])}catch{throw new F.ErrnoError(29)}return j&&(A.node.timestamp=Date.now()),w}}),F.mkdev(c,g,f)},forceLoadFile(n){if(n.isDevice||n.isFolder||n.link||n.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{n.contents=P(n.url),n.usedBytes=n.contents.length}catch{throw new F.ErrnoError(29)}},createLazyFile(n,a,s,l,c){class g{constructor(){this.lengthKnown=!1,this.chunks=[]}get(k){if(!(k>this.length-1||k<0)){var w=k%this.chunkSize,B=k/this.chunkSize|0;return this.getter(B)[w]}}setDataGetter(k){this.getter=k}cacheLength(){var k=new XMLHttpRequest;if(k.open("HEAD",s,!1),k.send(null),!(k.status>=200&&k.status<300||k.status===304))throw new Error("Couldn't load "+s+". Status: "+k.status);var w,B=Number(k.getResponseHeader("Content-length")),Q=(w=k.getResponseHeader("Accept-Ranges"))&&w==="bytes",J=(w=k.getResponseHeader("Content-Encoding"))&&w==="gzip",ee=1048576;Q||(ee=B);var te=this;te.setDataGetter(be=>{var We=be*ee,we=(be+1)*ee-1;if(we=Math.min(we,B-1),te.chunks[be]===void 0&&(te.chunks[be]=((nt,ut)=>{if(nt>ut)throw new Error("invalid range ("+nt+", "+ut+") or no bytes requested!");if(ut>B-1)throw new Error("only "+B+" bytes available! programmer error!");var le=new XMLHttpRequest;if(le.open("GET",s,!1),B!==ee&&le.setRequestHeader("Range","bytes="+nt+"-"+ut),le.responseType="arraybuffer",le.overrideMimeType&&le.overrideMimeType("text/plain; charset=x-user-defined"),le.send(null),!(le.status>=200&&le.status<300||le.status===304))throw new Error("Couldn't load "+s+". Status: "+le.status);return le.response!==void 0?new Uint8Array(le.response||[]):Rt(le.responseText||"")})(We,we)),te.chunks[be]===void 0)throw new Error("doXHR failed!");return te.chunks[be]}),!J&&B||(ee=B=1,B=this.getter(0).length,ee=B,v("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=B,this._chunkSize=ee,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!d)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var f={isDevice:!1,contents:new g}}else f={isDevice:!1,url:s};var A=F.createFile(n,a,f,l,c);f.contents?A.contents=f.contents:f.url&&(A.contents=null,A.url=f.url),Object.defineProperties(A,{usedBytes:{get:function(){return this.contents.length}}});var S={};function I(j,k,w,B,Q){var J=j.node.contents;if(Q>=J.length)return 0;var ee=Math.min(J.length-Q,B);if(T(ee>=0),J.slice)for(var te=0;te<ee;te++)k[w+te]=J[Q+te];else for(te=0;te<ee;te++)k[w+te]=J.get(Q+te);return ee}return Object.keys(A.stream_ops).forEach(j=>{var k=A.stream_ops[j];S[j]=(...w)=>(F.forceLoadFile(A),k(...w))}),S.read=(j,k,w,B,Q)=>(F.forceLoadFile(A),I(j,k,w,B,Q)),S.mmap=(j,k,w,B,Q)=>{F.forceLoadFile(A);var J=jt(k);if(!J)throw new F.ErrnoError(48);return I(j,V,J,k,w),{ptr:J,allocated:!0}},A.stream_ops=S,A},absolutePath(){z("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder(){z("FS.createFolder has been removed; use FS.mkdir instead")},createLink(){z("FS.createLink has been removed; use FS.symlink instead")},joinPath(){z("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc(){z("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath(){z("FS.standardizePath has been removed; use PATH.normalize instead")}},Y={DEFAULT_POLLMASK:5,calculateAt(n,a,s){if(q.isAbs(a))return a;var l;if(l=n===-100?F.cwd():Y.getStreamFromFD(n).path,a.length==0){if(!s)throw new F.ErrnoError(44);return l}return q.join2(l,a)},doStat(n,a,s){var l=n(a);O[s>>2]=l.dev,O[s+4>>2]=l.mode,K[s+8>>2]=l.nlink,O[s+12>>2]=l.uid,O[s+16>>2]=l.gid,O[s+20>>2]=l.rdev,Z=[l.size>>>0,(N=l.size,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],O[s+24>>2]=Z[0],O[s+28>>2]=Z[1],O[s+32>>2]=4096,O[s+36>>2]=l.blocks;var c=l.atime.getTime(),g=l.mtime.getTime(),f=l.ctime.getTime();return Z=[Math.floor(c/1e3)>>>0,(N=Math.floor(c/1e3),+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],O[s+40>>2]=Z[0],O[s+44>>2]=Z[1],K[s+48>>2]=c%1e3*1e3*1e3,Z=[Math.floor(g/1e3)>>>0,(N=Math.floor(g/1e3),+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],O[s+56>>2]=Z[0],O[s+60>>2]=Z[1],K[s+64>>2]=g%1e3*1e3*1e3,Z=[Math.floor(f/1e3)>>>0,(N=Math.floor(f/1e3),+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],O[s+72>>2]=Z[0],O[s+76>>2]=Z[1],K[s+80>>2]=f%1e3*1e3*1e3,Z=[l.ino>>>0,(N=l.ino,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],O[s+88>>2]=Z[0],O[s+92>>2]=Z[1],0},doMsync(n,a,s,l,c){if(!F.isFile(a.node.mode))throw new F.ErrnoError(43);if(2&l)return 0;var g=$.slice(n,n+s);F.msync(a,g,c,s,l)},getStreamFromFD:n=>F.getStreamChecked(n),varargs:void 0,getStr:n=>Ne(n)},it=(n,a)=>(T(n==n>>>0||n==(0|n)),T(a===(0|a)),a+2097152>>>0<4194305-!!n?(n>>>0)+4294967296*a:NaN),$e=(n,a,s)=>(T(typeof s=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),Pt(n,$,a,s)),un=[0,31,60,91,121,152,182,213,244,274,305,335],mn=[0,31,59,90,120,151,181,212,243,273,304,334],Fn=n=>{var a=R.buffer,s=(n-a.byteLength+65535)/65536|0;try{return R.grow(s),Re(),1}catch(l){C(`growMemory: Attempted to grow heap from ${a.byteLength} bytes to ${n} bytes, but got error: ${l}`)}},ht={},et=()=>{if(!et.strings){var n={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:M||"./this.program"};for(var a in ht)ht[a]===void 0?delete n[a]:n[a]=ht[a];var s=[];for(var a in n)s.push(`${a}=${n[a]}`);et.strings=s}return et.strings},tt=[],ce=n=>{var a=tt[n];return a||(n>=tt.length&&(tt.length=n+1),tt[n]=a=ke.get(n)),T(ke.get(n)==a,"JavaScript-side Wasm function table mirror is out of date!"),a},Lt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Nt=(n,a)=>{T(n<16384),n<128?a.push(n):a.push(n%128|128,n>>7)},ln=(n,a)=>{if(T(!a.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled"),typeof WebAssembly.Function=="function")return new WebAssembly.Function((g=>{T(!g.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled");for(var f={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},A={parameters:[],results:g[0]=="v"?[]:[f[g[0]]]},S=1;S<g.length;++S)T(g[S]in f,"invalid signature char: "+g[S]),A.parameters.push(f[g[S]]);return A})(a),n);var s=[1];((g,f)=>{var A=g.slice(0,1),S=g.slice(1),I={i:127,p:127,j:126,f:125,d:124,e:111};f.push(96),Nt(S.length,f);for(var j=0;j<S.length;++j)T(S[j]in I,"invalid signature char: "+S[j]),f.push(I[S[j]]);A=="v"?f.push(0):f.push(1,I[A])})(a,s);var l=[0,97,115,109,1,0,0,0,1];Nt(s.length,l),l.push(...s),l.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var c=new WebAssembly.Module(new Uint8Array(l));return new WebAssembly.Instance(c,{e:{f:n}}).exports.f},dn=n=>(Ve||(Ve=new WeakMap,((a,s)=>{if(Ve)for(var l=a;l<a+s;l++){var c=ce(l);c&&Ve.set(c,l)}})(0,ke.length)),Ve.get(n)||0),Dt=[],bt=(n,a)=>{ke.set(n,a),tt[n]=ke.get(n)},Vt=n=>Kt(n),Ut=(n,a,s,l,c)=>{var g={string:w=>{var B=0;return w!=null&&w!==0&&(B=(Q=>{var J=Ze(Q)+1,ee=Vt(J);return $e(Q,ee,J),ee})(w)),B},array:w=>{var B,Q,J=Vt(w.length);return Q=J,T((B=w).length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),V.set(B,Q),J}},f=(w=>{var B=e["_"+w];return T(B,"Cannot call unknown function "+w+", make sure it is exported"),B})(n),A=[],S=0;if(T(a!=="array",'Return type should not be "array".'),l)for(var I=0;I<l.length;I++){var j=g[s[I]];j?(S===0&&(S=De()),A[I]=j(l[I])):A[I]=l[I]}var k=f(...A);return k=(function(w){return S!==0&&he(S),(function(B){return a==="string"?Ne(B):a==="boolean"?!!B:B})(w)})(k)};F.createPreloadedFile=(n,a,s,l,c,g,f,A,S,I)=>{var j=a?Se.resolve(q.join2(n,a)):n,k=je(`cp ${j}`);function w(B){function Q(J){I?.(),A||((ee,te,be,We,we,nt)=>{F.createDataFile(ee,te,be,We,we,nt)})(n,a,J,l,c,S),g?.(),me(k)}((J,ee,te,be)=>{typeof Browser<"u"&&Browser.init();var We=!1;return sn.forEach(we=>{We||we.canHandle(ee)&&(we.handle(J,ee,te,be),We=!0)}),We})(B,j,Q,()=>{f?.(),me(k)})||Q(B)}ve(k),typeof s=="string"?((B,Q,J)=>{var ee=je(`al ${B}`);_(B).then(te=>{T(te,`Loading data file "${B}" failed (no arrayBuffer).`),Q(new Uint8Array(te)),ee&&me(ee)},te=>{if(!J)throw`Loading data file "${B}" failed.`;J()}),ee&&ve(ee)})(s,w,f):w(s)},F.staticInit();var $t={__assert_fail:(n,a,s,l)=>{z(`Assertion failed: ${Ne(n)}, at: `+[a?Ne(a):"unknown filename",s,l?Ne(l):"unknown function"])},__syscall_fcntl64:function(n,a,s){Y.varargs=s;try{var l=Y.getStreamFromFD(n);switch(a){case 0:if((c=at())<0)return-28;for(;F.streams[c];)c++;return F.dupStream(l,c).fd;case 1:case 2:case 13:case 14:return 0;case 3:return l.flags;case 4:var c=at();return l.flags|=c,0;case 12:return c=Ke(),X[c+0>>1]=2,0}return-28}catch(g){if(F===void 0||g.name!=="ErrnoError")throw g;return-g.errno}},__syscall_fstat64:function(n,a){try{var s=Y.getStreamFromFD(n);return Y.doStat(F.stat,s.path,a)}catch(l){if(F===void 0||l.name!=="ErrnoError")throw l;return-l.errno}},__syscall_ftruncate64:function(n,a,s){var l=it(a,s);try{return isNaN(l)?61:(F.ftruncate(n,l),0)}catch(c){if(F===void 0||c.name!=="ErrnoError")throw c;return-c.errno}},__syscall_getdents64:function(n,a,s){try{var l=Y.getStreamFromFD(n);l.getdents||=F.readdir(l.path);for(var c=280,g=0,f=F.llseek(l,0,1),A=Math.floor(f/c);A<l.getdents.length&&g+c<=s;){var S,I,j=l.getdents[A];if(j===".")S=l.node.id,I=4;else if(j==="..")S=F.lookupPath(l.path,{parent:!0}).node.id,I=4;else{var k=F.lookupNode(l.node,j);S=k.id,I=F.isChrdev(k.mode)?2:F.isDir(k.mode)?4:F.isLink(k.mode)?10:8}T(S),Z=[S>>>0,(N=S,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],O[a+g>>2]=Z[0],O[a+g+4>>2]=Z[1],Z=[(A+1)*c>>>0,(N=(A+1)*c,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],O[a+g+8>>2]=Z[0],O[a+g+12>>2]=Z[1],X[a+g+16>>1]=280,V[a+g+18]=I,$e(j,a+g+19,256),g+=c,A+=1}return F.llseek(l,A*c,0),g}catch(w){if(F===void 0||w.name!=="ErrnoError")throw w;return-w.errno}},__syscall_ioctl:function(n,a,s){Y.varargs=s;try{var l=Y.getStreamFromFD(n);switch(a){case 21509:case 21510:case 21511:case 21512:case 21524:case 21515:return l.tty?0:-59;case 21505:if(!l.tty)return-59;if(l.tty.ops.ioctl_tcgets){var c=l.tty.ops.ioctl_tcgets(l),g=Ke();O[g>>2]=c.c_iflag||0,O[g+4>>2]=c.c_oflag||0,O[g+8>>2]=c.c_cflag||0,O[g+12>>2]=c.c_lflag||0;for(var f=0;f<32;f++)V[g+f+17]=c.c_cc[f]||0;return 0}return 0;case 21506:case 21507:case 21508:if(!l.tty)return-59;if(l.tty.ops.ioctl_tcsets){g=Ke();var A=O[g>>2],S=O[g+4>>2],I=O[g+8>>2],j=O[g+12>>2],k=[];for(f=0;f<32;f++)k.push(V[g+f+17]);return l.tty.ops.ioctl_tcsets(l.tty,a,{c_iflag:A,c_oflag:S,c_cflag:I,c_lflag:j,c_cc:k})}return 0;case 21519:return l.tty?(g=Ke(),O[g>>2]=0,0):-59;case 21520:return l.tty?-28:-59;case 21531:return g=Ke(),F.ioctl(l,a,g);case 21523:if(!l.tty)return-59;if(l.tty.ops.ioctl_tiocgwinsz){var w=l.tty.ops.ioctl_tiocgwinsz(l.tty);g=Ke(),X[g>>1]=w[0],X[g+2>>1]=w[1]}return 0;default:return-28}}catch(B){if(F===void 0||B.name!=="ErrnoError")throw B;return-B.errno}},__syscall_lstat64:function(n,a){try{return n=Y.getStr(n),Y.doStat(F.lstat,n,a)}catch(s){if(F===void 0||s.name!=="ErrnoError")throw s;return-s.errno}},__syscall_newfstatat:function(n,a,s,l){try{a=Y.getStr(a);var c=256&l,g=4096&l;return T(!(l&=-6401),`unknown flags in __syscall_newfstatat: ${l}`),a=Y.calculateAt(n,a,g),Y.doStat(c?F.lstat:F.stat,a,s)}catch(f){if(F===void 0||f.name!=="ErrnoError")throw f;return-f.errno}},__syscall_openat:function(n,a,s,l){Y.varargs=l;try{a=Y.getStr(a),a=Y.calculateAt(n,a);var c=l?at():0;return F.open(a,s,c).fd}catch(g){if(F===void 0||g.name!=="ErrnoError")throw g;return-g.errno}},__syscall_rmdir:function(n){try{return n=Y.getStr(n),F.rmdir(n),0}catch(a){if(F===void 0||a.name!=="ErrnoError")throw a;return-a.errno}},__syscall_stat64:function(n,a){try{return n=Y.getStr(n),Y.doStat(F.stat,n,a)}catch(s){if(F===void 0||s.name!=="ErrnoError")throw s;return-s.errno}},__syscall_unlinkat:function(n,a,s){try{return a=Y.getStr(a),a=Y.calculateAt(n,a),s===0?F.unlink(a):s===512?F.rmdir(a):z("Invalid flags passed to unlinkat"),0}catch(l){if(F===void 0||l.name!=="ErrnoError")throw l;return-l.errno}},_abort_js:()=>{z("native code called abort()")},_emscripten_memcpy_js:(n,a,s)=>$.copyWithin(n,a,a+s),_emscripten_throw_longjmp:()=>{throw 1/0},_gmtime_js:function(n,a,s){var l=it(n,a),c=new Date(1e3*l);O[s>>2]=c.getUTCSeconds(),O[s+4>>2]=c.getUTCMinutes(),O[s+8>>2]=c.getUTCHours(),O[s+12>>2]=c.getUTCDate(),O[s+16>>2]=c.getUTCMonth(),O[s+20>>2]=c.getUTCFullYear()-1900,O[s+24>>2]=c.getUTCDay();var g=Date.UTC(c.getUTCFullYear(),0,1,0,0,0,0),f=(c.getTime()-g)/864e5|0;O[s+28>>2]=f},_localtime_js:function(n,a,s){var l=it(n,a),c=new Date(1e3*l);O[s>>2]=c.getSeconds(),O[s+4>>2]=c.getMinutes(),O[s+8>>2]=c.getHours(),O[s+12>>2]=c.getDate(),O[s+16>>2]=c.getMonth(),O[s+20>>2]=c.getFullYear()-1900,O[s+24>>2]=c.getDay();var g=0|(j=>{var k;return((k=j.getFullYear())%4!=0||k%100==0&&k%400!=0?mn:un)[j.getMonth()]+j.getDate()-1})(c);O[s+28>>2]=g,O[s+36>>2]=-60*c.getTimezoneOffset();var f=new Date(c.getFullYear(),0,1),A=new Date(c.getFullYear(),6,1).getTimezoneOffset(),S=f.getTimezoneOffset(),I=0|(A!=S&&c.getTimezoneOffset()==Math.min(S,A));O[s+32>>2]=I},_tzset_js:(n,a,s,l)=>{var c=new Date().getFullYear(),g=new Date(c,0,1),f=new Date(c,6,1),A=g.getTimezoneOffset(),S=f.getTimezoneOffset(),I=Math.max(A,S);K[n>>2]=60*I,O[a>>2]=+(A!=S);var j=B=>{var Q=B>=0?"-":"+",J=Math.abs(B);return`UTC${Q}${String(Math.floor(J/60)).padStart(2,"0")}${String(J%60).padStart(2,"0")}`},k=j(A),w=j(S);T(k),T(w),T(Ze(k)<=16,`timezone name truncated to fit in TZNAME_MAX (${k})`),T(Ze(w)<=16,`timezone name truncated to fit in TZNAME_MAX (${w})`),S<A?($e(k,s,17),$e(w,l,17)):($e(k,l,17),$e(w,s,17))},emscripten_date_now:()=>Date.now(),emscripten_resize_heap:n=>{var a=$.length;T((n>>>=0)>a);var s=2147483648;if(n>s)return C(`Cannot enlarge memory, requested ${n} bytes, but the limit is 2147483648 bytes!`),!1;for(var l=1;l<=4;l*=2){var c=a*(1+.2/l);c=Math.min(c,n+100663296);var g=Math.min(s,It(Math.max(n,c),65536));if(Fn(g))return!0}return C(`Failed to grow the heap from ${a} bytes to ${g} bytes, not enough memory!`),!1},environ_get:(n,a)=>{var s=0;return et().forEach((l,c)=>{var g=a+s;K[n+4*c>>2]=g,((f,A)=>{for(var S=0;S<f.length;++S)T(f.charCodeAt(S)===(255&f.charCodeAt(S))),V[A++]=f.charCodeAt(S);V[A]=0})(l,g),s+=l.length+1}),0},environ_sizes_get:(n,a)=>{var s=et();K[n>>2]=s.length;var l=0;return s.forEach(c=>l+=c.length+1),K[a>>2]=l,0},fd_close:function(n){try{var a=Y.getStreamFromFD(n);return F.close(a),0}catch(s){if(F===void 0||s.name!=="ErrnoError")throw s;return s.errno}},fd_read:function(n,a,s,l){try{var c=((g,f,A,S)=>{for(var I=0,j=0;j<A;j++){var k=K[f>>2],w=K[f+4>>2];f+=8;var B=F.read(g,V,k,w,S);if(B<0)return-1;if(I+=B,B<w)break}return I})(Y.getStreamFromFD(n),a,s);return K[l>>2]=c,0}catch(g){if(F===void 0||g.name!=="ErrnoError")throw g;return g.errno}},fd_seek:function(n,a,s,l,c){var g=it(a,s);try{if(isNaN(g))return 61;var f=Y.getStreamFromFD(n);return F.llseek(f,g,l),Z=[f.position>>>0,(N=f.position,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],O[c>>2]=Z[0],O[c+4>>2]=Z[1],f.getdents&&g===0&&l===0&&(f.getdents=null),0}catch(A){if(F===void 0||A.name!=="ErrnoError")throw A;return A.errno}},fd_sync:function(n){try{var a=Y.getStreamFromFD(n);return a.stream_ops?.fsync?a.stream_ops.fsync(a):0}catch(s){if(F===void 0||s.name!=="ErrnoError")throw s;return s.errno}},fd_write:function(n,a,s,l){try{var c=((g,f,A,S)=>{for(var I=0,j=0;j<A;j++){var k=K[f>>2],w=K[f+4>>2];f+=8;var B=F.write(g,V,k,w,S);if(B<0)return-1;if(I+=B,B<w)break}return I})(Y.getStreamFromFD(n),a,s);return K[l>>2]=c,0}catch(g){if(F===void 0||g.name!=="ErrnoError")throw g;return g.errno}},invoke_ii:function(n,a){var s=De();try{return ce(n)(a)}catch(l){if(he(s),l!==l+0)throw l;Ce(1,0)}},invoke_iii:function(n,a,s){var l=De();try{return ce(n)(a,s)}catch(c){if(he(l),c!==c+0)throw c;Ce(1,0)}},invoke_iiii:function(n,a,s,l){var c=De();try{return ce(n)(a,s,l)}catch(g){if(he(c),g!==g+0)throw g;Ce(1,0)}},invoke_iiiii:function(n,a,s,l,c){var g=De();try{return ce(n)(a,s,l,c)}catch(f){if(he(g),f!==f+0)throw f;Ce(1,0)}},invoke_v:function(n){var a=De();try{ce(n)()}catch(s){if(he(a),s!==s+0)throw s;Ce(1,0)}},invoke_vii:function(n,a,s){var l=De();try{ce(n)(a,s)}catch(c){if(he(l),c!==c+0)throw c;Ce(1,0)}},invoke_viii:function(n,a,s,l){var c=De();try{ce(n)(a,s,l)}catch(g){if(he(c),g!==g+0)throw g;Ce(1,0)}},invoke_viiii:function(n,a,s,l,c){var g=De();try{ce(n)(a,s,l,c)}catch(f){if(he(g),f!==f+0)throw f;Ce(1,0)}},invoke_viiiiiiiii:function(n,a,s,l,c,g,f,A,S,I){var j=De();try{ce(n)(a,s,l,c,g,f,A,S,I)}catch(k){if(he(j),k!==k+0)throw k;Ce(1,0)}}},Fe=(function(){var n={env:$t,wasi_snapshot_preview1:$t};function a(A,S){var I;return Fe=A.exports,e.wasmExports=Fe,T(R=Fe.memory,"memory not found in wasm exports"),Re(),T(ke=Fe.__indirect_function_table,"table not found in wasm exports"),I=Fe.__wasm_call_ctors,dt.unshift(I),me("wasm-instantiate"),Fe}ve("wasm-instantiate");var s,l,c,g,f=e;if(e.instantiateWasm)try{return e.instantiateWasm(n,a)}catch(A){C(`Module.instantiateWasm callback failed with error: ${A}`),o(A)}return Oe??=an(),(s=U,l=Oe,c=n,g=function(A){T(e===f,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),f=null,a(A.instance)},s||typeof WebAssembly.instantiateStreaming!="function"||ye(l)||typeof fetch!="function"?Ct(l,c,g):fetch(l,{credentials:"same-origin"}).then(A=>WebAssembly.instantiateStreaming(A,c).then(g,function(S){return C(`wasm streaming compile failed: ${S}`),C("falling back to ArrayBuffer instantiation"),Ct(l,c,g)}))).catch(o),{}})();e._PDFiumExt_Init=i("PDFiumExt_Init",0),e._FPDF_InitLibraryWithConfig=i("FPDF_InitLibraryWithConfig",1),e._PDFiumExt_OpenFileWriter=i("PDFiumExt_OpenFileWriter",0),e._PDFiumExt_GetFileWriterSize=i("PDFiumExt_GetFileWriterSize",1),e._PDFiumExt_GetFileWriterData=i("PDFiumExt_GetFileWriterData",3),e._PDFiumExt_CloseFileWriter=i("PDFiumExt_CloseFileWriter",1),e._PDFiumExt_SaveAsCopy=i("PDFiumExt_SaveAsCopy",2),e._FPDF_SaveAsCopy=i("FPDF_SaveAsCopy",3),e._PDFiumExt_OpenFormFillInfo=i("PDFiumExt_OpenFormFillInfo",0),e._PDFiumExt_CloseFormFillInfo=i("PDFiumExt_CloseFormFillInfo",1),e._PDFiumExt_InitFormFillEnvironment=i("PDFiumExt_InitFormFillEnvironment",2),e._FPDFDOC_InitFormFillEnvironment=i("FPDFDOC_InitFormFillEnvironment",2),e._PDFiumExt_ExitFormFillEnvironment=i("PDFiumExt_ExitFormFillEnvironment",1),e._FPDFDOC_ExitFormFillEnvironment=i("FPDFDOC_ExitFormFillEnvironment",1),e._EPDFNamedDest_SetDest=i("EPDFNamedDest_SetDest",3),e._EPDFNamedDest_Remove=i("EPDFNamedDest_Remove",2),e._EPDFDest_CreateView=i("EPDFDest_CreateView",4),e._EPDFDest_CreateXYZ=i("EPDFDest_CreateXYZ",7),e._EPDFDest_CreateRemoteView=i("EPDFDest_CreateRemoteView",5),e._EPDFDest_CreateRemoteXYZ=i("EPDFDest_CreateRemoteXYZ",8),e._EPDFAction_CreateGoTo=i("EPDFAction_CreateGoTo",2),e._EPDFAction_CreateGoToNamed=i("EPDFAction_CreateGoToNamed",2),e._EPDFAction_CreateLaunch=i("EPDFAction_CreateLaunch",2),e._EPDFAction_CreateRemoteGoToByName=i("EPDFAction_CreateRemoteGoToByName",3),e._EPDFAction_CreateRemoteGoToDest=i("EPDFAction_CreateRemoteGoToDest",3),e._EPDFAction_CreateURI=i("EPDFAction_CreateURI",2),e._EPDFBookmark_Create=i("EPDFBookmark_Create",2),e._EPDFBookmark_Delete=i("EPDFBookmark_Delete",2),e._EPDFBookmark_AppendChild=i("EPDFBookmark_AppendChild",3),e._EPDFBookmark_InsertAfter=i("EPDFBookmark_InsertAfter",4),e._EPDFBookmark_Clear=i("EPDFBookmark_Clear",1),e._EPDFBookmark_SetTitle=i("EPDFBookmark_SetTitle",2),e._EPDFBookmark_SetDest=i("EPDFBookmark_SetDest",3),e._EPDFBookmark_SetAction=i("EPDFBookmark_SetAction",3),e._EPDFBookmark_ClearTarget=i("EPDFBookmark_ClearTarget",1),e._EPDF_PNG_EncodeRGBA=i("EPDF_PNG_EncodeRGBA",6),e._FPDFAnnot_IsSupportedSubtype=i("FPDFAnnot_IsSupportedSubtype",1),e._FPDFPage_CreateAnnot=i("FPDFPage_CreateAnnot",2),e._FPDFPage_GetAnnotCount=i("FPDFPage_GetAnnotCount",1),e._FPDFPage_GetAnnot=i("FPDFPage_GetAnnot",2),e._FPDFPage_GetAnnotIndex=i("FPDFPage_GetAnnotIndex",2),e._FPDFPage_CloseAnnot=i("FPDFPage_CloseAnnot",1),e._FPDFPage_RemoveAnnot=i("FPDFPage_RemoveAnnot",2),e._FPDFAnnot_GetSubtype=i("FPDFAnnot_GetSubtype",1),e._FPDFAnnot_IsObjectSupportedSubtype=i("FPDFAnnot_IsObjectSupportedSubtype",1),e._FPDFAnnot_UpdateObject=i("FPDFAnnot_UpdateObject",2),e._FPDFAnnot_AddInkStroke=i("FPDFAnnot_AddInkStroke",3),e._FPDFAnnot_RemoveInkList=i("FPDFAnnot_RemoveInkList",1),e._FPDFAnnot_AppendObject=i("FPDFAnnot_AppendObject",2),e._FPDFAnnot_GetObjectCount=i("FPDFAnnot_GetObjectCount",1),e._FPDFAnnot_GetObject=i("FPDFAnnot_GetObject",2),e._FPDFAnnot_RemoveObject=i("FPDFAnnot_RemoveObject",2),e._FPDFAnnot_SetColor=i("FPDFAnnot_SetColor",6),e._FPDFAnnot_GetColor=i("FPDFAnnot_GetColor",6),e._FPDFAnnot_HasAttachmentPoints=i("FPDFAnnot_HasAttachmentPoints",1),e._FPDFAnnot_SetAttachmentPoints=i("FPDFAnnot_SetAttachmentPoints",3),e._FPDFAnnot_AppendAttachmentPoints=i("FPDFAnnot_AppendAttachmentPoints",2),e._FPDFAnnot_CountAttachmentPoints=i("FPDFAnnot_CountAttachmentPoints",1),e._FPDFAnnot_GetAttachmentPoints=i("FPDFAnnot_GetAttachmentPoints",3),e._FPDFAnnot_SetRect=i("FPDFAnnot_SetRect",2),e._FPDFAnnot_GetRect=i("FPDFAnnot_GetRect",2),e._FPDFAnnot_GetVertices=i("FPDFAnnot_GetVertices",3),e._FPDFAnnot_GetInkListCount=i("FPDFAnnot_GetInkListCount",1),e._FPDFAnnot_GetInkListPath=i("FPDFAnnot_GetInkListPath",4),e._FPDFAnnot_GetLine=i("FPDFAnnot_GetLine",3),e._FPDFAnnot_SetBorder=i("FPDFAnnot_SetBorder",4),e._FPDFAnnot_GetBorder=i("FPDFAnnot_GetBorder",4),e._FPDFAnnot_HasKey=i("FPDFAnnot_HasKey",2),e._FPDFAnnot_GetValueType=i("FPDFAnnot_GetValueType",2),e._FPDFAnnot_SetStringValue=i("FPDFAnnot_SetStringValue",3),e._FPDFAnnot_GetStringValue=i("FPDFAnnot_GetStringValue",4),e._FPDFAnnot_GetNumberValue=i("FPDFAnnot_GetNumberValue",3),e._FPDFAnnot_SetAP=i("FPDFAnnot_SetAP",3),e._FPDFAnnot_GetAP=i("FPDFAnnot_GetAP",4),e._FPDFAnnot_GetLinkedAnnot=i("FPDFAnnot_GetLinkedAnnot",2),e._FPDFAnnot_GetFlags=i("FPDFAnnot_GetFlags",1),e._FPDFAnnot_SetFlags=i("FPDFAnnot_SetFlags",2),e._FPDFAnnot_GetFormFieldFlags=i("FPDFAnnot_GetFormFieldFlags",2),e._FPDFAnnot_SetFormFieldFlags=i("FPDFAnnot_SetFormFieldFlags",3),e._FPDFAnnot_GetFormFieldAtPoint=i("FPDFAnnot_GetFormFieldAtPoint",3),e._FPDFAnnot_GetFormFieldName=i("FPDFAnnot_GetFormFieldName",4),e._FPDFAnnot_GetFormFieldType=i("FPDFAnnot_GetFormFieldType",2),e._FPDFAnnot_GetFormAdditionalActionJavaScript=i("FPDFAnnot_GetFormAdditionalActionJavaScript",5),e._FPDFAnnot_GetFormFieldAlternateName=i("FPDFAnnot_GetFormFieldAlternateName",4),e._FPDFAnnot_GetFormFieldValue=i("FPDFAnnot_GetFormFieldValue",4),e._FPDFAnnot_GetOptionCount=i("FPDFAnnot_GetOptionCount",2),e._FPDFAnnot_GetOptionLabel=i("FPDFAnnot_GetOptionLabel",5),e._FPDFAnnot_IsOptionSelected=i("FPDFAnnot_IsOptionSelected",3),e._FPDFAnnot_GetFontSize=i("FPDFAnnot_GetFontSize",3),e._FPDFAnnot_SetFontColor=i("FPDFAnnot_SetFontColor",5),e._FPDFAnnot_GetFontColor=i("FPDFAnnot_GetFontColor",5),e._FPDFAnnot_IsChecked=i("FPDFAnnot_IsChecked",2),e._FPDFAnnot_SetFocusableSubtypes=i("FPDFAnnot_SetFocusableSubtypes",3),e._FPDFAnnot_GetFocusableSubtypesCount=i("FPDFAnnot_GetFocusableSubtypesCount",1),e._FPDFAnnot_GetFocusableSubtypes=i("FPDFAnnot_GetFocusableSubtypes",3),e._FPDFAnnot_GetLink=i("FPDFAnnot_GetLink",1),e._FPDFAnnot_GetFormControlCount=i("FPDFAnnot_GetFormControlCount",2),e._FPDFAnnot_GetFormControlIndex=i("FPDFAnnot_GetFormControlIndex",2),e._FPDFAnnot_GetFormFieldExportValue=i("FPDFAnnot_GetFormFieldExportValue",4),e._FPDFAnnot_SetURI=i("FPDFAnnot_SetURI",2),e._FPDFAnnot_GetFileAttachment=i("FPDFAnnot_GetFileAttachment",1),e._FPDFAnnot_AddFileAttachment=i("FPDFAnnot_AddFileAttachment",2),e._EPDFAnnot_SetColor=i("EPDFAnnot_SetColor",5),e._EPDFAnnot_GetColor=i("EPDFAnnot_GetColor",5),e._EPDFAnnot_ClearColor=i("EPDFAnnot_ClearColor",2),e._EPDFAnnot_SetOpacity=i("EPDFAnnot_SetOpacity",2),e._EPDFAnnot_GetOpacity=i("EPDFAnnot_GetOpacity",2),e._EPDFAnnot_GetBorderEffect=i("EPDFAnnot_GetBorderEffect",2),e._EPDFAnnot_GetRectangleDifferences=i("EPDFAnnot_GetRectangleDifferences",5),e._EPDFAnnot_GetBorderDashPatternCount=i("EPDFAnnot_GetBorderDashPatternCount",1),e._EPDFAnnot_GetBorderDashPattern=i("EPDFAnnot_GetBorderDashPattern",3),e._EPDFAnnot_SetBorderDashPattern=i("EPDFAnnot_SetBorderDashPattern",3),e._EPDFAnnot_GetBorderStyle=i("EPDFAnnot_GetBorderStyle",2),e._EPDFAnnot_SetBorderStyle=i("EPDFAnnot_SetBorderStyle",3),e._EPDFAnnot_GenerateAppearance=i("EPDFAnnot_GenerateAppearance",1),e._EPDFAnnot_GenerateAppearanceWithBlend=i("EPDFAnnot_GenerateAppearanceWithBlend",2),e._EPDFAnnot_GetBlendMode=i("EPDFAnnot_GetBlendMode",1),e._EPDFAnnot_SetIntent=i("EPDFAnnot_SetIntent",2),e._EPDFAnnot_GetIntent=i("EPDFAnnot_GetIntent",3),e._EPDFAnnot_GetRichContent=i("EPDFAnnot_GetRichContent",3),e._EPDFAnnot_SetLineEndings=i("EPDFAnnot_SetLineEndings",3),e._EPDFAnnot_GetLineEndings=i("EPDFAnnot_GetLineEndings",3),e._EPDFAnnot_SetVertices=i("EPDFAnnot_SetVertices",3),e._EPDFAnnot_SetLine=i("EPDFAnnot_SetLine",3),e._EPDFAnnot_SetDefaultAppearance=i("EPDFAnnot_SetDefaultAppearance",6),e._EPDFAnnot_GetDefaultAppearance=i("EPDFAnnot_GetDefaultAppearance",6),e._EPDFAnnot_SetTextAlignment=i("EPDFAnnot_SetTextAlignment",2),e._EPDFAnnot_GetTextAlignment=i("EPDFAnnot_GetTextAlignment",1),e._EPDFAnnot_SetVerticalAlignment=i("EPDFAnnot_SetVerticalAlignment",2),e._EPDFAnnot_GetVerticalAlignment=i("EPDFAnnot_GetVerticalAlignment",1),e._EPDFPage_GetAnnotByName=i("EPDFPage_GetAnnotByName",2),e._EPDFPage_RemoveAnnotByName=i("EPDFPage_RemoveAnnotByName",2),e._EPDFAnnot_SetLinkedAnnot=i("EPDFAnnot_SetLinkedAnnot",3),e._EPDFPage_GetAnnotCountRaw=i("EPDFPage_GetAnnotCountRaw",2),e._EPDFPage_GetAnnotRaw=i("EPDFPage_GetAnnotRaw",3),e._EPDFPage_RemoveAnnotRaw=i("EPDFPage_RemoveAnnotRaw",3),e._EPDFAnnot_SetIcon=i("EPDFAnnot_SetIcon",2),e._EPDFAnnot_GetIcon=i("EPDFAnnot_GetIcon",1),e._EPDFAnnot_UpdateAppearanceToRect=i("EPDFAnnot_UpdateAppearanceToRect",2),e._EPDFPage_CreateAnnot=i("EPDFPage_CreateAnnot",2),e._FPDFDoc_GetAttachmentCount=i("FPDFDoc_GetAttachmentCount",1),e._FPDFDoc_AddAttachment=i("FPDFDoc_AddAttachment",2),e._FPDFDoc_GetAttachment=i("FPDFDoc_GetAttachment",2),e._FPDFDoc_DeleteAttachment=i("FPDFDoc_DeleteAttachment",2),e._FPDFAttachment_GetName=i("FPDFAttachment_GetName",3),e._FPDFAttachment_HasKey=i("FPDFAttachment_HasKey",2),e._FPDFAttachment_GetValueType=i("FPDFAttachment_GetValueType",2),e._FPDFAttachment_SetStringValue=i("FPDFAttachment_SetStringValue",3),e._FPDFAttachment_GetStringValue=i("FPDFAttachment_GetStringValue",4),e._FPDFAttachment_SetFile=i("FPDFAttachment_SetFile",4),e._FPDFAttachment_GetFile=i("FPDFAttachment_GetFile",4),e._FPDFAttachment_GetSubtype=i("FPDFAttachment_GetSubtype",3),e._EPDFAttachment_SetSubtype=i("EPDFAttachment_SetSubtype",2),e._EPDFAttachment_SetDescription=i("EPDFAttachment_SetDescription",2),e._EPDFAttachment_GetDescription=i("EPDFAttachment_GetDescription",3),e._EPDFAttachment_GetIntegerValue=i("EPDFAttachment_GetIntegerValue",3),e._FPDFCatalog_IsTagged=i("FPDFCatalog_IsTagged",1),e._FPDFCatalog_SetLanguage=i("FPDFCatalog_SetLanguage",2),e._EPDFCatalog_GetLanguage=i("EPDFCatalog_GetLanguage",3),e._FPDFAvail_Create=i("FPDFAvail_Create",2),e._FPDFAvail_Destroy=i("FPDFAvail_Destroy",1),e._FPDFAvail_IsDocAvail=i("FPDFAvail_IsDocAvail",2),e._FPDFAvail_GetDocument=i("FPDFAvail_GetDocument",2),e._FPDFAvail_GetFirstPageNum=i("FPDFAvail_GetFirstPageNum",1),e._FPDFAvail_IsPageAvail=i("FPDFAvail_IsPageAvail",3),e._FPDFAvail_IsFormAvail=i("FPDFAvail_IsFormAvail",2),e._FPDFAvail_IsLinearized=i("FPDFAvail_IsLinearized",1),e._FPDFBookmark_GetFirstChild=i("FPDFBookmark_GetFirstChild",2),e._FPDFBookmark_GetNextSibling=i("FPDFBookmark_GetNextSibling",2),e._FPDFBookmark_GetTitle=i("FPDFBookmark_GetTitle",3),e._FPDFBookmark_GetCount=i("FPDFBookmark_GetCount",1),e._FPDFBookmark_Find=i("FPDFBookmark_Find",2),e._FPDFBookmark_GetDest=i("FPDFBookmark_GetDest",2),e._FPDFBookmark_GetAction=i("FPDFBookmark_GetAction",1),e._FPDFAction_GetType=i("FPDFAction_GetType",1),e._FPDFAction_GetDest=i("FPDFAction_GetDest",2),e._FPDFAction_GetFilePath=i("FPDFAction_GetFilePath",3),e._FPDFAction_GetURIPath=i("FPDFAction_GetURIPath",4),e._FPDFDest_GetDestPageIndex=i("FPDFDest_GetDestPageIndex",2),e._FPDFDest_GetView=i("FPDFDest_GetView",3),e._FPDFDest_GetLocationInPage=i("FPDFDest_GetLocationInPage",7),e._FPDFLink_GetLinkAtPoint=i("FPDFLink_GetLinkAtPoint",3),e._FPDFLink_GetLinkZOrderAtPoint=i("FPDFLink_GetLinkZOrderAtPoint",3),e._FPDFLink_GetDest=i("FPDFLink_GetDest",2),e._FPDFLink_GetAction=i("FPDFLink_GetAction",1),e._FPDFLink_Enumerate=i("FPDFLink_Enumerate",3),e._FPDFLink_GetAnnot=i("FPDFLink_GetAnnot",2),e._FPDFLink_GetAnnotRect=i("FPDFLink_GetAnnotRect",2),e._FPDFLink_CountQuadPoints=i("FPDFLink_CountQuadPoints",1),e._FPDFLink_GetQuadPoints=i("FPDFLink_GetQuadPoints",3),e._FPDF_GetPageAAction=i("FPDF_GetPageAAction",2),e._FPDF_GetFileIdentifier=i("FPDF_GetFileIdentifier",4),e._FPDF_GetMetaText=i("FPDF_GetMetaText",4),e._FPDF_GetPageLabel=i("FPDF_GetPageLabel",4),e._EPDF_SetMetaText=i("EPDF_SetMetaText",3),e._EPDF_HasMetaText=i("EPDF_HasMetaText",2),e._EPDF_GetMetaTrapped=i("EPDF_GetMetaTrapped",1),e._EPDF_SetMetaTrapped=i("EPDF_SetMetaTrapped",2),e._EPDF_GetMetaKeyCount=i("EPDF_GetMetaKeyCount",2),e._EPDF_GetMetaKeyName=i("EPDF_GetMetaKeyName",5),e._FPDFPageObj_NewImageObj=i("FPDFPageObj_NewImageObj",1),e._FPDFImageObj_LoadJpegFile=i("FPDFImageObj_LoadJpegFile",4),e._FPDFImageObj_LoadJpegFileInline=i("FPDFImageObj_LoadJpegFileInline",4),e._FPDFImageObj_SetMatrix=i("FPDFImageObj_SetMatrix",7),e._FPDFImageObj_SetBitmap=i("FPDFImageObj_SetBitmap",4),e._FPDFImageObj_GetBitmap=i("FPDFImageObj_GetBitmap",1),e._FPDFImageObj_GetRenderedBitmap=i("FPDFImageObj_GetRenderedBitmap",3),e._FPDFImageObj_GetImageDataDecoded=i("FPDFImageObj_GetImageDataDecoded",3),e._FPDFImageObj_GetImageDataRaw=i("FPDFImageObj_GetImageDataRaw",3),e._FPDFImageObj_GetImageFilterCount=i("FPDFImageObj_GetImageFilterCount",1),e._FPDFImageObj_GetImageFilter=i("FPDFImageObj_GetImageFilter",4),e._FPDFImageObj_GetImageMetadata=i("FPDFImageObj_GetImageMetadata",3),e._FPDFImageObj_GetImagePixelSize=i("FPDFImageObj_GetImagePixelSize",3),e._FPDFImageObj_GetIccProfileDataDecoded=i("FPDFImageObj_GetIccProfileDataDecoded",5),e._FPDF_CreateNewDocument=i("FPDF_CreateNewDocument",0),e._FPDFPage_Delete=i("FPDFPage_Delete",2),e._FPDF_MovePages=i("FPDF_MovePages",4),e._FPDFPage_New=i("FPDFPage_New",4),e._FPDFPage_GetRotation=i("FPDFPage_GetRotation",1),e._FPDFPage_InsertObject=i("FPDFPage_InsertObject",2),e._FPDFPage_InsertObjectAtIndex=i("FPDFPage_InsertObjectAtIndex",3),e._FPDFPage_RemoveObject=i("FPDFPage_RemoveObject",2),e._FPDFPage_CountObjects=i("FPDFPage_CountObjects",1),e._FPDFPage_GetObject=i("FPDFPage_GetObject",2),e._FPDFPage_HasTransparency=i("FPDFPage_HasTransparency",1),e._FPDFPageObj_Destroy=i("FPDFPageObj_Destroy",1),e._FPDFPageObj_GetMarkedContentID=i("FPDFPageObj_GetMarkedContentID",1),e._FPDFPageObj_CountMarks=i("FPDFPageObj_CountMarks",1),e._FPDFPageObj_GetMark=i("FPDFPageObj_GetMark",2),e._FPDFPageObj_AddMark=i("FPDFPageObj_AddMark",2),e._FPDFPageObj_RemoveMark=i("FPDFPageObj_RemoveMark",2),e._FPDFPageObjMark_GetName=i("FPDFPageObjMark_GetName",4),e._FPDFPageObjMark_CountParams=i("FPDFPageObjMark_CountParams",1),e._FPDFPageObjMark_GetParamKey=i("FPDFPageObjMark_GetParamKey",5),e._FPDFPageObjMark_GetParamValueType=i("FPDFPageObjMark_GetParamValueType",2),e._FPDFPageObjMark_GetParamIntValue=i("FPDFPageObjMark_GetParamIntValue",3),e._FPDFPageObjMark_GetParamStringValue=i("FPDFPageObjMark_GetParamStringValue",5),e._FPDFPageObjMark_GetParamBlobValue=i("FPDFPageObjMark_GetParamBlobValue",5),e._FPDFPageObj_HasTransparency=i("FPDFPageObj_HasTransparency",1),e._FPDFPageObjMark_SetIntParam=i("FPDFPageObjMark_SetIntParam",5),e._FPDFPageObjMark_SetStringParam=i("FPDFPageObjMark_SetStringParam",5),e._FPDFPageObjMark_SetBlobParam=i("FPDFPageObjMark_SetBlobParam",6),e._FPDFPageObjMark_RemoveParam=i("FPDFPageObjMark_RemoveParam",3),e._FPDFPageObj_GetType=i("FPDFPageObj_GetType",1),e._FPDFPageObj_GetIsActive=i("FPDFPageObj_GetIsActive",2),e._FPDFPageObj_SetIsActive=i("FPDFPageObj_SetIsActive",2),e._FPDFPage_GenerateContent=i("FPDFPage_GenerateContent",1),e._FPDFPageObj_Transform=i("FPDFPageObj_Transform",7),e._FPDFPageObj_TransformF=i("FPDFPageObj_TransformF",2),e._FPDFPageObj_GetMatrix=i("FPDFPageObj_GetMatrix",2),e._FPDFPageObj_SetMatrix=i("FPDFPageObj_SetMatrix",2),e._FPDFPageObj_SetBlendMode=i("FPDFPageObj_SetBlendMode",2),e._FPDFPage_TransformAnnots=i("FPDFPage_TransformAnnots",7),e._FPDFPage_SetRotation=i("FPDFPage_SetRotation",2),e._FPDFPageObj_SetFillColor=i("FPDFPageObj_SetFillColor",5),e._FPDFPageObj_GetFillColor=i("FPDFPageObj_GetFillColor",5),e._FPDFPageObj_GetBounds=i("FPDFPageObj_GetBounds",5),e._FPDFPageObj_GetRotatedBounds=i("FPDFPageObj_GetRotatedBounds",2),e._FPDFPageObj_SetStrokeColor=i("FPDFPageObj_SetStrokeColor",5),e._FPDFPageObj_GetStrokeColor=i("FPDFPageObj_GetStrokeColor",5),e._FPDFPageObj_SetStrokeWidth=i("FPDFPageObj_SetStrokeWidth",2),e._FPDFPageObj_GetStrokeWidth=i("FPDFPageObj_GetStrokeWidth",2),e._FPDFPageObj_GetLineJoin=i("FPDFPageObj_GetLineJoin",1),e._FPDFPageObj_SetLineJoin=i("FPDFPageObj_SetLineJoin",2),e._FPDFPageObj_GetLineCap=i("FPDFPageObj_GetLineCap",1),e._FPDFPageObj_SetLineCap=i("FPDFPageObj_SetLineCap",2),e._FPDFPageObj_GetDashPhase=i("FPDFPageObj_GetDashPhase",2),e._FPDFPageObj_SetDashPhase=i("FPDFPageObj_SetDashPhase",2),e._FPDFPageObj_GetDashCount=i("FPDFPageObj_GetDashCount",1),e._FPDFPageObj_GetDashArray=i("FPDFPageObj_GetDashArray",3),e._FPDFPageObj_SetDashArray=i("FPDFPageObj_SetDashArray",4),e._FPDFFormObj_CountObjects=i("FPDFFormObj_CountObjects",1),e._FPDFFormObj_GetObject=i("FPDFFormObj_GetObject",2),e._FPDFFormObj_RemoveObject=i("FPDFFormObj_RemoveObject",2),e._FPDFPageObj_CreateNewPath=i("FPDFPageObj_CreateNewPath",2),e._FPDFPageObj_CreateNewRect=i("FPDFPageObj_CreateNewRect",4),e._FPDFPath_CountSegments=i("FPDFPath_CountSegments",1),e._FPDFPath_GetPathSegment=i("FPDFPath_GetPathSegment",2),e._FPDFPath_MoveTo=i("FPDFPath_MoveTo",3),e._FPDFPath_LineTo=i("FPDFPath_LineTo",3),e._FPDFPath_BezierTo=i("FPDFPath_BezierTo",7),e._FPDFPath_Close=i("FPDFPath_Close",1),e._FPDFPath_SetDrawMode=i("FPDFPath_SetDrawMode",3),e._FPDFPath_GetDrawMode=i("FPDFPath_GetDrawMode",3),e._FPDFPathSegment_GetPoint=i("FPDFPathSegment_GetPoint",3),e._FPDFPathSegment_GetType=i("FPDFPathSegment_GetType",1),e._FPDFPathSegment_GetClose=i("FPDFPathSegment_GetClose",1),e._FPDFPageObj_NewTextObj=i("FPDFPageObj_NewTextObj",3),e._FPDFText_SetText=i("FPDFText_SetText",2),e._FPDFText_SetCharcodes=i("FPDFText_SetCharcodes",3),e._FPDFText_LoadFont=i("FPDFText_LoadFont",5),e._FPDFText_LoadStandardFont=i("FPDFText_LoadStandardFont",2),e._FPDFText_LoadCidType2Font=i("FPDFText_LoadCidType2Font",6),e._FPDFTextObj_GetFontSize=i("FPDFTextObj_GetFontSize",2),e._FPDFTextObj_GetText=i("FPDFTextObj_GetText",4),e._FPDFTextObj_GetRenderedBitmap=i("FPDFTextObj_GetRenderedBitmap",4),e._FPDFFont_Close=i("FPDFFont_Close",1),e._FPDFPageObj_CreateTextObj=i("FPDFPageObj_CreateTextObj",3),e._FPDFTextObj_GetTextRenderMode=i("FPDFTextObj_GetTextRenderMode",1),e._FPDFTextObj_SetTextRenderMode=i("FPDFTextObj_SetTextRenderMode",2),e._FPDFTextObj_GetFont=i("FPDFTextObj_GetFont",1),e._FPDFFont_GetBaseFontName=i("FPDFFont_GetBaseFontName",3),e._FPDFFont_GetFamilyName=i("FPDFFont_GetFamilyName",3),e._FPDFFont_GetFontData=i("FPDFFont_GetFontData",4),e._FPDFFont_GetIsEmbedded=i("FPDFFont_GetIsEmbedded",1),e._FPDFFont_GetFlags=i("FPDFFont_GetFlags",1),e._FPDFFont_GetWeight=i("FPDFFont_GetWeight",1),e._FPDFFont_GetItalicAngle=i("FPDFFont_GetItalicAngle",2),e._FPDFFont_GetAscent=i("FPDFFont_GetAscent",3),e._FPDFFont_GetDescent=i("FPDFFont_GetDescent",3),e._FPDFFont_GetGlyphWidth=i("FPDFFont_GetGlyphWidth",4),e._FPDFFont_GetGlyphPath=i("FPDFFont_GetGlyphPath",3),e._FPDFGlyphPath_CountGlyphSegments=i("FPDFGlyphPath_CountGlyphSegments",1),e._FPDFGlyphPath_GetGlyphPathSegment=i("FPDFGlyphPath_GetGlyphPathSegment",2),e._EPDFText_RedactInRect=i("EPDFText_RedactInRect",4),e._EPDFText_RedactInQuads=i("EPDFText_RedactInQuads",5),e._FPDFDoc_GetPageMode=i("FPDFDoc_GetPageMode",1),e._FPDFPage_Flatten=i("FPDFPage_Flatten",2),e._FPDFPage_HasFormFieldAtPoint=i("FPDFPage_HasFormFieldAtPoint",4),e._FPDFPage_FormFieldZOrderAtPoint=i("FPDFPage_FormFieldZOrderAtPoint",4),e._malloc=i("malloc",1),e._free=i("free",1),e._FORM_OnMouseMove=i("FORM_OnMouseMove",5),e._FORM_OnMouseWheel=i("FORM_OnMouseWheel",6),e._FORM_OnFocus=i("FORM_OnFocus",5),e._FORM_OnLButtonDown=i("FORM_OnLButtonDown",5),e._FORM_OnLButtonUp=i("FORM_OnLButtonUp",5),e._FORM_OnLButtonDoubleClick=i("FORM_OnLButtonDoubleClick",5),e._FORM_OnRButtonDown=i("FORM_OnRButtonDown",5),e._FORM_OnRButtonUp=i("FORM_OnRButtonUp",5),e._FORM_OnKeyDown=i("FORM_OnKeyDown",4),e._FORM_OnKeyUp=i("FORM_OnKeyUp",4),e._FORM_OnChar=i("FORM_OnChar",4),e._FORM_GetFocusedText=i("FORM_GetFocusedText",4),e._FORM_GetSelectedText=i("FORM_GetSelectedText",4),e._FORM_ReplaceAndKeepSelection=i("FORM_ReplaceAndKeepSelection",3),e._FORM_ReplaceSelection=i("FORM_ReplaceSelection",3),e._FORM_SelectAllText=i("FORM_SelectAllText",2),e._FORM_CanUndo=i("FORM_CanUndo",2),e._FORM_CanRedo=i("FORM_CanRedo",2),e._FORM_Undo=i("FORM_Undo",2),e._FORM_Redo=i("FORM_Redo",2),e._FORM_ForceToKillFocus=i("FORM_ForceToKillFocus",1),e._FORM_GetFocusedAnnot=i("FORM_GetFocusedAnnot",3),e._FORM_SetFocusedAnnot=i("FORM_SetFocusedAnnot",2),e._FPDF_FFLDraw=i("FPDF_FFLDraw",9),e._FPDF_SetFormFieldHighlightColor=i("FPDF_SetFormFieldHighlightColor",3),e._FPDF_SetFormFieldHighlightAlpha=i("FPDF_SetFormFieldHighlightAlpha",2),e._FPDF_RemoveFormFieldHighlight=i("FPDF_RemoveFormFieldHighlight",1),e._FORM_OnAfterLoadPage=i("FORM_OnAfterLoadPage",2),e._FORM_OnBeforeClosePage=i("FORM_OnBeforeClosePage",2),e._FORM_DoDocumentJSAction=i("FORM_DoDocumentJSAction",1),e._FORM_DoDocumentOpenAction=i("FORM_DoDocumentOpenAction",1),e._FORM_DoDocumentAAction=i("FORM_DoDocumentAAction",2),e._FORM_DoPageAAction=i("FORM_DoPageAAction",3),e._FORM_SetIndexSelected=i("FORM_SetIndexSelected",4),e._FORM_IsIndexSelected=i("FORM_IsIndexSelected",3),e._FPDFDoc_GetJavaScriptActionCount=i("FPDFDoc_GetJavaScriptActionCount",1),e._FPDFDoc_GetJavaScriptAction=i("FPDFDoc_GetJavaScriptAction",2),e._FPDFDoc_CloseJavaScriptAction=i("FPDFDoc_CloseJavaScriptAction",1),e._FPDFJavaScriptAction_GetName=i("FPDFJavaScriptAction_GetName",3),e._FPDFJavaScriptAction_GetScript=i("FPDFJavaScriptAction_GetScript",3),e._FPDF_ImportPagesByIndex=i("FPDF_ImportPagesByIndex",5),e._FPDF_ImportPages=i("FPDF_ImportPages",4),e._FPDF_ImportNPagesToOne=i("FPDF_ImportNPagesToOne",5),e._FPDF_NewXObjectFromPage=i("FPDF_NewXObjectFromPage",3),e._FPDF_CloseXObject=i("FPDF_CloseXObject",1),e._FPDF_NewFormObjectFromXObject=i("FPDF_NewFormObjectFromXObject",1),e._FPDF_CopyViewerPreferences=i("FPDF_CopyViewerPreferences",2),e._FPDF_RenderPageBitmapWithColorScheme_Start=i("FPDF_RenderPageBitmapWithColorScheme_Start",10),e._FPDF_RenderPageBitmap_Start=i("FPDF_RenderPageBitmap_Start",9),e._FPDF_RenderPage_Continue=i("FPDF_RenderPage_Continue",2),e._FPDF_RenderPage_Close=i("FPDF_RenderPage_Close",1),e._FPDF_SaveWithVersion=i("FPDF_SaveWithVersion",4),e._FPDFText_GetCharIndexFromTextIndex=i("FPDFText_GetCharIndexFromTextIndex",2),e._FPDFText_GetTextIndexFromCharIndex=i("FPDFText_GetTextIndexFromCharIndex",2),e._FPDF_GetSignatureCount=i("FPDF_GetSignatureCount",1),e._FPDF_GetSignatureObject=i("FPDF_GetSignatureObject",2),e._FPDFSignatureObj_GetContents=i("FPDFSignatureObj_GetContents",3),e._FPDFSignatureObj_GetByteRange=i("FPDFSignatureObj_GetByteRange",3),e._FPDFSignatureObj_GetSubFilter=i("FPDFSignatureObj_GetSubFilter",3),e._FPDFSignatureObj_GetReason=i("FPDFSignatureObj_GetReason",3),e._FPDFSignatureObj_GetTime=i("FPDFSignatureObj_GetTime",3),e._FPDFSignatureObj_GetDocMDPPermission=i("FPDFSignatureObj_GetDocMDPPermission",1),e._FPDF_StructTree_GetForPage=i("FPDF_StructTree_GetForPage",1),e._FPDF_StructTree_Close=i("FPDF_StructTree_Close",1),e._FPDF_StructTree_CountChildren=i("FPDF_StructTree_CountChildren",1),e._FPDF_StructTree_GetChildAtIndex=i("FPDF_StructTree_GetChildAtIndex",2),e._FPDF_StructElement_GetAltText=i("FPDF_StructElement_GetAltText",3),e._FPDF_StructElement_GetActualText=i("FPDF_StructElement_GetActualText",3),e._FPDF_StructElement_GetID=i("FPDF_StructElement_GetID",3),e._FPDF_StructElement_GetLang=i("FPDF_StructElement_GetLang",3),e._FPDF_StructElement_GetAttributeCount=i("FPDF_StructElement_GetAttributeCount",1),e._FPDF_StructElement_GetAttributeAtIndex=i("FPDF_StructElement_GetAttributeAtIndex",2),e._FPDF_StructElement_GetStringAttribute=i("FPDF_StructElement_GetStringAttribute",4),e._FPDF_StructElement_GetMarkedContentID=i("FPDF_StructElement_GetMarkedContentID",1),e._FPDF_StructElement_GetType=i("FPDF_StructElement_GetType",3),e._FPDF_StructElement_GetObjType=i("FPDF_StructElement_GetObjType",3),e._FPDF_StructElement_GetTitle=i("FPDF_StructElement_GetTitle",3),e._FPDF_StructElement_CountChildren=i("FPDF_StructElement_CountChildren",1),e._FPDF_StructElement_GetChildAtIndex=i("FPDF_StructElement_GetChildAtIndex",2),e._FPDF_StructElement_GetChildMarkedContentID=i("FPDF_StructElement_GetChildMarkedContentID",2),e._FPDF_StructElement_GetParent=i("FPDF_StructElement_GetParent",1),e._FPDF_StructElement_Attr_GetCount=i("FPDF_StructElement_Attr_GetCount",1),e._FPDF_StructElement_Attr_GetName=i("FPDF_StructElement_Attr_GetName",5),e._FPDF_StructElement_Attr_GetValue=i("FPDF_StructElement_Attr_GetValue",2),e._FPDF_StructElement_Attr_GetType=i("FPDF_StructElement_Attr_GetType",1),e._FPDF_StructElement_Attr_GetBooleanValue=i("FPDF_StructElement_Attr_GetBooleanValue",2),e._FPDF_StructElement_Attr_GetNumberValue=i("FPDF_StructElement_Attr_GetNumberValue",2),e._FPDF_StructElement_Attr_GetStringValue=i("FPDF_StructElement_Attr_GetStringValue",4),e._FPDF_StructElement_Attr_GetBlobValue=i("FPDF_StructElement_Attr_GetBlobValue",4),e._FPDF_StructElement_Attr_CountChildren=i("FPDF_StructElement_Attr_CountChildren",1),e._FPDF_StructElement_Attr_GetChildAtIndex=i("FPDF_StructElement_Attr_GetChildAtIndex",2),e._FPDF_StructElement_GetMarkedContentIdCount=i("FPDF_StructElement_GetMarkedContentIdCount",1),e._FPDF_StructElement_GetMarkedContentIdAtIndex=i("FPDF_StructElement_GetMarkedContentIdAtIndex",2),e._FPDF_AddInstalledFont=i("FPDF_AddInstalledFont",3),e._FPDF_SetSystemFontInfo=i("FPDF_SetSystemFontInfo",1),e._FPDF_GetDefaultTTFMap=i("FPDF_GetDefaultTTFMap",0),e._FPDF_GetDefaultTTFMapCount=i("FPDF_GetDefaultTTFMapCount",0),e._FPDF_GetDefaultTTFMapEntry=i("FPDF_GetDefaultTTFMapEntry",1),e._FPDF_GetDefaultSystemFontInfo=i("FPDF_GetDefaultSystemFontInfo",0),e._FPDF_FreeDefaultSystemFontInfo=i("FPDF_FreeDefaultSystemFontInfo",1),e._FPDFText_LoadPage=i("FPDFText_LoadPage",1),e._FPDFText_ClosePage=i("FPDFText_ClosePage",1),e._FPDFText_CountChars=i("FPDFText_CountChars",1),e._FPDFText_GetUnicode=i("FPDFText_GetUnicode",2),e._FPDFText_GetTextObject=i("FPDFText_GetTextObject",2),e._FPDFText_IsGenerated=i("FPDFText_IsGenerated",2),e._FPDFText_IsHyphen=i("FPDFText_IsHyphen",2),e._FPDFText_HasUnicodeMapError=i("FPDFText_HasUnicodeMapError",2),e._FPDFText_GetFontSize=i("FPDFText_GetFontSize",2),e._FPDFText_GetFontInfo=i("FPDFText_GetFontInfo",5),e._FPDFText_GetFontWeight=i("FPDFText_GetFontWeight",2),e._FPDFText_GetFillColor=i("FPDFText_GetFillColor",6),e._FPDFText_GetStrokeColor=i("FPDFText_GetStrokeColor",6),e._FPDFText_GetCharAngle=i("FPDFText_GetCharAngle",2),e._FPDFText_GetCharBox=i("FPDFText_GetCharBox",6),e._FPDFText_GetLooseCharBox=i("FPDFText_GetLooseCharBox",3),e._FPDFText_GetMatrix=i("FPDFText_GetMatrix",3),e._FPDFText_GetCharOrigin=i("FPDFText_GetCharOrigin",4),e._FPDFText_GetCharIndexAtPos=i("FPDFText_GetCharIndexAtPos",5),e._FPDFText_GetText=i("FPDFText_GetText",4),e._FPDFText_CountRects=i("FPDFText_CountRects",3),e._FPDFText_GetRect=i("FPDFText_GetRect",6),e._FPDFText_GetBoundedText=i("FPDFText_GetBoundedText",7),e._FPDFText_FindStart=i("FPDFText_FindStart",4),e._FPDFText_FindNext=i("FPDFText_FindNext",1),e._FPDFText_FindPrev=i("FPDFText_FindPrev",1),e._FPDFText_GetSchResultIndex=i("FPDFText_GetSchResultIndex",1),e._FPDFText_GetSchCount=i("FPDFText_GetSchCount",1),e._FPDFText_FindClose=i("FPDFText_FindClose",1),e._FPDFLink_LoadWebLinks=i("FPDFLink_LoadWebLinks",1),e._FPDFLink_CountWebLinks=i("FPDFLink_CountWebLinks",1),e._FPDFLink_GetURL=i("FPDFLink_GetURL",4),e._FPDFLink_CountRects=i("FPDFLink_CountRects",2),e._FPDFLink_GetRect=i("FPDFLink_GetRect",7),e._FPDFLink_GetTextRange=i("FPDFLink_GetTextRange",4),e._FPDFLink_CloseWebLinks=i("FPDFLink_CloseWebLinks",1),e._FPDFPage_GetDecodedThumbnailData=i("FPDFPage_GetDecodedThumbnailData",3),e._FPDFPage_GetRawThumbnailData=i("FPDFPage_GetRawThumbnailData",3),e._FPDFPage_GetThumbnailAsBitmap=i("FPDFPage_GetThumbnailAsBitmap",1),e._FPDFPage_SetMediaBox=i("FPDFPage_SetMediaBox",5),e._FPDFPage_SetCropBox=i("FPDFPage_SetCropBox",5),e._FPDFPage_SetBleedBox=i("FPDFPage_SetBleedBox",5),e._FPDFPage_SetTrimBox=i("FPDFPage_SetTrimBox",5),e._FPDFPage_SetArtBox=i("FPDFPage_SetArtBox",5),e._FPDFPage_GetMediaBox=i("FPDFPage_GetMediaBox",5),e._FPDFPage_GetCropBox=i("FPDFPage_GetCropBox",5),e._FPDFPage_GetBleedBox=i("FPDFPage_GetBleedBox",5),e._FPDFPage_GetTrimBox=i("FPDFPage_GetTrimBox",5),e._FPDFPage_GetArtBox=i("FPDFPage_GetArtBox",5),e._FPDFPage_TransFormWithClip=i("FPDFPage_TransFormWithClip",3),e._FPDFPageObj_TransformClipPath=i("FPDFPageObj_TransformClipPath",7),e._FPDFPageObj_GetClipPath=i("FPDFPageObj_GetClipPath",1),e._FPDFClipPath_CountPaths=i("FPDFClipPath_CountPaths",1),e._FPDFClipPath_CountPathSegments=i("FPDFClipPath_CountPathSegments",2),e._FPDFClipPath_GetPathSegment=i("FPDFClipPath_GetPathSegment",3),e._FPDF_CreateClipPath=i("FPDF_CreateClipPath",4),e._FPDF_DestroyClipPath=i("FPDF_DestroyClipPath",1),e._FPDFPage_InsertClipPath=i("FPDFPage_InsertClipPath",2),e._FPDF_InitLibrary=i("FPDF_InitLibrary",0),e._FPDF_DestroyLibrary=i("FPDF_DestroyLibrary",0),e._FPDF_SetSandBoxPolicy=i("FPDF_SetSandBoxPolicy",2),e._FPDF_LoadDocument=i("FPDF_LoadDocument",2),e._FPDF_GetFormType=i("FPDF_GetFormType",1),e._FPDF_LoadXFA=i("FPDF_LoadXFA",1),e._FPDF_LoadMemDocument=i("FPDF_LoadMemDocument",3),e._FPDF_LoadMemDocument64=i("FPDF_LoadMemDocument64",3),e._FPDF_LoadCustomDocument=i("FPDF_LoadCustomDocument",2),e._FPDF_GetFileVersion=i("FPDF_GetFileVersion",2),e._FPDF_DocumentHasValidCrossReferenceTable=i("FPDF_DocumentHasValidCrossReferenceTable",1),e._FPDF_GetDocPermissions=i("FPDF_GetDocPermissions",1),e._FPDF_GetDocUserPermissions=i("FPDF_GetDocUserPermissions",1),e._FPDF_GetSecurityHandlerRevision=i("FPDF_GetSecurityHandlerRevision",1),e._EPDF_SetEncryption=i("EPDF_SetEncryption",4),e._EPDF_RemoveEncryption=i("EPDF_RemoveEncryption",1),e._EPDF_UnlockOwnerPermissions=i("EPDF_UnlockOwnerPermissions",2),e._EPDF_IsEncrypted=i("EPDF_IsEncrypted",1),e._EPDF_IsOwnerUnlocked=i("EPDF_IsOwnerUnlocked",1),e._FPDF_GetPageCount=i("FPDF_GetPageCount",1),e._FPDF_LoadPage=i("FPDF_LoadPage",2),e._FPDF_GetPageWidthF=i("FPDF_GetPageWidthF",1),e._FPDF_GetPageWidth=i("FPDF_GetPageWidth",1),e._FPDF_GetPageHeightF=i("FPDF_GetPageHeightF",1),e._FPDF_GetPageHeight=i("FPDF_GetPageHeight",1),e._FPDF_GetPageBoundingBox=i("FPDF_GetPageBoundingBox",2),e._FPDF_RenderPageBitmap=i("FPDF_RenderPageBitmap",8),e._FPDF_RenderPageBitmapWithMatrix=i("FPDF_RenderPageBitmapWithMatrix",5),e._EPDF_RenderAnnotBitmap=i("EPDF_RenderAnnotBitmap",6),e._FPDF_ClosePage=i("FPDF_ClosePage",1),e._FPDF_CloseDocument=i("FPDF_CloseDocument",1),e._FPDF_GetLastError=i("FPDF_GetLastError",0),e._FPDF_DeviceToPage=i("FPDF_DeviceToPage",10),e._FPDF_PageToDevice=i("FPDF_PageToDevice",10),e._FPDFBitmap_Create=i("FPDFBitmap_Create",3),e._FPDFBitmap_CreateEx=i("FPDFBitmap_CreateEx",5),e._FPDFBitmap_GetFormat=i("FPDFBitmap_GetFormat",1),e._FPDFBitmap_FillRect=i("FPDFBitmap_FillRect",6),e._FPDFBitmap_GetBuffer=i("FPDFBitmap_GetBuffer",1),e._FPDFBitmap_GetWidth=i("FPDFBitmap_GetWidth",1),e._FPDFBitmap_GetHeight=i("FPDFBitmap_GetHeight",1),e._FPDFBitmap_GetStride=i("FPDFBitmap_GetStride",1),e._FPDFBitmap_Destroy=i("FPDFBitmap_Destroy",1),e._FPDF_GetPageSizeByIndexF=i("FPDF_GetPageSizeByIndexF",3),e._EPDF_GetPageRotationByIndex=i("EPDF_GetPageRotationByIndex",2),e._FPDF_GetPageSizeByIndex=i("FPDF_GetPageSizeByIndex",4),e._FPDF_VIEWERREF_GetPrintScaling=i("FPDF_VIEWERREF_GetPrintScaling",1),e._FPDF_VIEWERREF_GetNumCopies=i("FPDF_VIEWERREF_GetNumCopies",1),e._FPDF_VIEWERREF_GetPrintPageRange=i("FPDF_VIEWERREF_GetPrintPageRange",1),e._FPDF_VIEWERREF_GetPrintPageRangeCount=i("FPDF_VIEWERREF_GetPrintPageRangeCount",1),e._FPDF_VIEWERREF_GetPrintPageRangeElement=i("FPDF_VIEWERREF_GetPrintPageRangeElement",2),e._FPDF_VIEWERREF_GetDuplex=i("FPDF_VIEWERREF_GetDuplex",1),e._FPDF_VIEWERREF_GetName=i("FPDF_VIEWERREF_GetName",4),e._FPDF_CountNamedDests=i("FPDF_CountNamedDests",1),e._FPDF_GetNamedDestByName=i("FPDF_GetNamedDestByName",2),e._FPDF_GetNamedDest=i("FPDF_GetNamedDest",4),e._FPDF_GetXFAPacketCount=i("FPDF_GetXFAPacketCount",1),e._FPDF_GetXFAPacketName=i("FPDF_GetXFAPacketName",4),e._FPDF_GetXFAPacketContent=i("FPDF_GetXFAPacketContent",5),e._FPDF_GetTrailerEnds=i("FPDF_GetTrailerEnds",3);var st,Wt,_n=i("fflush",1),cn=i("emscripten_builtin_memalign",2),Pn=i("strerror",1),Ce=i("setThrew",2),zt=()=>(zt=Fe.emscripten_stack_init)(),ft=()=>(ft=Fe.emscripten_stack_get_end)(),Ht=n=>(Ht=Fe._emscripten_stack_restore)(n),Kt=n=>(Kt=Fe._emscripten_stack_alloc)(n),Xt=()=>(Xt=Fe.emscripten_stack_get_current)();function gn(){var n;zt(),T(!(3&(n=ft()))),n==0&&(n+=4),K[n>>2]=34821223,K[n+4>>2]=2310721022,K[0]=1668509029}function Yt(){var n;function a(){st||(st=1,e.calledRun=1,pe||(T(!Ee),Ee=!0,Ae(),e.noFSInit||F.initialized||F.init(),F.ignorePermissions=!1,_t(dt),t(e),e.onRuntimeInitialized?.(),T(!e._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),(function(){Ae();var s=e.postRun;s&&(typeof s=="function"&&(s=[s]),s.forEach(ot)),_t(Ie)})()))}de>0||(gn(),!Wt&&(Wt=1,(n=e.preRun)&&(typeof n=="function"&&(n=[n]),n.forEach(rt)),_t(ze),de>0)||(e.setStatus?(e.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>e.setStatus(""),1),a()},1)):a(),Ae()))}if(e.dynCall_ji=i("dynCall_ji",2),e.dynCall_jij=i("dynCall_jij",4),e.dynCall_iiij=i("dynCall_iiij",5),e.dynCall_iij=i("dynCall_iij",4),e.dynCall_j=i("dynCall_j",1),e.dynCall_jji=i("dynCall_jji",4),e.dynCall_iji=i("dynCall_iji",4),e.dynCall_viijii=i("dynCall_viijii",7),e.dynCall_iiji=i("dynCall_iiji",5),e.dynCall_jiji=i("dynCall_jiji",5),e.dynCall_iiiiij=i("dynCall_iiiiij",7),e.dynCall_iiiiijj=i("dynCall_iiiiijj",9),e.dynCall_iiiiiijj=i("dynCall_iiiiiijj",10),e.dynCall_viji=i("dynCall_viji",5),e.wasmExports=Fe,e.ccall=Ut,e.cwrap=(n,a,s,l)=>(...c)=>Ut(n,a,s,c),e.addFunction=(n,a)=>{T(n!==void 0);var s=dn(n);if(s)return s;var l=(()=>{if(Dt.length)return Dt.pop();try{ke.grow(1)}catch(g){throw g instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":g}return ke.length-1})();try{bt(l,n)}catch(g){if(!(g instanceof TypeError))throw g;T(a!==void 0,"Missing signature argument to addFunction: "+n);var c=ln(n,a);bt(l,c)}return Ve.set(n,l),l},e.removeFunction=n=>{Ve.delete(ce(n)),bt(n,null),Dt.push(n)},e.setValue=function(n,a,s="i8"){switch(s.endsWith("*")&&(s="*"),s){case"i1":case"i8":V[n]=a;break;case"i16":X[n>>1]=a;break;case"i32":O[n>>2]=a;break;case"i64":z("to do setValue(i64) use WASM_BIGINT");case"float":ue[n>>2]=a;break;case"double":ge[n>>3]=a;break;case"*":K[n>>2]=a;break;default:z(`invalid type for setValue: ${s}`)}},e.getValue=function(n,a="i8"){switch(a.endsWith("*")&&(a="*"),a){case"i1":case"i8":return V[n];case"i16":return X[n>>1];case"i32":return O[n>>2];case"i64":z("to do getValue(i64) use WASM_BIGINT");case"float":return ue[n>>2];case"double":return ge[n>>3];case"*":return K[n>>2];default:z(`invalid type for getValue: ${a}`)}},e.UTF8ToString=Ne,e.stringToUTF8=$e,e.UTF16ToString=(n,a)=>{T(n%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");for(var s=n,l=s>>1,c=l+a/2;!(l>=c)&&oe[l];)++l;if((s=l<<1)-n>32&&Lt)return Lt.decode($.subarray(n,s));for(var g="",f=0;!(f>=a/2);++f){var A=X[n+2*f>>1];if(A==0)break;g+=String.fromCharCode(A)}return g},e.stringToUTF16=(n,a,s)=>{if(T(a%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!"),T(typeof s=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),s??=2147483647,s<2)return 0;for(var l=a,c=(s-=2)<2*n.length?s/2:n.length,g=0;g<c;++g){var f=n.charCodeAt(g);X[a>>1]=f,a+=2}return X[a>>1]=0,a-l},["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertU32PairToI53","getTempRet0","setTempRet0","exitJS","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","emscriptenLog","readEmAsmArgs","jstoi_q","listenOnce","autoResumeAudioContext","dynCallLegacy","getDynCaller","dynCall","handleException","keepRuntimeAlive","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","asmjsMangle","HandleAllocator","getNativeTypeSize","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","reallyNegative","unSign","strLen","reSign","formatString","intArrayToString","AsciiToString","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","stringToNewUTF8","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","jsStackTrace","getCallstack","convertPCtoSourceLocation","checkWasiClock","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","createDyncallWrapper","safeSetTimeout","setImmediateWrapped","clearImmediateWrapped","polyfillSetImmediate","registerPostMainLoop","registerPreMainLoop","getPromise","makePromise","idsToPromises","makePromiseCallback","ExceptionInfo","findMatchingCatch","Browser_asyncPrepareDataCounter","safeRequestAnimationFrame","arraySum","addDays","getSocketFromFD","getSocketAddress","FS_unlink","FS_mkdirTree","_setNetworkCallback","heapObjectForWebGLType","toTypedArrayIndex","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","webgl_enable_EXT_polygon_offset_clamp","webgl_enable_EXT_clip_control","webgl_enable_WEBGL_polygon_mode","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","runAndAbortIfError","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","setErrNo","demangle","stackTrace"].forEach(function(n){xt(n,()=>{var a=`\`${n}\` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line`,s=n;s.startsWith("_")||(s="$"+n),a+=` (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE='${s}')`,Tt(n)&&(a+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),Le(a)}),Ot(n)}),["run","addOnPreRun","addOnInit","addOnPreMain","addOnExit","addOnPostRun","addRunDependency","removeRunDependency","out","err","callMain","abort","wasmMemory","writeStackCookie","checkStackCookie","convertI32PairToI53Checked","stackSave","stackRestore","stackAlloc","ptrToString","zeroMemory","getHeapMax","growMemory","ENV","ERRNO_CODES","strError","DNS","Protocols","Sockets","initRandomFill","randomFill","timers","warnOnce","readEmAsmArgsArray","jstoi_s","getExecutableName","asyncLoad","alignMemory","mmapAlloc","wasmTable","noExitRuntime","getCFunc","uleb128Encode","sigToWasmTypes","generateFuncType","convertJsFunctionToWasm","freeTableIndexes","functionsInTableMap","getEmptyTableSlot","updateTableMap","getFunctionAddress","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","stringToUTF8Array","lengthBytesUTF8","intArrayFromString","stringToAscii","UTF16Decoder","stringToUTF8OnStack","writeArrayToMemory","JSEvents","specialHTMLTargets","findCanvasEventTarget","currentFullscreenStrategy","restoreOldWindowedStyle","UNWIND_CACHE","ExitStatus","getEnvStrings","doReadv","doWritev","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","Browser","getPreloadedImageData__data","wget","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","isLeapYear","ydayFromDate","SYSCALLS","preloadPlugins","FS_createPreloadedFile","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar_buffer","FS_stdin_getChar","FS_createPath","FS_createDevice","FS_readFile","FS","FS_createDataFile","FS_createLazyFile","MEMFS","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","AL","GLUT","EGL","GLEW","IDBStore","SDL","SDL_gfx","allocateUTF8","allocateUTF8OnStack","print","printErr"].forEach(Ot),xe=function n(){st||Yt(),st||(xe=n)},e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();Yt(),r=u;for(const n of Object.keys(e))n in H||Object.defineProperty(H,n,{configurable:!0,get(){z(`Access to module property ('${n}') is no longer possible via the module constructor argument; Instead, use the result of the module constructor.`)}});return r});const Et={EPDF_GetMetaKeyCount:[["number","boolean"],"number"],EPDF_GetMetaKeyName:[["number","number","boolean","number","number"],"number"],EPDF_GetMetaTrapped:[["number"],"number"],EPDF_GetPageRotationByIndex:[["number","number"],"number"],EPDF_HasMetaText:[["number","string"],"boolean"],EPDF_IsEncrypted:[["number"],"boolean"],EPDF_IsOwnerUnlocked:[["number"],"boolean"],EPDF_PNG_EncodeRGBA:[["number","number","number","number","number","number"],"number"],EPDF_RemoveEncryption:[["number"],"boolean"],EPDF_RenderAnnotBitmap:[["number","number","number","number","number","number"],"boolean"],EPDF_SetEncryption:[["number","string","string","number"],"boolean"],EPDF_SetMetaText:[["number","string","number"],"boolean"],EPDF_SetMetaTrapped:[["number","number"],"boolean"],EPDF_UnlockOwnerPermissions:[["number","string"],"boolean"],EPDFAction_CreateGoTo:[["number","number"],"number"],EPDFAction_CreateGoToNamed:[["number","string"],"number"],EPDFAction_CreateLaunch:[["number","number"],"number"],EPDFAction_CreateRemoteGoToByName:[["number","number","number"],"number"],EPDFAction_CreateRemoteGoToDest:[["number","number","number"],"number"],EPDFAction_CreateURI:[["number","string"],"number"],EPDFAnnot_ClearColor:[["number","number"],"boolean"],EPDFAnnot_GenerateAppearance:[["number"],"boolean"],EPDFAnnot_GenerateAppearanceWithBlend:[["number","number"],"boolean"],EPDFAnnot_GetBlendMode:[["number"],"number"],EPDFAnnot_GetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_GetBorderDashPatternCount:[["number"],"number"],EPDFAnnot_GetBorderEffect:[["number","number"],"boolean"],EPDFAnnot_GetBorderStyle:[["number","number"],"number"],EPDFAnnot_GetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_GetIcon:[["number"],"number"],EPDFAnnot_GetIntent:[["number","number","number"],"number"],EPDFAnnot_GetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_GetOpacity:[["number","number"],"boolean"],EPDFAnnot_GetRectangleDifferences:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetRichContent:[["number","number","number"],"number"],EPDFAnnot_GetTextAlignment:[["number"],"number"],EPDFAnnot_GetVerticalAlignment:[["number"],"number"],EPDFAnnot_SetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_SetBorderStyle:[["number","number","number"],"boolean"],EPDFAnnot_SetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_SetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_SetIcon:[["number","number"],"boolean"],EPDFAnnot_SetIntent:[["number","string"],"boolean"],EPDFAnnot_SetLine:[["number","number","number"],"boolean"],EPDFAnnot_SetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_SetLinkedAnnot:[["number","string","number"],"boolean"],EPDFAnnot_SetOpacity:[["number","number"],"boolean"],EPDFAnnot_SetTextAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVerticalAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVertices:[["number","number","number"],"boolean"],EPDFAnnot_UpdateAppearanceToRect:[["number","number"],"boolean"],EPDFAttachment_GetDescription:[["number","number","number"],"number"],EPDFAttachment_GetIntegerValue:[["number","string","number"],"boolean"],EPDFAttachment_SetDescription:[["number","number"],"boolean"],EPDFAttachment_SetSubtype:[["number","string"],"boolean"],EPDFBookmark_AppendChild:[["number","number","number"],"number"],EPDFBookmark_Clear:[["number"],"boolean"],EPDFBookmark_ClearTarget:[["number"],"boolean"],EPDFBookmark_Create:[["number","number"],"number"],EPDFBookmark_Delete:[["number","number"],"boolean"],EPDFBookmark_InsertAfter:[["number","number","number","number"],"number"],EPDFBookmark_SetAction:[["number","number","number"],"boolean"],EPDFBookmark_SetDest:[["number","number","number"],"boolean"],EPDFBookmark_SetTitle:[["number","number"],"boolean"],EPDFCatalog_GetLanguage:[["number","number","number"],"number"],EPDFDest_CreateRemoteView:[["number","number","number","number","number"],"number"],EPDFDest_CreateRemoteXYZ:[["number","number","boolean","number","boolean","number","boolean","number"],"number"],EPDFDest_CreateView:[["number","number","number","number"],"number"],EPDFDest_CreateXYZ:[["number","boolean","number","boolean","number","boolean","number"],"number"],EPDFNamedDest_Remove:[["number","string"],"boolean"],EPDFNamedDest_SetDest:[["number","string","number"],"boolean"],EPDFPage_CreateAnnot:[["number","number"],"number"],EPDFPage_GetAnnotByName:[["number","number"],"number"],EPDFPage_GetAnnotCountRaw:[["number","number"],"number"],EPDFPage_GetAnnotRaw:[["number","number","number"],"number"],EPDFPage_RemoveAnnotByName:[["number","number"],"boolean"],EPDFPage_RemoveAnnotRaw:[["number","number","number"],"boolean"],EPDFText_RedactInQuads:[["number","number","number","boolean","boolean"],"boolean"],EPDFText_RedactInRect:[["number","number","boolean","boolean"],"boolean"],FORM_CanRedo:[["number","number"],"boolean"],FORM_CanUndo:[["number","number"],"boolean"],FORM_DoDocumentAAction:[["number","number"],null],FORM_DoDocumentJSAction:[["number"],null],FORM_DoDocumentOpenAction:[["number"],null],FORM_DoPageAAction:[["number","number","number"],null],FORM_ForceToKillFocus:[["number"],"boolean"],FORM_GetFocusedAnnot:[["number","number","number"],"boolean"],FORM_GetFocusedText:[["number","number","number","number"],"number"],FORM_GetSelectedText:[["number","number","number","number"],"number"],FORM_IsIndexSelected:[["number","number","number"],"boolean"],FORM_OnAfterLoadPage:[["number","number"],null],FORM_OnBeforeClosePage:[["number","number"],null],FORM_OnChar:[["number","number","number","number"],"boolean"],FORM_OnFocus:[["number","number","number","number","number"],"boolean"],FORM_OnKeyDown:[["number","number","number","number"],"boolean"],FORM_OnKeyUp:[["number","number","number","number"],"boolean"],FORM_OnLButtonDoubleClick:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonUp:[["number","number","number","number","number"],"boolean"],FORM_OnMouseMove:[["number","number","number","number","number"],"boolean"],FORM_OnMouseWheel:[["number","number","number","number","number","number"],"boolean"],FORM_OnRButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnRButtonUp:[["number","number","number","number","number"],"boolean"],FORM_Redo:[["number","number"],"boolean"],FORM_ReplaceAndKeepSelection:[["number","number","number"],null],FORM_ReplaceSelection:[["number","number","number"],null],FORM_SelectAllText:[["number","number"],"boolean"],FORM_SetFocusedAnnot:[["number","number"],"boolean"],FORM_SetIndexSelected:[["number","number","number","boolean"],"boolean"],FORM_Undo:[["number","number"],"boolean"],FPDF_AddInstalledFont:[["number","number","number"],null],FPDF_CloseDocument:[["number"],null],FPDF_ClosePage:[["number"],null],FPDF_CloseXObject:[["number"],null],FPDF_CopyViewerPreferences:[["number","number"],"boolean"],FPDF_CountNamedDests:[["number"],"number"],FPDF_CreateClipPath:[["number","number","number","number"],"number"],FPDF_CreateNewDocument:[[],"number"],FPDF_DestroyClipPath:[["number"],null],FPDF_DestroyLibrary:[[],null],FPDF_DeviceToPage:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_DocumentHasValidCrossReferenceTable:[["number"],"boolean"],FPDF_FFLDraw:[["number","number","number","number","number","number","number","number","number"],null],FPDF_FreeDefaultSystemFontInfo:[["number"],null],FPDF_GetDefaultSystemFontInfo:[[],"number"],FPDF_GetDefaultTTFMap:[[],"number"],FPDF_GetDefaultTTFMapCount:[[],"number"],FPDF_GetDefaultTTFMapEntry:[["number"],"number"],FPDF_GetDocPermissions:[["number"],"number"],FPDF_GetDocUserPermissions:[["number"],"number"],FPDF_GetFileIdentifier:[["number","number","number","number"],"number"],FPDF_GetFileVersion:[["number","number"],"boolean"],FPDF_GetFormType:[["number"],"number"],FPDF_GetLastError:[[],"number"],FPDF_GetMetaText:[["number","string","number","number"],"number"],FPDF_GetNamedDest:[["number","number","number","number"],"number"],FPDF_GetNamedDestByName:[["number","string"],"number"],FPDF_GetPageAAction:[["number","number"],"number"],FPDF_GetPageBoundingBox:[["number","number"],"boolean"],FPDF_GetPageCount:[["number"],"number"],FPDF_GetPageHeight:[["number"],"number"],FPDF_GetPageHeightF:[["number"],"number"],FPDF_GetPageLabel:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndex:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndexF:[["number","number","number"],"boolean"],FPDF_GetPageWidth:[["number"],"number"],FPDF_GetPageWidthF:[["number"],"number"],FPDF_GetSecurityHandlerRevision:[["number"],"number"],FPDF_GetSignatureCount:[["number"],"number"],FPDF_GetSignatureObject:[["number","number"],"number"],FPDF_GetTrailerEnds:[["number","number","number"],"number"],FPDF_GetXFAPacketContent:[["number","number","number","number","number"],"boolean"],FPDF_GetXFAPacketCount:[["number"],"number"],FPDF_GetXFAPacketName:[["number","number","number","number"],"number"],FPDF_ImportNPagesToOne:[["number","number","number","number","number"],"number"],FPDF_ImportPages:[["number","number","string","number"],"boolean"],FPDF_ImportPagesByIndex:[["number","number","number","number","number"],"boolean"],FPDF_InitLibrary:[[],null],FPDF_InitLibraryWithConfig:[["number"],null],FPDF_LoadCustomDocument:[["number","string"],"number"],FPDF_LoadDocument:[["number","string"],"number"],FPDF_LoadMemDocument:[["number","number","string"],"number"],FPDF_LoadMemDocument64:[["number","number","string"],"number"],FPDF_LoadPage:[["number","number"],"number"],FPDF_LoadXFA:[["number"],"boolean"],FPDF_MovePages:[["number","number","number","number"],"boolean"],FPDF_NewFormObjectFromXObject:[["number"],"number"],FPDF_NewXObjectFromPage:[["number","number","number"],"number"],FPDF_PageToDevice:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_RemoveFormFieldHighlight:[["number"],null],FPDF_RenderPage_Close:[["number"],null],FPDF_RenderPage_Continue:[["number","number"],"number"],FPDF_RenderPageBitmap:[["number","number","number","number","number","number","number","number"],null],FPDF_RenderPageBitmap_Start:[["number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithColorScheme_Start:[["number","number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithMatrix:[["number","number","number","number","number"],null],FPDF_SaveAsCopy:[["number","number","number"],"boolean"],FPDF_SaveWithVersion:[["number","number","number","number"],"boolean"],FPDF_SetFormFieldHighlightAlpha:[["number","number"],null],FPDF_SetFormFieldHighlightColor:[["number","number","number"],null],FPDF_SetSandBoxPolicy:[["number","boolean"],null],FPDF_SetSystemFontInfo:[["number"],null],FPDF_StructElement_Attr_CountChildren:[["number"],"number"],FPDF_StructElement_Attr_GetBlobValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetBooleanValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_Attr_GetCount:[["number"],"number"],FPDF_StructElement_Attr_GetName:[["number","number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetNumberValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetStringValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetType:[["number"],"number"],FPDF_StructElement_Attr_GetValue:[["number","string"],"number"],FPDF_StructElement_CountChildren:[["number"],"number"],FPDF_StructElement_GetActualText:[["number","number","number"],"number"],FPDF_StructElement_GetAltText:[["number","number","number"],"number"],FPDF_StructElement_GetAttributeAtIndex:[["number","number"],"number"],FPDF_StructElement_GetAttributeCount:[["number"],"number"],FPDF_StructElement_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_GetChildMarkedContentID:[["number","number"],"number"],FPDF_StructElement_GetID:[["number","number","number"],"number"],FPDF_StructElement_GetLang:[["number","number","number"],"number"],FPDF_StructElement_GetMarkedContentID:[["number"],"number"],FPDF_StructElement_GetMarkedContentIdAtIndex:[["number","number"],"number"],FPDF_StructElement_GetMarkedContentIdCount:[["number"],"number"],FPDF_StructElement_GetObjType:[["number","number","number"],"number"],FPDF_StructElement_GetParent:[["number"],"number"],FPDF_StructElement_GetStringAttribute:[["number","string","number","number"],"number"],FPDF_StructElement_GetTitle:[["number","number","number"],"number"],FPDF_StructElement_GetType:[["number","number","number"],"number"],FPDF_StructTree_Close:[["number"],null],FPDF_StructTree_CountChildren:[["number"],"number"],FPDF_StructTree_GetChildAtIndex:[["number","number"],"number"],FPDF_StructTree_GetForPage:[["number"],"number"],FPDF_VIEWERREF_GetDuplex:[["number"],"number"],FPDF_VIEWERREF_GetName:[["number","string","number","number"],"number"],FPDF_VIEWERREF_GetNumCopies:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRange:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeCount:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeElement:[["number","number"],"number"],FPDF_VIEWERREF_GetPrintScaling:[["number"],"boolean"],FPDFAction_GetDest:[["number","number"],"number"],FPDFAction_GetFilePath:[["number","number","number"],"number"],FPDFAction_GetType:[["number"],"number"],FPDFAction_GetURIPath:[["number","number","number","number"],"number"],FPDFAnnot_AddFileAttachment:[["number","number"],"number"],FPDFAnnot_AddInkStroke:[["number","number","number"],"number"],FPDFAnnot_AppendAttachmentPoints:[["number","number"],"boolean"],FPDFAnnot_AppendObject:[["number","number"],"boolean"],FPDFAnnot_CountAttachmentPoints:[["number"],"number"],FPDFAnnot_GetAP:[["number","number","number","number"],"number"],FPDFAnnot_GetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_GetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_GetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_GetFileAttachment:[["number"],"number"],FPDFAnnot_GetFlags:[["number"],"number"],FPDFAnnot_GetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_GetFocusableSubtypesCount:[["number"],"number"],FPDFAnnot_GetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_GetFontSize:[["number","number","number"],"boolean"],FPDFAnnot_GetFormAdditionalActionJavaScript:[["number","number","number","number","number"],"number"],FPDFAnnot_GetFormControlCount:[["number","number"],"number"],FPDFAnnot_GetFormControlIndex:[["number","number"],"number"],FPDFAnnot_GetFormFieldAlternateName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldAtPoint:[["number","number","number"],"number"],FPDFAnnot_GetFormFieldExportValue:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldFlags:[["number","number"],"number"],FPDFAnnot_GetFormFieldName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldType:[["number","number"],"number"],FPDFAnnot_GetFormFieldValue:[["number","number","number","number"],"number"],FPDFAnnot_GetInkListCount:[["number"],"number"],FPDFAnnot_GetInkListPath:[["number","number","number","number"],"number"],FPDFAnnot_GetLine:[["number","number","number"],"boolean"],FPDFAnnot_GetLink:[["number"],"number"],FPDFAnnot_GetLinkedAnnot:[["number","string"],"number"],FPDFAnnot_GetNumberValue:[["number","string","number"],"boolean"],FPDFAnnot_GetObject:[["number","number"],"number"],FPDFAnnot_GetObjectCount:[["number"],"number"],FPDFAnnot_GetOptionCount:[["number","number"],"number"],FPDFAnnot_GetOptionLabel:[["number","number","number","number","number"],"number"],FPDFAnnot_GetRect:[["number","number"],"boolean"],FPDFAnnot_GetStringValue:[["number","string","number","number"],"number"],FPDFAnnot_GetSubtype:[["number"],"number"],FPDFAnnot_GetValueType:[["number","string"],"number"],FPDFAnnot_GetVertices:[["number","number","number"],"number"],FPDFAnnot_HasAttachmentPoints:[["number"],"boolean"],FPDFAnnot_HasKey:[["number","string"],"boolean"],FPDFAnnot_IsChecked:[["number","number"],"boolean"],FPDFAnnot_IsObjectSupportedSubtype:[["number"],"boolean"],FPDFAnnot_IsOptionSelected:[["number","number","number"],"boolean"],FPDFAnnot_IsSupportedSubtype:[["number"],"boolean"],FPDFAnnot_RemoveInkList:[["number"],"boolean"],FPDFAnnot_RemoveObject:[["number","number"],"boolean"],FPDFAnnot_SetAP:[["number","number","number"],"boolean"],FPDFAnnot_SetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_SetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_SetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_SetFlags:[["number","number"],"boolean"],FPDFAnnot_SetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_SetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_SetFormFieldFlags:[["number","number","number"],"boolean"],FPDFAnnot_SetRect:[["number","number"],"boolean"],FPDFAnnot_SetStringValue:[["number","string","number"],"boolean"],FPDFAnnot_SetURI:[["number","number"],"boolean"],FPDFAnnot_UpdateObject:[["number","number"],"boolean"],FPDFAttachment_GetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_GetName:[["number","number","number"],"number"],FPDFAttachment_GetStringValue:[["number","string","number","number"],"number"],FPDFAttachment_GetSubtype:[["number","number","number"],"number"],FPDFAttachment_GetValueType:[["number","string"],"number"],FPDFAttachment_HasKey:[["number","string"],"boolean"],FPDFAttachment_SetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_SetStringValue:[["number","string","number"],"boolean"],FPDFAvail_Create:[["number","number"],"number"],FPDFAvail_Destroy:[["number"],null],FPDFAvail_GetDocument:[["number","string"],"number"],FPDFAvail_GetFirstPageNum:[["number"],"number"],FPDFAvail_IsDocAvail:[["number","number"],"number"],FPDFAvail_IsFormAvail:[["number","number"],"number"],FPDFAvail_IsLinearized:[["number"],"number"],FPDFAvail_IsPageAvail:[["number","number","number"],"number"],FPDFBitmap_Create:[["number","number","number"],"number"],FPDFBitmap_CreateEx:[["number","number","number","number","number"],"number"],FPDFBitmap_Destroy:[["number"],null],FPDFBitmap_FillRect:[["number","number","number","number","number","number"],"boolean"],FPDFBitmap_GetBuffer:[["number"],"number"],FPDFBitmap_GetFormat:[["number"],"number"],FPDFBitmap_GetHeight:[["number"],"number"],FPDFBitmap_GetStride:[["number"],"number"],FPDFBitmap_GetWidth:[["number"],"number"],FPDFBookmark_Find:[["number","number"],"number"],FPDFBookmark_GetAction:[["number"],"number"],FPDFBookmark_GetCount:[["number"],"number"],FPDFBookmark_GetDest:[["number","number"],"number"],FPDFBookmark_GetFirstChild:[["number","number"],"number"],FPDFBookmark_GetNextSibling:[["number","number"],"number"],FPDFBookmark_GetTitle:[["number","number","number"],"number"],FPDFCatalog_IsTagged:[["number"],"boolean"],FPDFCatalog_SetLanguage:[["number","string"],"boolean"],FPDFClipPath_CountPaths:[["number"],"number"],FPDFClipPath_CountPathSegments:[["number","number"],"number"],FPDFClipPath_GetPathSegment:[["number","number","number"],"number"],FPDFDest_GetDestPageIndex:[["number","number"],"number"],FPDFDest_GetLocationInPage:[["number","number","number","number","number","number","number"],"boolean"],FPDFDest_GetView:[["number","number","number"],"number"],FPDFDoc_AddAttachment:[["number","number"],"number"],FPDFDoc_CloseJavaScriptAction:[["number"],null],FPDFDoc_DeleteAttachment:[["number","number"],"boolean"],FPDFDOC_ExitFormFillEnvironment:[["number"],null],FPDFDoc_GetAttachment:[["number","number"],"number"],FPDFDoc_GetAttachmentCount:[["number"],"number"],FPDFDoc_GetJavaScriptAction:[["number","number"],"number"],FPDFDoc_GetJavaScriptActionCount:[["number"],"number"],FPDFDoc_GetPageMode:[["number"],"number"],FPDFDOC_InitFormFillEnvironment:[["number","number"],"number"],FPDFFont_Close:[["number"],null],FPDFFont_GetAscent:[["number","number","number"],"boolean"],FPDFFont_GetBaseFontName:[["number","number","number"],"number"],FPDFFont_GetDescent:[["number","number","number"],"boolean"],FPDFFont_GetFamilyName:[["number","number","number"],"number"],FPDFFont_GetFlags:[["number"],"number"],FPDFFont_GetFontData:[["number","number","number","number"],"boolean"],FPDFFont_GetGlyphPath:[["number","number","number"],"number"],FPDFFont_GetGlyphWidth:[["number","number","number","number"],"boolean"],FPDFFont_GetIsEmbedded:[["number"],"number"],FPDFFont_GetItalicAngle:[["number","number"],"boolean"],FPDFFont_GetWeight:[["number"],"number"],FPDFFormObj_CountObjects:[["number"],"number"],FPDFFormObj_GetObject:[["number","number"],"number"],FPDFFormObj_RemoveObject:[["number","number"],"boolean"],FPDFGlyphPath_CountGlyphSegments:[["number"],"number"],FPDFGlyphPath_GetGlyphPathSegment:[["number","number"],"number"],FPDFImageObj_GetBitmap:[["number"],"number"],FPDFImageObj_GetIccProfileDataDecoded:[["number","number","number","number","number"],"boolean"],FPDFImageObj_GetImageDataDecoded:[["number","number","number"],"number"],FPDFImageObj_GetImageDataRaw:[["number","number","number"],"number"],FPDFImageObj_GetImageFilter:[["number","number","number","number"],"number"],FPDFImageObj_GetImageFilterCount:[["number"],"number"],FPDFImageObj_GetImageMetadata:[["number","number","number"],"boolean"],FPDFImageObj_GetImagePixelSize:[["number","number","number"],"boolean"],FPDFImageObj_GetRenderedBitmap:[["number","number","number"],"number"],FPDFImageObj_LoadJpegFile:[["number","number","number","number"],"boolean"],FPDFImageObj_LoadJpegFileInline:[["number","number","number","number"],"boolean"],FPDFImageObj_SetBitmap:[["number","number","number","number"],"boolean"],FPDFImageObj_SetMatrix:[["number","number","number","number","number","number","number"],"boolean"],FPDFJavaScriptAction_GetName:[["number","number","number"],"number"],FPDFJavaScriptAction_GetScript:[["number","number","number"],"number"],FPDFLink_CloseWebLinks:[["number"],null],FPDFLink_CountQuadPoints:[["number"],"number"],FPDFLink_CountRects:[["number","number"],"number"],FPDFLink_CountWebLinks:[["number"],"number"],FPDFLink_Enumerate:[["number","number","number"],"boolean"],FPDFLink_GetAction:[["number"],"number"],FPDFLink_GetAnnot:[["number","number"],"number"],FPDFLink_GetAnnotRect:[["number","number"],"boolean"],FPDFLink_GetDest:[["number","number"],"number"],FPDFLink_GetLinkAtPoint:[["number","number","number"],"number"],FPDFLink_GetLinkZOrderAtPoint:[["number","number","number"],"number"],FPDFLink_GetQuadPoints:[["number","number","number"],"boolean"],FPDFLink_GetRect:[["number","number","number","number","number","number","number"],"boolean"],FPDFLink_GetTextRange:[["number","number","number","number"],"boolean"],FPDFLink_GetURL:[["number","number","number","number"],"number"],FPDFLink_LoadWebLinks:[["number"],"number"],FPDFPage_CloseAnnot:[["number"],null],FPDFPage_CountObjects:[["number"],"number"],FPDFPage_CreateAnnot:[["number","number"],"number"],FPDFPage_Delete:[["number","number"],null],FPDFPage_Flatten:[["number","number"],"number"],FPDFPage_FormFieldZOrderAtPoint:[["number","number","number","number"],"number"],FPDFPage_GenerateContent:[["number"],"boolean"],FPDFPage_GetAnnot:[["number","number"],"number"],FPDFPage_GetAnnotCount:[["number"],"number"],FPDFPage_GetAnnotIndex:[["number","number"],"number"],FPDFPage_GetArtBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetBleedBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetCropBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetDecodedThumbnailData:[["number","number","number"],"number"],FPDFPage_GetMediaBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetObject:[["number","number"],"number"],FPDFPage_GetRawThumbnailData:[["number","number","number"],"number"],FPDFPage_GetRotation:[["number"],"number"],FPDFPage_GetThumbnailAsBitmap:[["number"],"number"],FPDFPage_GetTrimBox:[["number","number","number","number","number"],"boolean"],FPDFPage_HasFormFieldAtPoint:[["number","number","number","number"],"number"],FPDFPage_HasTransparency:[["number"],"boolean"],FPDFPage_InsertClipPath:[["number","number"],null],FPDFPage_InsertObject:[["number","number"],null],FPDFPage_InsertObjectAtIndex:[["number","number","number"],"boolean"],FPDFPage_New:[["number","number","number","number"],"number"],FPDFPage_RemoveAnnot:[["number","number"],"boolean"],FPDFPage_RemoveObject:[["number","number"],"boolean"],FPDFPage_SetArtBox:[["number","number","number","number","number"],null],FPDFPage_SetBleedBox:[["number","number","number","number","number"],null],FPDFPage_SetCropBox:[["number","number","number","number","number"],null],FPDFPage_SetMediaBox:[["number","number","number","number","number"],null],FPDFPage_SetRotation:[["number","number"],null],FPDFPage_SetTrimBox:[["number","number","number","number","number"],null],FPDFPage_TransformAnnots:[["number","number","number","number","number","number","number"],null],FPDFPage_TransFormWithClip:[["number","number","number"],"boolean"],FPDFPageObj_AddMark:[["number","string"],"number"],FPDFPageObj_CountMarks:[["number"],"number"],FPDFPageObj_CreateNewPath:[["number","number"],"number"],FPDFPageObj_CreateNewRect:[["number","number","number","number"],"number"],FPDFPageObj_CreateTextObj:[["number","number","number"],"number"],FPDFPageObj_Destroy:[["number"],null],FPDFPageObj_GetBounds:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetClipPath:[["number"],"number"],FPDFPageObj_GetDashArray:[["number","number","number"],"boolean"],FPDFPageObj_GetDashCount:[["number"],"number"],FPDFPageObj_GetDashPhase:[["number","number"],"boolean"],FPDFPageObj_GetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetIsActive:[["number","number"],"boolean"],FPDFPageObj_GetLineCap:[["number"],"number"],FPDFPageObj_GetLineJoin:[["number"],"number"],FPDFPageObj_GetMark:[["number","number"],"number"],FPDFPageObj_GetMarkedContentID:[["number"],"number"],FPDFPageObj_GetMatrix:[["number","number"],"boolean"],FPDFPageObj_GetRotatedBounds:[["number","number"],"boolean"],FPDFPageObj_GetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_GetType:[["number"],"number"],FPDFPageObj_HasTransparency:[["number"],"boolean"],FPDFPageObj_NewImageObj:[["number"],"number"],FPDFPageObj_NewTextObj:[["number","string","number"],"number"],FPDFPageObj_RemoveMark:[["number","number"],"boolean"],FPDFPageObj_SetBlendMode:[["number","string"],null],FPDFPageObj_SetDashArray:[["number","number","number","number"],"boolean"],FPDFPageObj_SetDashPhase:[["number","number"],"boolean"],FPDFPageObj_SetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetIsActive:[["number","boolean"],"boolean"],FPDFPageObj_SetLineCap:[["number","number"],"boolean"],FPDFPageObj_SetLineJoin:[["number","number"],"boolean"],FPDFPageObj_SetMatrix:[["number","number"],"boolean"],FPDFPageObj_SetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_Transform:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformClipPath:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformF:[["number","number"],"boolean"],FPDFPageObjMark_CountParams:[["number"],"number"],FPDFPageObjMark_GetName:[["number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamBlobValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamIntValue:[["number","string","number"],"boolean"],FPDFPageObjMark_GetParamKey:[["number","number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamStringValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamValueType:[["number","string"],"number"],FPDFPageObjMark_RemoveParam:[["number","number","string"],"boolean"],FPDFPageObjMark_SetBlobParam:[["number","number","number","string","number","number"],"boolean"],FPDFPageObjMark_SetIntParam:[["number","number","number","string","number"],"boolean"],FPDFPageObjMark_SetStringParam:[["number","number","number","string","string"],"boolean"],FPDFPath_BezierTo:[["number","number","number","number","number","number","number"],"boolean"],FPDFPath_Close:[["number"],"boolean"],FPDFPath_CountSegments:[["number"],"number"],FPDFPath_GetDrawMode:[["number","number","number"],"boolean"],FPDFPath_GetPathSegment:[["number","number"],"number"],FPDFPath_LineTo:[["number","number","number"],"boolean"],FPDFPath_MoveTo:[["number","number","number"],"boolean"],FPDFPath_SetDrawMode:[["number","number","boolean"],"boolean"],FPDFPathSegment_GetClose:[["number"],"boolean"],FPDFPathSegment_GetPoint:[["number","number","number"],"boolean"],FPDFPathSegment_GetType:[["number"],"number"],FPDFSignatureObj_GetByteRange:[["number","number","number"],"number"],FPDFSignatureObj_GetContents:[["number","number","number"],"number"],FPDFSignatureObj_GetDocMDPPermission:[["number"],"number"],FPDFSignatureObj_GetReason:[["number","number","number"],"number"],FPDFSignatureObj_GetSubFilter:[["number","number","number"],"number"],FPDFSignatureObj_GetTime:[["number","number","number"],"number"],FPDFText_ClosePage:[["number"],null],FPDFText_CountChars:[["number"],"number"],FPDFText_CountRects:[["number","number","number"],"number"],FPDFText_FindClose:[["number"],null],FPDFText_FindNext:[["number"],"boolean"],FPDFText_FindPrev:[["number"],"boolean"],FPDFText_FindStart:[["number","number","number","number"],"number"],FPDFText_GetBoundedText:[["number","number","number","number","number","number","number"],"number"],FPDFText_GetCharAngle:[["number","number"],"number"],FPDFText_GetCharBox:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetCharIndexAtPos:[["number","number","number","number","number"],"number"],FPDFText_GetCharIndexFromTextIndex:[["number","number"],"number"],FPDFText_GetCharOrigin:[["number","number","number","number"],"boolean"],FPDFText_GetFillColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetFontInfo:[["number","number","number","number","number"],"number"],FPDFText_GetFontSize:[["number","number"],"number"],FPDFText_GetFontWeight:[["number","number"],"number"],FPDFText_GetLooseCharBox:[["number","number","number"],"boolean"],FPDFText_GetMatrix:[["number","number","number"],"boolean"],FPDFText_GetRect:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetSchCount:[["number"],"number"],FPDFText_GetSchResultIndex:[["number"],"number"],FPDFText_GetStrokeColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetText:[["number","number","number","number"],"number"],FPDFText_GetTextIndexFromCharIndex:[["number","number"],"number"],FPDFText_GetTextObject:[["number","number"],"number"],FPDFText_GetUnicode:[["number","number"],"number"],FPDFText_HasUnicodeMapError:[["number","number"],"number"],FPDFText_IsGenerated:[["number","number"],"number"],FPDFText_IsHyphen:[["number","number"],"number"],FPDFText_LoadCidType2Font:[["number","number","number","string","number","number"],"number"],FPDFText_LoadFont:[["number","number","number","number","boolean"],"number"],FPDFText_LoadPage:[["number"],"number"],FPDFText_LoadStandardFont:[["number","string"],"number"],FPDFText_SetCharcodes:[["number","number","number"],"boolean"],FPDFText_SetText:[["number","number"],"boolean"],FPDFTextObj_GetFont:[["number"],"number"],FPDFTextObj_GetFontSize:[["number","number"],"boolean"],FPDFTextObj_GetRenderedBitmap:[["number","number","number","number"],"number"],FPDFTextObj_GetText:[["number","number","number","number"],"number"],FPDFTextObj_GetTextRenderMode:[["number"],"number"],FPDFTextObj_SetTextRenderMode:[["number","number"],"boolean"],PDFiumExt_CloseFileWriter:[["number"],null],PDFiumExt_CloseFormFillInfo:[["number"],null],PDFiumExt_ExitFormFillEnvironment:[["number"],null],PDFiumExt_GetFileWriterData:[["number","number","number"],"number"],PDFiumExt_GetFileWriterSize:[["number"],"number"],PDFiumExt_Init:[[],null],PDFiumExt_InitFormFillEnvironment:[["number","number"],"number"],PDFiumExt_OpenFileWriter:[[],"number"],PDFiumExt_OpenFormFillInfo:[[],"number"],PDFiumExt_SaveAsCopy:[["number","number"],"number"]};async function vn(H){return(async function(r){const t={pdfium:r};for(const o in Et){const e=o,u=Et[e][0],m=Et[e][1];t[e]=r.cwrap(o,m,u)}return t})(await xn(H))}function se(H,r,t,o=100){let e=H.wasmExports.malloc(o);for(let d=0;d<o;d++)H.HEAP8[e+d]=0;const u=r(e,o);let m;if(u>o){H.wasmExports.free(e),e=H.wasmExports.malloc(u);for(let d=0;d<u;d++)H.HEAP8[e+d]=0;r(e,u),m=t(e)}else m=t(e);return H.wasmExports.free(e),m}function Mt(H,r){const t=r(0,0),o=H.wasmExports.malloc(t);r(o,t);const e=new ArrayBuffer(t),u=new DataView(e);for(let m=0;m<t;m++)u.setInt8(m,H.getValue(o+m,"i8"));return H.wasmExports.free(o),e}const On=new Set(["Title","Author","Subject","Keywords","Producer","Creator","CreationDate","ModDate","Trapped"]);function kn(H){if(!H||H.length>127||On.has(H)||H[0]==="/")return!1;for(let r=0;r<H.length;r++){const t=H.charCodeAt(r);if(t<32||t>126)return!1}return!0}const wn={pageTtl:5e3,maxPagesPerDocument:10};class Rn{constructor(r,t,o={}){this.pdfium=r,this.memoryManager=t,this.docs=new Map,this.config={...wn,...o}}setDocument(r,t,o){let e=this.docs.get(r);e||(e=new In(t,o,this.pdfium,this.memoryManager,this.config),this.docs.set(r,e))}getContext(r){return this.docs.get(r)}closeDocument(r){const t=this.docs.get(r);return!!t&&(t.dispose(),this.docs.delete(r),!0)}closeAllDocuments(){for(const r of this.docs.values())r.dispose();this.docs.clear()}updateConfig(r){Object.assign(this.config,r);for(const t of this.docs.values())t.updateConfig(this.config)}getCacheStats(){const r={};let t=0;for(const[o,e]of this.docs.entries()){const u=e.getCacheSize();r[o]=u,t+=u}return{documents:this.docs.size,totalPages:t,pagesByDocument:r}}}class In{constructor(r,t,o,e,u){this.filePtr=r,this.docPtr=t,this.memoryManager=e,this.pageCache=new jn(o,t,u)}acquirePage(r){return this.pageCache.acquire(r)}borrowPage(r,t){return this.pageCache.borrowPage(r,t)}updateConfig(r){this.pageCache.updateConfig(r)}getCacheSize(){return this.pageCache.size()}dispose(){this.pageCache.forceReleaseAll(),this.pageCache.pdf.FPDF_CloseDocument(this.docPtr),this.memoryManager.free(this.filePtr)}}class jn{constructor(r,t,o){this.pdf=r,this.docPtr=t,this.cache=new Map,this.accessOrder=[],this.config=o}acquire(r){let t=this.cache.get(r);if(!t){this.evictIfNeeded();const o=this.pdf.FPDF_LoadPage(this.docPtr,r);t=new Bn(this.pdf,this.docPtr,r,o,this.config.pageTtl,()=>{this.cache.delete(r),this.removeFromAccessOrder(r)}),this.cache.set(r,t)}return this.updateAccessOrder(r),t.clearExpiryTimer(),t.bumpRefCount(),t}borrowPage(r,t){const o=this.cache.has(r),e=this.acquire(r);try{return t(e)}finally{o?e.release():e.disposeImmediate()}}forceReleaseAll(){for(const r of this.cache.values())r.disposeImmediate();this.cache.clear(),this.accessOrder.length=0}updateConfig(r){this.config=r;for(const t of this.cache.values())t.updateTtl(r.pageTtl);this.evictIfNeeded()}size(){return this.cache.size}evictIfNeeded(){for(;this.cache.size>=this.config.maxPagesPerDocument;){const r=this.accessOrder[0];if(r===void 0)break;{const t=this.cache.get(r);if(t){if(t.getRefCount()!==0)break;t.disposeImmediate()}else this.removeFromAccessOrder(r)}}}updateAccessOrder(r){this.removeFromAccessOrder(r),this.accessOrder.push(r)}removeFromAccessOrder(r){const t=this.accessOrder.indexOf(r);t>-1&&this.accessOrder.splice(t,1)}}class Bn{constructor(r,t,o,e,u,m){this.pdf=r,this.docPtr=t,this.pageIdx=o,this.pagePtr=e,this.onFinalDispose=m,this.refCount=0,this.disposed=!1,this.ttl=u}bumpRefCount(){if(this.disposed)throw new Error("Context already disposed");this.refCount++}getRefCount(){return this.refCount}clearExpiryTimer(){this.expiryTimer&&(clearTimeout(this.expiryTimer),this.expiryTimer=void 0)}updateTtl(r){this.ttl=r,this.expiryTimer&&this.refCount===0&&(this.clearExpiryTimer(),this.expiryTimer=setTimeout(()=>this.disposeImmediate(),this.ttl))}release(){this.disposed||(this.refCount--,this.refCount===0&&(this.expiryTimer=setTimeout(()=>this.disposeImmediate(),this.ttl)))}disposeImmediate(){this.disposed||(this.disposed=!0,this.clearExpiryTimer(),this.textPagePtr!==void 0&&this.pdf.FPDFText_ClosePage(this.textPagePtr),this.formHandle!==void 0&&(this.pdf.FORM_OnBeforeClosePage(this.pagePtr,this.formHandle),this.pdf.PDFiumExt_ExitFormFillEnvironment(this.formHandle)),this.formInfoPtr!==void 0&&this.pdf.PDFiumExt_CloseFormFillInfo(this.formInfoPtr),this.pdf.FPDF_ClosePage(this.pagePtr),this.onFinalDispose())}getTextPage(){return this.ensureAlive(),this.textPagePtr===void 0&&(this.textPagePtr=this.pdf.FPDFText_LoadPage(this.pagePtr)),this.textPagePtr}getFormHandle(){return this.ensureAlive(),this.formHandle===void 0&&(this.formInfoPtr=this.pdf.PDFiumExt_OpenFormFillInfo(),this.formHandle=this.pdf.PDFiumExt_InitFormFillEnvironment(this.docPtr,this.formInfoPtr),this.pdf.FORM_OnAfterLoadPage(this.pagePtr,this.formHandle)),this.formHandle}withAnnotation(r,t){this.ensureAlive();const o=this.pdf.FPDFPage_GetAnnot(this.pagePtr,r);try{return t(o)}finally{this.pdf.FPDFPage_CloseAnnot(o)}}ensureAlive(){if(this.disposed)throw new Error("PageContext already disposed")}}const rn={MAX_TOTAL_MEMORY:2147483648},yt="PDFiumEngine",Gt="MemoryManager";class Ln{constructor(r,t){this.pdfiumModule=r,this.logger=t,this.allocations=new Map,this.totalAllocated=0}malloc(r){if(this.totalAllocated+r>rn.MAX_TOTAL_MEMORY)throw new Error(`Total memory usage would exceed limit: ${this.totalAllocated+r} > ${rn.MAX_TOTAL_MEMORY}`);const t=this.pdfiumModule.pdfium.wasmExports.malloc(r);if(!t)throw new Error(`Failed to allocate ${r} bytes`);const o={ptr:t,size:r,timestamp:Date.now(),stack:this.logger.isEnabled("debug")?new Error().stack:void 0};return this.allocations.set(t,o),this.totalAllocated+=r,t}free(r){const t=this.allocations.get(r);t?(this.totalAllocated-=t.size,this.allocations.delete(r)):this.logger.warn(yt,Gt,`Freeing untracked pointer: ${r}`),this.pdfiumModule.pdfium.wasmExports.free(r)}getStats(){return{totalAllocated:this.totalAllocated,allocationCount:this.allocations.size,allocations:this.logger.isEnabled("debug")?Array.from(this.allocations.values()):[]}}checkLeaks(){if(this.allocations.size>0){this.logger.warn(yt,Gt,`Potential memory leak: ${this.allocations.size} unfreed allocations`);for(const[r,t]of this.allocations)this.logger.warn(yt,Gt,`  - ${r}: ${t.size} bytes`,t.stack)}}}const ne="pdfium",re="font-fallback";class Nn{constructor(r,t=new on){this.fontHandles=new Map,this.fontCache=new Map,this.nextHandleId=1,this.module=null,this.enabled=!1,this.structPtr=0,this.releaseFnPtr=0,this.enumFontsFnPtr=0,this.mapFontFnPtr=0,this.getFontFnPtr=0,this.getFontDataFnPtr=0,this.getFaceNameFnPtr=0,this.getFontCharsetFnPtr=0,this.deleteFontFnPtr=0,this.fontConfig=r,this.logger=t}initialize(r){if(this.enabled)return void this.logger.warn(ne,re,"Font fallback already initialized");this.module=r;const t=r.pdfium;if(typeof t.addFunction=="function")try{if(this.structPtr=t.wasmExports.malloc(36),!this.structPtr)throw new Error("Failed to allocate FPDF_SYSFONTINFO struct");for(let o=0;o<36;o++)t.setValue(this.structPtr+o,0,"i8");this.releaseFnPtr=t.addFunction(o=>{},"vi"),this.enumFontsFnPtr=t.addFunction((o,e)=>{},"vii"),this.mapFontFnPtr=t.addFunction((o,e,u,m,d,_,P)=>{const b=_?t.UTF8ToString(_):"",p=this.mapFont(e,u,m,d,b);return P&&t.setValue(P,0,"i32"),p},"iiiiiiii"),this.getFontFnPtr=t.addFunction((o,e)=>{const u=e?t.UTF8ToString(e):"";return this.mapFont(400,0,0,0,u)},"iii"),this.getFontDataFnPtr=t.addFunction((o,e,u,m,d)=>this.getFontData(e,u,m,d),"iiiiii"),this.getFaceNameFnPtr=t.addFunction((o,e,u,m)=>0,"iiiii"),this.getFontCharsetFnPtr=t.addFunction((o,e)=>{const u=this.fontHandles.get(e);return u?.charset??0},"iii"),this.deleteFontFnPtr=t.addFunction((o,e)=>{this.deleteFont(e)},"vii"),t.setValue(this.structPtr+0,1,"i32"),t.setValue(this.structPtr+4,this.releaseFnPtr,"i32"),t.setValue(this.structPtr+8,this.enumFontsFnPtr,"i32"),t.setValue(this.structPtr+12,this.mapFontFnPtr,"i32"),t.setValue(this.structPtr+16,this.getFontFnPtr,"i32"),t.setValue(this.structPtr+20,this.getFontDataFnPtr,"i32"),t.setValue(this.structPtr+24,this.getFaceNameFnPtr,"i32"),t.setValue(this.structPtr+28,this.getFontCharsetFnPtr,"i32"),t.setValue(this.structPtr+32,this.deleteFontFnPtr,"i32"),r.FPDF_SetSystemFontInfo(this.structPtr),this.enabled=!0,this.logger.info(ne,re,"Font fallback system initialized (pure TypeScript)",Object.keys(this.fontConfig.fonts))}catch(o){throw this.logger.error(ne,re,"Failed to initialize font fallback",o),this.cleanup(),o}else this.logger.error(ne,re,"addFunction not available. Make sure WASM is compiled with -sALLOW_TABLE_GROWTH")}disable(){this.enabled&&this.module&&(this.module.FPDF_SetSystemFontInfo(0),this.cleanup(),this.enabled=!1,this.logger.debug(ne,re,"Font fallback system disabled"))}cleanup(){if(!this.module)return;const r=this.module.pdfium;this.structPtr&&(r.wasmExports.free(this.structPtr),this.structPtr=0);const t=o=>{if(o&&typeof r.removeFunction=="function")try{r.removeFunction(o)}catch{}};t(this.releaseFnPtr),t(this.enumFontsFnPtr),t(this.mapFontFnPtr),t(this.getFontFnPtr),t(this.getFontDataFnPtr),t(this.getFaceNameFnPtr),t(this.getFontCharsetFnPtr),t(this.deleteFontFnPtr),this.releaseFnPtr=0,this.enumFontsFnPtr=0,this.mapFontFnPtr=0,this.getFontFnPtr=0,this.getFontDataFnPtr=0,this.getFaceNameFnPtr=0,this.getFontCharsetFnPtr=0,this.deleteFontFnPtr=0}isEnabled(){return this.enabled}getStats(){return{handleCount:this.fontHandles.size,cacheSize:this.fontCache.size,cachedUrls:Array.from(this.fontCache.keys())}}async preloadFonts(r){const t=r.map(e=>this.getFontUrlForCharset(e)).filter(e=>e!==null),o=[...new Set(t)];await Promise.all(o.map(async e=>{if(!this.fontCache.has(e))try{const u=await this.fetchFontAsync(e);u&&(this.fontCache.set(e,u),this.logger.debug(ne,re,`Pre-loaded font: ${e}`))}catch(u){this.logger.warn(ne,re,`Failed to pre-load font: ${e}`,u)}}))}mapFont(r,t,o,e,u){const m=t!==0;this.logger.debug(ne,re,"MapFont called",{weight:r,italic:m,charset:o,pitchFamily:e,face:u});const d=this.findBestFontMatch(o,r,m);if(!d)return this.logger.debug(ne,re,`No font configured for charset ${o}`),0;const _={id:this.nextHandleId++,charset:o,weight:r,italic:m,url:d.url,data:null};return this.fontHandles.set(_.id,_),this.logger.debug(ne,re,`Created font handle ${_.id} for ${d.url} (requested: weight=${r}, italic=${m}, matched: weight=${d.matchedWeight}, italic=${d.matchedItalic})`),_.id}getFontData(r,t,o,e){const u=this.fontHandles.get(r);if(!u)return this.logger.warn(ne,re,`Unknown font handle: ${r}`),0;if(u.data||(this.fontCache.has(u.url)?u.data=this.fontCache.get(u.url):(u.data=this.fetchFontSync(u.url),u.data&&this.fontCache.set(u.url,u.data))),!u.data)return this.logger.warn(ne,re,`Failed to load font: ${u.url}`),0;const m=u.data;return t!==0?(this.logger.debug(ne,re,`Table ${t} requested - returning 0 to request whole file`),0):(o===0||e<m.length||this.module&&(this.module.pdfium.HEAPU8.set(m,o),this.logger.debug(ne,re,`Copied ${m.length} bytes to buffer for handle ${r}`)),m.length)}deleteFont(r){this.fontHandles.get(r)&&(this.logger.debug(ne,re,`Deleting font handle ${r}`),this.fontHandles.delete(r))}findBestFontMatch(r,t,o){const{fonts:e,defaultFont:u,baseUrl:m}=this.fontConfig,d=e[r]??u;if(!d)return null;const _=this.normalizeToVariants(d);if(_.length===0)return null;const P=this.selectBestVariant(_,t,o);let b=P.url;return!m||b.startsWith("http://")||b.startsWith("https://")||b.startsWith("/")||(b=`${m}/${b}`),{url:b,matchedWeight:P.weight??400,matchedItalic:P.italic??!1}}normalizeToVariants(r){return typeof r=="string"?[{url:r,weight:400,italic:!1}]:Array.isArray(r)?r.map(t=>({url:t.url,weight:t.weight??400,italic:t.italic??!1})):[{url:r.url,weight:r.weight??400,italic:r.italic??!1}]}selectBestVariant(r,t,o){if(r.length===1)return r[0];const e=r.filter(_=>(_.italic??!1)===o),u=e.length>0?e:r;let m=u[0],d=Math.abs((m.weight??400)-t);for(const _ of u){const P=_.weight??400,b=Math.abs(P-t);if(b<d)m=_,d=b;else if(b===d){const p=m.weight??400;t>=500?P>p&&(m=_):P<p&&(m=_)}}return m}getFontUrlForCharset(r){const t=this.findBestFontMatch(r,400,!1);return t?.url??null}fetchFontSync(r){if(this.logger.debug(ne,re,`Fetching font synchronously: ${r}`),this.fontConfig.fontLoader)try{const t=this.fontConfig.fontLoader(r);return t?this.logger.info(ne,re,`Loaded font via custom loader: ${r} (${t.length} bytes)`):this.logger.warn(ne,re,`Custom font loader returned null for: ${r}`),t}catch(t){return this.logger.error(ne,re,`Error in custom font loader: ${r}`,t),null}try{const t=new XMLHttpRequest;if(t.open("GET",r,!1),t.responseType="arraybuffer",t.send(),t.status===200){const o=new Uint8Array(t.response);return this.logger.info(ne,re,`Loaded font: ${r} (${o.length} bytes)`),o}return this.logger.error(ne,re,`Failed to load font: ${r} (HTTP ${t.status})`),null}catch(t){return this.logger.error(ne,re,`Error fetching font: ${r}`,t),null}}async fetchFontAsync(r){if(this.fontConfig.fontLoader)try{return this.fontConfig.fontLoader(r)}catch{return null}try{const t=await fetch(r);if(t.ok){const o=await t.arrayBuffer();return new Uint8Array(o)}return null}catch{return null}}}const h="PDFiumEngine",D="Engine";class Vn{constructor(r,t={}){this.pdfiumModule=r,this.memoryLeakCheckInterval=null,this.fontFallbackManager=null;const{logger:o=new on,fontFallback:e}=t;this.logger=o,this.memoryManager=new Ln(this.pdfiumModule,this.logger),this.cache=new Rn(this.pdfiumModule,this.memoryManager),this.logger.isEnabled("debug")&&(this.memoryLeakCheckInterval=setInterval(()=>{this.memoryManager.checkLeaks()},1e4)),this.logger.debug(h,D,"initialize"),this.logger.perf(h,D,"Initialize","Begin","General"),this.pdfiumModule.PDFiumExt_Init(),this.logger.perf(h,D,"Initialize","End","General"),e&&(this.fontFallbackManager=new Nn(e,this.logger),this.fontFallbackManager.initialize(this.pdfiumModule),this.logger.info(h,D,"Font fallback system enabled"))}destroy(){return this.logger.debug(h,D,"destroy"),this.logger.perf(h,D,"Destroy","Begin","General"),this.fontFallbackManager&&(this.fontFallbackManager.disable(),this.fontFallbackManager=null),this.pdfiumModule.FPDF_DestroyLibrary(),this.memoryLeakCheckInterval&&(clearInterval(this.memoryLeakCheckInterval),this.memoryLeakCheckInterval=null),this.logger.perf(h,D,"Destroy","End","General"),y.resolve(!0)}getFontFallbackManager(){return this.fontFallbackManager}withWString(r,t){const o=2*(r.length+1),e=this.memoryManager.malloc(o);try{return this.pdfiumModule.pdfium.stringToUTF16(r,e,o),t(e)}finally{this.memoryManager.free(e)}}withFloatArray(r,t){const o=r??[],e=4*o.length,u=e?this.memoryManager.malloc(e):0;try{if(e)for(let m=0;m<o.length;m++)this.pdfiumModule.pdfium.setValue(u+4*m,o[m],"float");return t(u,o.length)}finally{e&&this.memoryManager.free(u)}}openDocumentBuffer(r,t){this.logger.debug(h,D,"openDocumentBuffer",r,t),this.logger.perf(h,D,"OpenDocumentBuffer","Begin",r.id);const o=new Uint8Array(r.content),e=o.length,u=this.memoryManager.malloc(e);this.pdfiumModule.pdfium.HEAPU8.set(o,u);const m=this.pdfiumModule.FPDF_LoadMemDocument(u,e,t?.password??"");if(!m){const G=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(h,D,`FPDF_LoadMemDocument failed with ${G}`),this.memoryManager.free(u),this.logger.perf(h,D,"OpenDocumentBuffer","End",r.id),y.reject({code:G,message:"FPDF_LoadMemDocument failed"})}const d=this.pdfiumModule.FPDF_GetPageCount(m),_=[],P=this.memoryManager.malloc(8);for(let G=0;G<d;G++){if(!this.pdfiumModule.FPDF_GetPageSizeByIndexF(m,G,P)){const R=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(h,D,`FPDF_GetPageSizeByIndexF failed with ${R}`),this.memoryManager.free(P),this.pdfiumModule.FPDF_CloseDocument(m),this.memoryManager.free(u),this.logger.perf(h,D,"OpenDocumentBuffer","End",r.id),y.reject({code:R,message:"FPDF_GetPageSizeByIndexF failed"})}const v=this.pdfiumModule.EPDF_GetPageRotationByIndex(m,G),C={index:G,size:{width:this.pdfiumModule.pdfium.getValue(P,"float"),height:this.pdfiumModule.pdfium.getValue(P+4,"float")},rotation:v};_.push(C)}this.memoryManager.free(P);const b=this.pdfiumModule.EPDF_IsEncrypted(m),p=this.pdfiumModule.EPDF_IsOwnerUnlocked(m),M=this.pdfiumModule.FPDF_GetDocPermissions(m),E={id:r.id,pageCount:d,pages:_,isEncrypted:b,isOwnerUnlocked:p,permissions:M};return this.cache.setDocument(r.id,u,m),this.logger.perf(h,D,"OpenDocumentBuffer","End",r.id),y.resolve(E)}getMetadata(r){this.logger.debug(h,D,"getMetadata",r),this.logger.perf(h,D,"GetMetadata","Begin",r.id);const t=this.cache.getContext(r.id);if(!t)return this.logger.perf(h,D,"GetMetadata","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const o=this.readMetaText(t.docPtr,"CreationDate"),e=this.readMetaText(t.docPtr,"ModDate"),u={title:this.readMetaText(t.docPtr,"Title"),author:this.readMetaText(t.docPtr,"Author"),subject:this.readMetaText(t.docPtr,"Subject"),keywords:this.readMetaText(t.docPtr,"Keywords"),producer:this.readMetaText(t.docPtr,"Producer"),creator:this.readMetaText(t.docPtr,"Creator"),creationDate:o?mt(o)??null:null,modificationDate:e?mt(e)??null:null,trapped:this.getMetaTrapped(t.docPtr),custom:this.readAllMeta(t.docPtr,!0)};return this.logger.perf(h,D,"GetMetadata","End",r.id),y.resolve(u)}setMetadata(r,t){this.logger.debug(h,D,"setMetadata",r,t),this.logger.perf(h,D,"SetMetadata","Begin",r.id);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"SetMetadata","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const e=[["title","Title"],["author","Author"],["subject","Subject"],["keywords","Keywords"],["producer","Producer"],["creator","Creator"]];let u=!0;for(const[d,_]of e){const P=t[d];if(P===void 0)continue;const b=P===null?null:P;this.setMetaText(o.docPtr,_,b)||(u=!1)}const m=(d,_)=>{const P=t[d];if(P===void 0)return;if(P===null)return void(this.setMetaText(o.docPtr,_,null)||(u=!1));const b=pt(P);this.setMetaText(o.docPtr,_,b)||(u=!1)};if(m("creationDate","CreationDate"),m("modificationDate","ModDate"),t.trapped!==void 0&&(this.setMetaTrapped(o.docPtr,t.trapped??null)||(u=!1)),t.custom!==void 0)for(const[d,_]of Object.entries(t.custom))kn(d)?this.setMetaText(o.docPtr,d,_??null)||(u=!1):this.logger.warn(h,D,"Invalid custom metadata key skipped",d);return this.logger.perf(h,D,"SetMetadata","End",r.id),u?y.resolve(!0):y.reject({code:x.Unknown,message:"one or more metadata fields could not be written"})}getDocPermissions(r){this.logger.debug(h,D,"getDocPermissions",r),this.logger.perf(h,D,"getDocPermissions","Begin",r.id);const t=this.cache.getContext(r.id);if(!t)return this.logger.perf(h,D,"getDocPermissions","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const o=this.pdfiumModule.FPDF_GetDocPermissions(t.docPtr);return y.resolve(o)}getDocUserPermissions(r){this.logger.debug(h,D,"getDocUserPermissions",r),this.logger.perf(h,D,"getDocUserPermissions","Begin",r.id);const t=this.cache.getContext(r.id);if(!t)return this.logger.perf(h,D,"getDocUserPermissions","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const o=this.pdfiumModule.FPDF_GetDocUserPermissions(t.docPtr);return y.resolve(o)}getSignatures(r){this.logger.debug(h,D,"getSignatures",r),this.logger.perf(h,D,"GetSignatures","Begin",r.id);const t=this.cache.getContext(r.id);if(!t)return this.logger.perf(h,D,"GetSignatures","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const o=[],e=this.pdfiumModule.FPDF_GetSignatureCount(t.docPtr);for(let u=0;u<e;u++){const m=this.pdfiumModule.FPDF_GetSignatureObject(t.docPtr,u),d=Mt(this.pdfiumModule.pdfium,(E,G)=>this.pdfiumModule.FPDFSignatureObj_GetContents(m,E,G)),_=Mt(this.pdfiumModule.pdfium,(E,G)=>4*this.pdfiumModule.FPDFSignatureObj_GetByteRange(m,E,G)),P=Mt(this.pdfiumModule.pdfium,(E,G)=>this.pdfiumModule.FPDFSignatureObj_GetSubFilter(m,E,G)),b=se(this.pdfiumModule.pdfium,(E,G)=>this.pdfiumModule.FPDFSignatureObj_GetReason(m,E,G),this.pdfiumModule.pdfium.UTF16ToString),p=se(this.pdfiumModule.pdfium,(E,G)=>this.pdfiumModule.FPDFSignatureObj_GetTime(m,E,G),this.pdfiumModule.pdfium.UTF8ToString),M=this.pdfiumModule.FPDFSignatureObj_GetDocMDPPermission(m);o.push({contents:d,byteRange:_,subFilter:P,reason:b,time:p,docMDP:M})}return this.logger.perf(h,D,"GetSignatures","End",r.id),y.resolve(o)}getBookmarks(r){this.logger.debug(h,D,"getBookmarks",r),this.logger.perf(h,D,"GetBookmarks","Begin",r.id);const t=this.cache.getContext(r.id);if(!t)return this.logger.perf(h,D,"getBookmarks","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const o=this.readPdfBookmarks(t.docPtr,0);return this.logger.perf(h,D,"GetBookmarks","End",r.id),y.resolve({bookmarks:o})}setBookmarks(r,t){this.logger.debug(h,D,"setBookmarks",r,t),this.logger.perf(h,D,"SetBookmarks","Begin",r.id);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"SetBookmarks","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});if(!this.pdfiumModule.EPDFBookmark_Clear(o.docPtr))return this.logger.perf(h,D,"SetBookmarks","End",r.id),y.reject({code:x.Unknown,message:"failed to clear existing bookmarks"});const e=(m,d)=>{var _;for(const P of d){const b=this.withWString(P.title??"",p=>this.pdfiumModule.EPDFBookmark_AppendChild(o.docPtr,m,p));if(!b||P.target&&!this.applyBookmarkTarget(o.docPtr,b,P.target)||(_=P.children)!=null&&_.length&&!e(b,P.children))return!1}return!0},u=e(0,t);return this.logger.perf(h,D,"SetBookmarks","End",r.id),u?y.resolve(!0):y.reject({code:x.Unknown,message:"failed to build bookmark tree"})}deleteBookmarks(r){this.logger.debug(h,D,"deleteBookmarks",r),this.logger.perf(h,D,"DeleteBookmarks","Begin",r.id);const t=this.cache.getContext(r.id);if(!t)return this.logger.perf(h,D,"DeleteBookmarks","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const o=this.pdfiumModule.EPDFBookmark_Clear(t.docPtr);return this.logger.perf(h,D,"DeleteBookmarks","End",r.id),o?y.resolve(!0):y.reject({code:x.Unknown,message:"failed to clear bookmarks"})}renderPageRaw(r,t,o){this.logger.debug(h,D,"renderPage",r,t,o),this.logger.perf(h,D,"RenderPage","Begin",`${r.id}-${t.index}`);const e={origin:{x:0,y:0},size:t.size},u=this.renderRectEncoded(r,t,e,o);return this.logger.perf(h,D,"RenderPage","End",`${r.id}-${t.index}`),u}renderPageRect(r,t,o,e){this.logger.debug(h,D,"renderPageRect",r,t,o,e),this.logger.perf(h,D,"RenderPageRect","Begin",`${r.id}-${t.index}`);const u=this.renderRectEncoded(r,t,o,e);return this.logger.perf(h,D,"RenderPageRect","End",`${r.id}-${t.index}`),u}getPageAnnotations(r,t){this.logger.debug(h,D,"getPageAnnotations",r,t),this.logger.perf(h,D,"GetPageAnnotations","Begin",`${r.id}-${t.index}`);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"GetPageAnnotations","End",`${r.id}-${t.index}`),y.reject({code:x.DocNotOpen,message:"document does not open"});const e=this.readPageAnnotations(o,t);return this.logger.perf(h,D,"GetPageAnnotations","End",`${r.id}-${t.index}`),this.logger.debug(h,D,"GetPageAnnotations",`${r.id}-${t.index}`,e),y.resolve(e)}createPageAnnotation(r,t,o,e){this.logger.debug(h,D,"createPageAnnotation",r,t,o),this.logger.perf(h,D,"CreatePageAnnotation","Begin",`${r.id}-${t.index}`);const u=this.cache.getContext(r.id);if(!u)return this.logger.perf(h,D,"CreatePageAnnotation","End",`${r.id}-${t.index}`),y.reject({code:x.DocNotOpen,message:"document does not open"});const m=u.acquirePage(t.index),d=this.pdfiumModule.EPDFPage_CreateAnnot(m.pagePtr,o.type);if(!d)return this.logger.perf(h,D,"CreatePageAnnotation","End",`${r.id}-${t.index}`),m.release(),y.reject({code:x.CantCreateAnnot,message:"can not create annotation with specified type"});if(Jt(o.id)||(o.id=qt()),!this.setAnnotString(d,"NM",o.id))return this.pdfiumModule.FPDFPage_CloseAnnot(d),m.release(),y.reject({code:x.CantSetAnnotString,message:"can not set the name of the annotation"});if(!this.setPageAnnoRect(t,d,o.rect))return this.pdfiumModule.FPDFPage_CloseAnnot(d),m.release(),this.logger.perf(h,D,"CreatePageAnnotation","End",`${r.id}-${t.index}`),y.reject({code:x.CantSetAnnotRect,message:"can not set the rect of the annotation"});let _=!1;switch(o.type){case L.INK:_=this.addInkStroke(t,m.pagePtr,d,o);break;case L.STAMP:_=this.addStampContent(u.docPtr,t,m.pagePtr,d,o,e?.imageData);break;case L.TEXT:_=this.addTextContent(t,m.pagePtr,d,o);break;case L.FREETEXT:_=this.addFreeTextContent(t,m.pagePtr,d,o);break;case L.LINE:_=this.addLineContent(t,m.pagePtr,d,o);break;case L.POLYLINE:case L.POLYGON:_=this.addPolyContent(t,m.pagePtr,d,o);break;case L.CIRCLE:case L.SQUARE:_=this.addShapeContent(t,m.pagePtr,d,o);break;case L.UNDERLINE:case L.STRIKEOUT:case L.SQUIGGLY:case L.HIGHLIGHT:_=this.addTextMarkupContent(t,m.pagePtr,d,o)}return _?(o.blendMode!==void 0?this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(d,o.blendMode):this.pdfiumModule.EPDFAnnot_GenerateAppearance(d),this.pdfiumModule.FPDFPage_GenerateContent(m.pagePtr),this.pdfiumModule.FPDFPage_CloseAnnot(d),m.release(),this.logger.perf(h,D,"CreatePageAnnotation","End",`${r.id}-${t.index}`),y.resolve(o.id)):(this.pdfiumModule.FPDFPage_RemoveAnnot(m.pagePtr,d),m.release(),this.logger.perf(h,D,"CreatePageAnnotation","End",`${r.id}-${t.index}`),y.reject({code:x.CantSetAnnotContent,message:"can not add content of the annotation"}))}updatePageAnnotation(r,t,o){this.logger.debug(h,D,"updatePageAnnotation",r,t,o),this.logger.perf(h,D,"UpdatePageAnnotation","Begin",`${r.id}-${t.index}`);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(h,D,"UpdatePageAnnotation","End",`${r.id}-${t.index}`),y.reject({code:x.DocNotOpen,message:"document does not open"});const u=e.acquirePage(t.index),m=this.getAnnotationByName(u.pagePtr,o.id);if(!m)return u.release(),this.logger.perf(h,D,"UpdatePageAnnotation","End",`${r.id}-${t.index}`),y.reject({code:x.NotFound,message:"annotation not found"});if(!this.setPageAnnoRect(t,m,o.rect))return this.pdfiumModule.FPDFPage_CloseAnnot(m),u.release(),this.logger.perf(h,D,"UpdatePageAnnotation","End",`${r.id}-${t.index}`),y.reject({code:x.CantSetAnnotRect,message:"failed to move annotation"});let d=!1;switch(o.type){case L.INK:if(!this.pdfiumModule.FPDFAnnot_RemoveInkList(m))break;d=this.addInkStroke(t,u.pagePtr,m,o);break;case L.STAMP:d=this.addStampContent(e.docPtr,t,u.pagePtr,m,o);break;case L.TEXT:d=this.addTextContent(t,u.pagePtr,m,o);break;case L.FREETEXT:d=this.addFreeTextContent(t,u.pagePtr,m,o);break;case L.CIRCLE:case L.SQUARE:d=this.addShapeContent(t,u.pagePtr,m,o);break;case L.LINE:d=this.addLineContent(t,u.pagePtr,m,o);break;case L.POLYGON:case L.POLYLINE:d=this.addPolyContent(t,u.pagePtr,m,o);break;case L.HIGHLIGHT:case L.UNDERLINE:case L.STRIKEOUT:case L.SQUIGGLY:d=this.addTextMarkupContent(t,u.pagePtr,m,o);break;default:d=!1}return d&&(o.blendMode!==void 0?this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(m,o.blendMode):this.pdfiumModule.EPDFAnnot_GenerateAppearance(m),this.pdfiumModule.FPDFPage_GenerateContent(u.pagePtr)),this.pdfiumModule.FPDFPage_CloseAnnot(m),u.release(),this.logger.perf(h,D,"UpdatePageAnnotation","End",`${r.id}-${t.index}`),d?y.resolve(!0):y.reject({code:x.CantSetAnnotContent,message:"failed to update annotation"})}removePageAnnotation(r,t,o){this.logger.debug(h,D,"removePageAnnotation",r,t,o),this.logger.perf(h,D,"RemovePageAnnotation","Begin",`${r.id}-${t.index}`);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(h,D,"RemovePageAnnotation","End",`${r.id}-${t.index}`),y.reject({code:x.DocNotOpen,message:"document does not open"});const u=e.acquirePage(t.index);let m=!1;return m=this.removeAnnotationByName(u.pagePtr,o.id),m?(m=this.pdfiumModule.FPDFPage_GenerateContent(u.pagePtr),m||this.logger.error(h,D,"FPDFPage_GenerateContent Failed",`${r.id}-${t.index}`)):this.logger.error(h,D,"FPDFPage_RemoveAnnot Failed",`${r.id}-${t.index}`),u.release(),this.logger.perf(h,D,"RemovePageAnnotation","End",`${r.id}-${t.index}`),y.resolve(m)}getPageTextRects(r,t){this.logger.debug(h,D,"getPageTextRects",r,t),this.logger.perf(h,D,"GetPageTextRects","Begin",`${r.id}-${t.index}`);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"GetPageTextRects","End",`${r.id}-${t.index}`),y.reject({code:x.DocNotOpen,message:"document does not open"});const e=o.acquirePage(t.index),u=this.pdfiumModule.FPDFText_LoadPage(e.pagePtr),m=this.readPageTextRects(t,e.docPtr,e.pagePtr,u);return this.pdfiumModule.FPDFText_ClosePage(u),e.release(),this.logger.perf(h,D,"GetPageTextRects","End",`${r.id}-${t.index}`),y.resolve(m)}renderThumbnailRaw(r,t,o){const{scaleFactor:e=1,...u}=o??{};if(this.logger.debug(h,D,"renderThumbnail",r,t,o),this.logger.perf(h,D,"RenderThumbnail","Begin",`${r.id}-${t.index}`),!this.cache.getContext(r.id))return this.logger.perf(h,D,"RenderThumbnail","End",`${r.id}-${t.index}`),y.reject({code:x.DocNotOpen,message:"document does not open"});const m=this.renderPageRaw(r,t,{scaleFactor:Math.max(e,.5),...u});return this.logger.perf(h,D,"RenderThumbnail","End",`${r.id}-${t.index}`),m}getAttachments(r){this.logger.debug(h,D,"getAttachments",r),this.logger.perf(h,D,"GetAttachments","Begin",r.id);const t=this.cache.getContext(r.id);if(!t)return this.logger.perf(h,D,"GetAttachments","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const o=[],e=this.pdfiumModule.FPDFDoc_GetAttachmentCount(t.docPtr);for(let u=0;u<e;u++){const m=this.readPdfAttachment(t.docPtr,u);o.push(m)}return this.logger.perf(h,D,"GetAttachments","End",r.id),y.resolve(o)}addAttachment(r,t){this.logger.debug(h,D,"addAttachment",r,t?.name),this.logger.perf(h,D,"AddAttachment","Begin",r.id);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"AddAttachment","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const{name:e,description:u,mimeType:m,data:d}=t??{};if(!e)return this.logger.perf(h,D,"AddAttachment","End",r.id),y.reject({code:x.NotFound,message:"attachment name is required"});if(!d||d.byteLength===0)return this.logger.perf(h,D,"AddAttachment","End",r.id),y.reject({code:x.NotFound,message:"attachment data is empty"});const _=this.withWString(e,M=>this.pdfiumModule.FPDFDoc_AddAttachment(o.docPtr,M));if(!_)return this.logger.perf(h,D,"AddAttachment","End",r.id),y.reject({code:x.Unknown,message:`An attachment named "${e}" already exists`});this.withWString(u,M=>this.pdfiumModule.EPDFAttachment_SetDescription(_,M)),this.pdfiumModule.EPDFAttachment_SetSubtype(_,m);const P=d instanceof Uint8Array?d:new Uint8Array(d),b=P.byteLength,p=this.memoryManager.malloc(b);try{if(this.pdfiumModule.pdfium.HEAPU8.set(P,p),!this.pdfiumModule.FPDFAttachment_SetFile(_,o.docPtr,p,b))return this.logger.perf(h,D,"AddAttachment","End",r.id),y.reject({code:x.Unknown,message:"failed to write attachment bytes"})}finally{this.memoryManager.free(p)}return this.logger.perf(h,D,"AddAttachment","End",r.id),y.resolve(!0)}removeAttachment(r,t){this.logger.debug(h,D,"deleteAttachment",r,t),this.logger.perf(h,D,"DeleteAttachment","Begin",r.id);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"DeleteAttachment","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const e=this.pdfiumModule.FPDFDoc_GetAttachmentCount(o.docPtr);if(t.index<0||t.index>=e)return this.logger.perf(h,D,"DeleteAttachment","End",r.id),y.reject({code:x.Unknown,message:`attachment index ${t.index} out of range`});const u=this.pdfiumModule.FPDFDoc_DeleteAttachment(o.docPtr,t.index);return this.logger.perf(h,D,"DeleteAttachment","End",r.id),u?y.resolve(!0):y.reject({code:x.Unknown,message:"failed to delete attachment"})}readAttachmentContent(r,t){this.logger.debug(h,D,"readAttachmentContent",r,t),this.logger.perf(h,D,"ReadAttachmentContent","Begin",r.id);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"ReadAttachmentContent","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const e=this.pdfiumModule.FPDFDoc_GetAttachment(o.docPtr,t.index),u=this.memoryManager.malloc(4);if(!this.pdfiumModule.FPDFAttachment_GetFile(e,0,0,u))return this.memoryManager.free(u),this.logger.perf(h,D,"ReadAttachmentContent","End",r.id),y.reject({code:x.CantReadAttachmentSize,message:"can not read attachment size"});const m=this.pdfiumModule.pdfium.getValue(u,"i32")>>>0,d=this.memoryManager.malloc(m);if(!this.pdfiumModule.FPDFAttachment_GetFile(e,d,m,u))return this.memoryManager.free(u),this.memoryManager.free(d),this.logger.perf(h,D,"ReadAttachmentContent","End",r.id),y.reject({code:x.CantReadAttachmentContent,message:"can not read attachment content"});const _=new ArrayBuffer(m),P=new DataView(_);for(let b=0;b<m;b++)P.setInt8(b,this.pdfiumModule.pdfium.getValue(d+b,"i8"));return this.memoryManager.free(u),this.memoryManager.free(d),this.logger.perf(h,D,"ReadAttachmentContent","End",r.id),y.resolve(_)}setFormFieldValue(r,t,o,e){this.logger.debug(h,D,"SetFormFieldValue",r,o,e),this.logger.perf(h,D,"SetFormFieldValue","Begin",`${r.id}-${o.id}`);const u=this.cache.getContext(r.id);if(!u)return this.logger.debug(h,D,"SetFormFieldValue","document is not opened"),this.logger.perf(h,D,"SetFormFieldValue","End",`${r.id}-${o.id}`),y.reject({code:x.DocNotOpen,message:"document does not open"});const m=this.pdfiumModule.PDFiumExt_OpenFormFillInfo(),d=this.pdfiumModule.PDFiumExt_InitFormFillEnvironment(u.docPtr,m),_=u.acquirePage(t.index);this.pdfiumModule.FORM_OnAfterLoadPage(_.pagePtr,d);const P=this.getAnnotationByName(_.pagePtr,o.id);if(!P)return _.release(),this.logger.perf(h,D,"SetFormFieldValue","End",`${r.id}-${t.index}`),y.reject({code:x.NotFound,message:"annotation not found"});if(!this.pdfiumModule.FORM_SetFocusedAnnot(d,P))return this.logger.debug(h,D,"SetFormFieldValue","failed to set focused annotation"),this.logger.perf(h,D,"SetFormFieldValue","End",`${r.id}-${o.id}`),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(m),y.reject({code:x.CantFocusAnnot,message:"failed to set focused annotation"});switch(e.kind){case"text":{if(!this.pdfiumModule.FORM_SelectAllText(d,_.pagePtr))return this.logger.debug(h,D,"SetFormFieldValue","failed to select all text"),this.logger.perf(h,D,"SetFormFieldValue","End",`${r.id}-${o.id}`),this.pdfiumModule.FORM_ForceToKillFocus(d),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(m),y.reject({code:x.CantSelectText,message:"failed to select all text"});const b=2*(e.text.length+1),p=this.memoryManager.malloc(b);this.pdfiumModule.pdfium.stringToUTF16(e.text,p,b),this.pdfiumModule.FORM_ReplaceSelection(d,_.pagePtr,p),this.memoryManager.free(p)}break;case"selection":if(!this.pdfiumModule.FORM_SetIndexSelected(d,_.pagePtr,e.index,e.isSelected))return this.logger.debug(h,D,"SetFormFieldValue","failed to set index selected"),this.logger.perf(h,D,"SetFormFieldValue","End",`${r.id}-${o.id}`),this.pdfiumModule.FORM_ForceToKillFocus(d),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(m),y.reject({code:x.CantSelectOption,message:"failed to set index selected"});break;case"checked":if(!this.pdfiumModule.FORM_OnChar(d,_.pagePtr,13,0))return this.logger.debug(h,D,"SetFormFieldValue","failed to set field checked"),this.logger.perf(h,D,"SetFormFieldValue","End",`${r.id}-${o.id}`),this.pdfiumModule.FORM_ForceToKillFocus(d),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(m),y.reject({code:x.CantCheckField,message:"failed to set field checked"})}return this.pdfiumModule.FORM_ForceToKillFocus(d),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(m),y.resolve(!0)}flattenPage(r,t,o){const{flag:e=hn.Display}=o??{};this.logger.debug(h,D,"flattenPage",r,t,e),this.logger.perf(h,D,"flattenPage","Begin",r.id);const u=this.cache.getContext(r.id);if(!u)return this.logger.perf(h,D,"flattenPage","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const m=u.acquirePage(t.index),d=this.pdfiumModule.FPDFPage_Flatten(m.pagePtr,e);return m.release(),this.logger.perf(h,D,"flattenPage","End",r.id),y.resolve(d)}extractPages(r,t){this.logger.debug(h,D,"extractPages",r,t),this.logger.perf(h,D,"ExtractPages","Begin",r.id);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"ExtractPages","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const e=this.pdfiumModule.FPDF_CreateNewDocument();if(!e)return this.logger.perf(h,D,"ExtractPages","End",r.id),y.reject({code:x.CantCreateNewDoc,message:"can not create new document"});const u=this.memoryManager.malloc(4*t.length);for(let d=0;d<t.length;d++)this.pdfiumModule.pdfium.setValue(u+4*d,t[d],"i32");if(!this.pdfiumModule.FPDF_ImportPagesByIndex(e,o.docPtr,u,t.length,0))return this.pdfiumModule.FPDF_CloseDocument(e),this.logger.perf(h,D,"ExtractPages","End",r.id),y.reject({code:x.CantImportPages,message:"can not import pages to new document"});const m=this.saveDocument(e);return this.pdfiumModule.FPDF_CloseDocument(e),this.logger.perf(h,D,"ExtractPages","End",r.id),y.resolve(m)}extractText(r,t){this.logger.debug(h,D,"extractText",r,t),this.logger.perf(h,D,"ExtractText","Begin",r.id);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"ExtractText","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const e=[];for(let m=0;m<t.length;m++){const d=o.acquirePage(t[m]),_=this.pdfiumModule.FPDFText_LoadPage(d.pagePtr),P=this.pdfiumModule.FPDFText_CountChars(_),b=this.memoryManager.malloc(2*(P+1));this.pdfiumModule.FPDFText_GetText(_,0,P,b);const p=this.pdfiumModule.pdfium.UTF16ToString(b);this.memoryManager.free(b),e.push(p),this.pdfiumModule.FPDFText_ClosePage(_),d.release()}const u=e.join(`

`);return this.logger.perf(h,D,"ExtractText","End",r.id),y.resolve(u)}getTextSlices(r,t){if(this.logger.debug(h,D,"getTextSlices",r,t),this.logger.perf(h,D,"GetTextSlices","Begin",r.id),t.length===0)return this.logger.perf(h,D,"GetTextSlices","End",r.id),y.resolve([]);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"GetTextSlices","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});try{const e=new Array(t.length),u=new Map;t.forEach((m,d)=>{(u.get(m.pageIndex)??u.set(m.pageIndex,[]).get(m.pageIndex)).push({slice:m,pos:d})});for(const[m,d]of u){const _=o.acquirePage(m),P=_.getTextPage();for(const{slice:b,pos:p}of d){const M=this.memoryManager.malloc(2*(b.charCount+1));this.pdfiumModule.FPDFText_GetText(P,b.charIndex,b.charCount,M),e[p]=Dn(this.pdfiumModule.pdfium.UTF16ToString(M)),this.memoryManager.free(M)}_.release()}return this.logger.perf(h,D,"GetTextSlices","End",r.id),y.resolve(e)}catch(e){return this.logger.error(h,D,"getTextSlices error",e),this.logger.perf(h,D,"GetTextSlices","End",r.id),y.reject({code:x.Unknown,message:String(e)})}}merge(r){this.logger.debug(h,D,"merge",r);const t=r.map(d=>d.id).join(".");this.logger.perf(h,D,"Merge","Begin",t);const o=this.pdfiumModule.FPDF_CreateNewDocument();if(!o)return this.logger.perf(h,D,"Merge","End",t),y.reject({code:x.CantCreateNewDoc,message:"can not create new document"});const e=[];for(const d of r.reverse()){const _=new Uint8Array(d.content),P=_.length,b=this.memoryManager.malloc(P);this.pdfiumModule.pdfium.HEAPU8.set(_,b);const p=this.pdfiumModule.FPDF_LoadMemDocument(b,P,"");if(!p){const M=this.pdfiumModule.FPDF_GetLastError();this.logger.error(h,D,`FPDF_LoadMemDocument failed with ${M}`),this.memoryManager.free(b);for(const E of e)this.pdfiumModule.FPDF_CloseDocument(E.docPtr),this.memoryManager.free(E.filePtr);return this.logger.perf(h,D,"Merge","End",t),y.reject({code:M,message:"FPDF_LoadMemDocument failed"})}if(e.push({filePtr:b,docPtr:p}),!this.pdfiumModule.FPDF_ImportPages(o,p,"",0)){this.pdfiumModule.FPDF_CloseDocument(o);for(const M of e)this.pdfiumModule.FPDF_CloseDocument(M.docPtr),this.memoryManager.free(M.filePtr);return this.logger.perf(h,D,"Merge","End",t),y.reject({code:x.CantImportPages,message:"can not import pages to new document"})}}const u=this.saveDocument(o);this.pdfiumModule.FPDF_CloseDocument(o);for(const d of e)this.pdfiumModule.FPDF_CloseDocument(d.docPtr),this.memoryManager.free(d.filePtr);const m={id:`${Math.random()}`,content:u};return this.logger.perf(h,D,"Merge","End",t),y.resolve(m)}mergePages(r){const t=r.map(e=>`${e.docId}:${e.pageIndices.join(",")}`).join("|");this.logger.debug(h,D,"mergePages",r),this.logger.perf(h,D,"MergePages","Begin",t);const o=this.pdfiumModule.FPDF_CreateNewDocument();if(!o)return this.logger.perf(h,D,"MergePages","End",t),y.reject({code:x.CantCreateNewDoc,message:"Cannot create new document"});try{for(const m of[...r].reverse()){const d=this.cache.getContext(m.docId);if(!d){this.logger.warn(h,D,`Document ${m.docId} is not open, skipping`);continue}const _=this.pdfiumModule.FPDF_GetPageCount(d.docPtr),P=m.pageIndices.filter(p=>p>=0&&p<_);if(P.length===0)continue;const b=P.map(p=>p+1).join(",");try{if(!this.pdfiumModule.FPDF_ImportPages(o,d.docPtr,b,0))throw new Error(`Failed to import pages ${b} from document ${m.docId}`)}finally{}}const e=this.saveDocument(o),u={id:`${Math.random()}`,content:e};return this.logger.perf(h,D,"MergePages","End",t),y.resolve(u)}catch(e){return this.logger.error(h,D,"mergePages failed",e),this.logger.perf(h,D,"MergePages","End",t),y.reject({code:x.CantImportPages,message:e instanceof Error?e.message:"Failed to merge pages"})}finally{o&&this.pdfiumModule.FPDF_CloseDocument(o)}}setDocumentEncryption(r,t,o,e){this.logger.debug(h,D,"setDocumentEncryption",r,e);const u=this.cache.getContext(r.id);if(!u)return y.reject({code:x.DocNotOpen,message:"document does not open"});const m=this.pdfiumModule.EPDF_SetEncryption(u.docPtr,t,o,e);return y.resolve(m)}removeEncryption(r){this.logger.debug(h,D,"removeEncryption",r);const t=this.cache.getContext(r.id);if(!t)return y.reject({code:x.DocNotOpen,message:"document does not open"});const o=this.pdfiumModule.EPDF_RemoveEncryption(t.docPtr);return y.resolve(o)}unlockOwnerPermissions(r,t){this.logger.debug(h,D,"unlockOwnerPermissions",r.id);const o=this.cache.getContext(r.id);if(!o)return y.reject({code:x.DocNotOpen,message:"document does not open"});const e=this.pdfiumModule.EPDF_UnlockOwnerPermissions(o.docPtr,t);return y.resolve(e)}isEncrypted(r){this.logger.debug(h,D,"isEncrypted",r.id);const t=this.cache.getContext(r.id);if(!t)return y.reject({code:x.DocNotOpen,message:"document does not open"});const o=this.pdfiumModule.EPDF_IsEncrypted(t.docPtr);return y.resolve(o)}isOwnerUnlocked(r){this.logger.debug(h,D,"isOwnerUnlocked",r.id);const t=this.cache.getContext(r.id);if(!t)return y.reject({code:x.DocNotOpen,message:"document does not open"});const o=this.pdfiumModule.EPDF_IsOwnerUnlocked(t.docPtr);return y.resolve(o)}saveAsCopy(r){this.logger.debug(h,D,"saveAsCopy",r),this.logger.perf(h,D,"SaveAsCopy","Begin",r.id);const t=this.cache.getContext(r.id);if(!t)return this.logger.perf(h,D,"SaveAsCopy","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const o=this.saveDocument(t.docPtr);return this.logger.perf(h,D,"SaveAsCopy","End",r.id),y.resolve(o)}closeDocument(r){this.logger.debug(h,D,"closeDocument",r),this.logger.perf(h,D,"CloseDocument","Begin",r.id);const t=this.cache.getContext(r.id);return t?(t.dispose(),this.logger.perf(h,D,"CloseDocument","End",r.id),y.resolve(!0)):y.resolve(!0)}closeAllDocuments(){return this.logger.debug(h,D,"closeAllDocuments"),this.logger.perf(h,D,"CloseAllDocuments","Begin"),this.cache.closeAllDocuments(),this.logger.perf(h,D,"CloseAllDocuments","End"),y.resolve(!0)}addTextContent(r,t,o,e){return!!this.setAnnotString(o,"Contents",e.contents??"")&&!(e.custom&&!this.setAnnotCustom(o,e.custom))&&!!this.setAnnotString(o,"T",e.author||"")&&!(e.modified&&!this.setAnnotationDate(o,"M",e.modified))&&!(e.created&&!this.setAnnotationDate(o,"CreationDate",e.created))&&!(e.inReplyToId&&!this.setInReplyToId(t,o,e.inReplyToId))&&!!this.setAnnotationIcon(o,e.icon||bn.Comment)&&!!this.setAnnotationFlags(o,e.flags||["print","noZoom","noRotate"])&&!(e.state&&!this.setAnnotString(o,"State",e.state))&&!(e.stateModel&&!this.setAnnotString(o,"StateModel",e.stateModel))}addFreeTextContent(r,t,o,e){if(e.created&&!this.setAnnotationDate(o,"CreationDate",e.created)||e.custom&&!this.setAnnotCustom(o,e.custom)||e.flags&&!this.setAnnotationFlags(o,e.flags)||e.modified&&!this.setAnnotationDate(o,"M",e.modified)||!this.setBorderStyle(o,Te.SOLID,0)||!this.setAnnotString(o,"Contents",e.contents??"")||!this.setAnnotString(o,"T",e.author||"")||!this.setAnnotationOpacity(o,e.opacity??1)||!this.setAnnotationTextAlignment(o,e.textAlign)||!this.setAnnotationVerticalAlignment(o,e.verticalAlign)||!this.setAnnotationDefaultAppearance(o,e.fontFamily,e.fontSize,e.fontColor)||e.intent&&!this.setAnnotIntent(o,e.intent))return!1;if(e.backgroundColor&&e.backgroundColor!=="transparent"){if(!this.setAnnotationColor(o,e.backgroundColor??"#FFFFFF",ae.Color))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(o,ae.Color))return!1;return!0}addInkStroke(r,t,o,e){return!(e.created&&!this.setAnnotationDate(o,"CreationDate",e.created))&&!(e.custom&&!this.setAnnotCustom(o,e.custom))&&!(e.flags&&!this.setAnnotationFlags(o,e.flags))&&!(e.modified&&!this.setAnnotationDate(o,"M",e.modified))&&!!this.setAnnotString(o,"Contents",e.contents??"")&&!!this.setBorderStyle(o,Te.SOLID,e.strokeWidth)&&!!this.setInkList(r,o,e.inkList)&&!!this.setAnnotString(o,"T",e.author||"")&&!!this.setAnnotationOpacity(o,e.opacity??1)&&!!this.setAnnotationColor(o,e.color??"#FFFF00",ae.Color)}addLineContent(r,t,o,e){var u,m;if(e.created&&!this.setAnnotationDate(o,"CreationDate",e.created)||e.custom&&!this.setAnnotCustom(o,e.custom)||e.flags&&!this.setAnnotationFlags(o,e.flags)||e.modified&&!this.setAnnotationDate(o,"M",e.modified)||!this.setLinePoints(r,o,e.linePoints.start,e.linePoints.end)||!this.setLineEndings(o,((u=e.lineEndings)==null?void 0:u.start)??Xe.None,((m=e.lineEndings)==null?void 0:m.end)??Xe.None)||!this.setAnnotString(o,"Contents",e.contents??"")||!this.setAnnotString(o,"T",e.author||"")||!this.setBorderStyle(o,e.strokeStyle,e.strokeWidth)||!this.setBorderDashPattern(o,e.strokeDashArray??[])||e.intent&&!this.setAnnotIntent(o,e.intent))return!1;if(e.color&&e.color!=="transparent"){if(!this.setAnnotationColor(o,e.color??"#FFFF00",ae.InteriorColor))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(o,ae.InteriorColor))return!1;return!!this.setAnnotationOpacity(o,e.opacity??1)&&!!this.setAnnotationColor(o,e.strokeColor??"#FFFF00",ae.Color)}addPolyContent(r,t,o,e){var u,m;if(e.created&&!this.setAnnotationDate(o,"CreationDate",e.created)||e.custom&&!this.setAnnotCustom(o,e.custom)||e.modified&&!this.setAnnotationDate(o,"M",e.modified)||e.flags&&!this.setAnnotationFlags(o,e.flags)||e.type===L.POLYLINE&&!this.setLineEndings(o,((u=e.lineEndings)==null?void 0:u.start)??Xe.None,((m=e.lineEndings)==null?void 0:m.end)??Xe.None)||!this.setPdfAnnoVertices(r,o,e.vertices)||!this.setAnnotString(o,"Contents",e.contents??"")||!this.setAnnotString(o,"T",e.author||"")||!this.setBorderStyle(o,e.strokeStyle,e.strokeWidth)||!this.setBorderDashPattern(o,e.strokeDashArray??[])||e.intent&&!this.setAnnotIntent(o,e.intent))return!1;if(e.color&&e.color!=="transparent"){if(!this.setAnnotationColor(o,e.color??"#FFFF00",ae.InteriorColor))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(o,ae.InteriorColor))return!1;return!!this.setAnnotationOpacity(o,e.opacity??1)&&!!this.setAnnotationColor(o,e.strokeColor??"#FFFF00",ae.Color)}addShapeContent(r,t,o,e){if(e.created&&!this.setAnnotationDate(o,"CreationDate",e.created)||e.custom&&!this.setAnnotCustom(o,e.custom)||e.modified&&!this.setAnnotationDate(o,"M",e.modified)||!this.setAnnotString(o,"Contents",e.contents??"")||!this.setAnnotString(o,"T",e.author||"")||!this.setBorderStyle(o,e.strokeStyle,e.strokeWidth)||!this.setBorderDashPattern(o,e.strokeDashArray??[])||!this.setAnnotationFlags(o,e.flags))return!1;if(e.color&&e.color!=="transparent"){if(!this.setAnnotationColor(o,e.color??"#FFFF00",ae.InteriorColor))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(o,ae.InteriorColor))return!1;return!!this.setAnnotationOpacity(o,e.opacity??1)&&!!this.setAnnotationColor(o,e.strokeColor??"#FFFF00",ae.Color)}addTextMarkupContent(r,t,o,e){return!(e.created&&!this.setAnnotationDate(o,"CreationDate",e.created))&&!(e.custom&&!this.setAnnotCustom(o,e.custom))&&!(e.flags&&!this.setAnnotationFlags(o,e.flags))&&!(e.modified&&!this.setAnnotationDate(o,"M",e.modified))&&!!this.syncQuadPointsAnno(r,o,e.segmentRects)&&!!this.setAnnotString(o,"Contents",e.contents??"")&&!!this.setAnnotString(o,"T",e.author||"")&&!!this.setAnnotationOpacity(o,e.opacity??1)&&!!this.setAnnotationColor(o,e.color??"#FFFF00",ae.Color)}addStampContent(r,t,o,e,u,m){if(u.created&&!this.setAnnotationDate(e,"CreationDate",u.created)||u.custom&&!this.setAnnotCustom(e,u.custom)||u.flags&&!this.setAnnotationFlags(e,u.flags)||u.modified&&!this.setAnnotationDate(e,"M",u.modified)||u.icon&&!this.setAnnotationIcon(e,u.icon)||!this.setAnnotString(e,"T",u.author||"")||u.subject&&!this.setAnnotString(e,"Subj",u.subject)||!this.setAnnotString(e,"Contents",u.contents??""))return!1;if(m){for(let d=this.pdfiumModule.FPDFAnnot_GetObjectCount(e)-1;d>=0;d--)this.pdfiumModule.FPDFAnnot_RemoveObject(e,d);if(!this.addImageObject(r,t,o,e,u.rect,m))return!1}return!!this.pdfiumModule.EPDFAnnot_UpdateAppearanceToRect(e,fn.Cover)}addImageObject(r,t,o,e,u,m){const d=m.width*m.height,_=this.memoryManager.malloc(4*d);if(!_)return!1;for(let E=0;E<d;E++){const G=m.data[4*E],v=m.data[4*E+1],C=m.data[4*E+2],R=m.data[4*E+3];this.pdfiumModule.pdfium.setValue(_+4*E,C,"i8"),this.pdfiumModule.pdfium.setValue(_+4*E+1,v,"i8"),this.pdfiumModule.pdfium.setValue(_+4*E+2,G,"i8"),this.pdfiumModule.pdfium.setValue(_+4*E+3,R,"i8")}const P=this.pdfiumModule.FPDFBitmap_CreateEx(m.width,m.height,4,_,0);if(!P)return this.memoryManager.free(_),!1;const b=this.pdfiumModule.FPDFPageObj_NewImageObj(r);if(!b)return this.pdfiumModule.FPDFBitmap_Destroy(P),this.memoryManager.free(_),!1;if(!this.pdfiumModule.FPDFImageObj_SetBitmap(o,0,b,P))return this.pdfiumModule.FPDFBitmap_Destroy(P),this.pdfiumModule.FPDFPageObj_Destroy(b),this.memoryManager.free(_),!1;const p=this.memoryManager.malloc(24);if(this.pdfiumModule.pdfium.setValue(p,m.width,"float"),this.pdfiumModule.pdfium.setValue(p+4,0,"float"),this.pdfiumModule.pdfium.setValue(p+8,0,"float"),this.pdfiumModule.pdfium.setValue(p+12,m.height,"float"),this.pdfiumModule.pdfium.setValue(p+16,0,"float"),this.pdfiumModule.pdfium.setValue(p+20,0,"float"),!this.pdfiumModule.FPDFPageObj_SetMatrix(b,p))return this.memoryManager.free(p),this.pdfiumModule.FPDFBitmap_Destroy(P),this.pdfiumModule.FPDFPageObj_Destroy(b),this.memoryManager.free(_),!1;this.memoryManager.free(p);const M=this.convertDevicePointToPagePoint(t,{x:u.origin.x,y:u.origin.y+m.height});return this.pdfiumModule.FPDFPageObj_Transform(b,1,0,0,1,M.x,M.y),this.pdfiumModule.FPDFAnnot_AppendObject(e,b)?(this.pdfiumModule.FPDFBitmap_Destroy(P),this.memoryManager.free(_),!0):(this.pdfiumModule.FPDFBitmap_Destroy(P),this.pdfiumModule.FPDFPageObj_Destroy(b),this.memoryManager.free(_),!1)}saveDocument(r){const t=this.pdfiumModule.PDFiumExt_OpenFileWriter();this.pdfiumModule.PDFiumExt_SaveAsCopy(r,t);const o=this.pdfiumModule.PDFiumExt_GetFileWriterSize(t),e=this.memoryManager.malloc(o);this.pdfiumModule.PDFiumExt_GetFileWriterData(t,e,o);const u=new ArrayBuffer(o),m=new DataView(u);for(let d=0;d<o;d++)m.setInt8(d,this.pdfiumModule.pdfium.getValue(e+d,"i8"));return this.memoryManager.free(e),this.pdfiumModule.PDFiumExt_CloseFileWriter(t),u}readCatalogLanguage(r){const t=this.pdfiumModule.EPDFCatalog_GetLanguage(r,0,0)>>>0;return t===0?null:t===2?"":se(this.pdfiumModule.pdfium,(o,e)=>this.pdfiumModule.EPDFCatalog_GetLanguage(r,o,e),this.pdfiumModule.pdfium.UTF16ToString,t)}readMetaText(r,t){if(!this.pdfiumModule.EPDF_HasMetaText(r,t))return null;const o=this.pdfiumModule.FPDF_GetMetaText(r,t,0,0);return o===2?"":se(this.pdfiumModule.pdfium,(e,u)=>this.pdfiumModule.FPDF_GetMetaText(r,t,e,u),this.pdfiumModule.pdfium.UTF16ToString,o)}setMetaText(r,t,o){if(o==null||o.length===0)return!!this.pdfiumModule.EPDF_SetMetaText(r,t,0);const e=2*(o.length+1),u=this.memoryManager.malloc(e);try{return this.pdfiumModule.pdfium.stringToUTF16(o,u,e),!!this.pdfiumModule.EPDF_SetMetaText(r,t,u)}finally{this.memoryManager.free(u)}}getMetaTrapped(r){const t=Number(this.pdfiumModule.EPDF_GetMetaTrapped(r));switch(t){case fe.NotSet:case fe.True:case fe.False:case fe.Unknown:return t;default:return fe.Unknown}}setMetaTrapped(r,t){const o=t==null||t===void 0?fe.NotSet:t;return!(o!==fe.NotSet&&o!==fe.True&&o!==fe.False&&o!==fe.Unknown)&&!!this.pdfiumModule.EPDF_SetMetaTrapped(r,o)}getMetaKeyCount(r,t){return 0|Number(this.pdfiumModule.EPDF_GetMetaKeyCount(r,t))}getMetaKeyName(r,t,o){const e=this.pdfiumModule.EPDF_GetMetaKeyName(r,t,o,0,0);return e?se(this.pdfiumModule.pdfium,(u,m)=>this.pdfiumModule.EPDF_GetMetaKeyName(r,t,o,u,m),this.pdfiumModule.pdfium.UTF8ToString,e):null}readAllMeta(r,t=!0){const o=this.getMetaKeyCount(r,t),e={};for(let u=0;u<o;u++){const m=this.getMetaKeyName(r,u,t);m&&(e[m]=this.readMetaText(r,m))}return e}readPdfBookmarks(r,t=0){let o=this.pdfiumModule.FPDFBookmark_GetFirstChild(r,t);const e=[];for(;o;){const u=this.readPdfBookmark(r,o);e.push(u),o=this.pdfiumModule.FPDFBookmark_GetNextSibling(r,o)}return e}readPdfBookmark(r,t){const o=se(this.pdfiumModule.pdfium,(u,m)=>this.pdfiumModule.FPDFBookmark_GetTitle(t,u,m),this.pdfiumModule.pdfium.UTF16ToString),e=this.readPdfBookmarks(r,t);return{title:o,target:this.readPdfBookmarkTarget(r,()=>this.pdfiumModule.FPDFBookmark_GetAction(t),()=>this.pdfiumModule.FPDFBookmark_GetDest(r,t)),children:e}}readPageTextRects(r,t,o,e){const u=this.pdfiumModule.FPDFText_CountRects(e,0,-1),m=[];for(let d=0;d<u;d++){const _=this.memoryManager.malloc(8),P=this.memoryManager.malloc(8),b=this.memoryManager.malloc(8),p=this.memoryManager.malloc(8);if(!this.pdfiumModule.FPDFText_GetRect(e,d,P,_,b,p)){this.memoryManager.free(P),this.memoryManager.free(_),this.memoryManager.free(b),this.memoryManager.free(p);continue}const M=this.pdfiumModule.pdfium.getValue(P,"double"),E=this.pdfiumModule.pdfium.getValue(_,"double"),G=this.pdfiumModule.pdfium.getValue(b,"double"),v=this.pdfiumModule.pdfium.getValue(p,"double");this.memoryManager.free(P),this.memoryManager.free(_),this.memoryManager.free(b),this.memoryManager.free(p);const C=this.memoryManager.malloc(4),R=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(o,0,0,r.size.width,r.size.height,0,M,E,C,R);const U=this.pdfiumModule.pdfium.getValue(C,"i32"),V=this.pdfiumModule.pdfium.getValue(R,"i32");this.memoryManager.free(C),this.memoryManager.free(R);const $={origin:{x:U,y:V},size:{width:Math.ceil(Math.abs(G-M)),height:Math.ceil(Math.abs(E-v))}},X=this.pdfiumModule.FPDFText_GetBoundedText(e,M,E,G,v,0,0),oe=2*(X+1),O=this.memoryManager.malloc(oe);this.pdfiumModule.FPDFText_GetBoundedText(e,M,E,G,v,O,X);const K=this.pdfiumModule.pdfium.UTF16ToString(O);this.memoryManager.free(O);const ue=this.pdfiumModule.FPDFText_GetCharIndexAtPos(e,M,E,2,2);let ge="",pe=$.size.height;if(ue>=0){pe=this.pdfiumModule.FPDFText_GetFontSize(e,ue);const Re=this.pdfiumModule.FPDFText_GetFontInfo(e,ue,0,0,0)+1,Ae=this.memoryManager.malloc(Re),ze=this.memoryManager.malloc(4);this.pdfiumModule.FPDFText_GetFontInfo(e,ue,Ae,Re,ze),ge=this.pdfiumModule.pdfium.UTF8ToString(Ae),this.memoryManager.free(Ae),this.memoryManager.free(ze)}const T={content:K,rect:$,font:{family:ge,size:pe}};m.push(T)}return m}getPageGeometry(r,t){const o="getPageGeometry";this.logger.perf(h,D,o,"Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(h,D,o,"End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const u=e.acquirePage(t.index),m=u.getTextPage(),d=this.pdfiumModule.FPDFText_CountChars(m),_=[];for(let b=0;b<d;b++){const p=this.readGlyphInfo(t,u.pagePtr,m,b);_.push(p)}const P=this.buildRunsFromGlyphs(_,m);return u.release(),this.logger.perf(h,D,o,"End",r.id),y.resolve({runs:P})}buildRunsFromGlyphs(r,t){const o=[];let e=null,u=null,m=null;for(let d=0;d<r.length;d++){const _=r[d],P=this.pdfiumModule.FPDFText_GetTextObject(t,d);if(P!==u&&(u=P,e={rect:{x:_.origin.x,y:_.origin.y,width:_.size.width,height:_.size.height},charStart:d,glyphs:[]},m={minX:_.origin.x,minY:_.origin.y,maxX:_.origin.x+_.size.width,maxY:_.origin.y+_.size.height},o.push(e)),e.glyphs.push({x:_.origin.x,y:_.origin.y,width:_.size.width,height:_.size.height,flags:_.isEmpty?2:_.isSpace?1:0}),_.isEmpty)continue;const b=_.origin.x+_.size.width,p=_.origin.y+_.size.height;m.minX=Math.min(m.minX,_.origin.x),m.minY=Math.min(m.minY,_.origin.y),m.maxX=Math.max(m.maxX,b),m.maxY=Math.max(m.maxY,p),e.rect.x=m.minX,e.rect.y=m.minY,e.rect.width=m.maxX-m.minX,e.rect.height=m.maxY-m.minY}return o}readGlyphInfo(r,t,o,e){const u=this.memoryManager.malloc(4),m=this.memoryManager.malloc(4),d=this.memoryManager.malloc(4),_=this.memoryManager.malloc(4),P=this.memoryManager.malloc(16);let b=0,p=0,M=0,E=0,G=!1;if(this.pdfiumModule.FPDFText_GetLooseCharBox(o,e,P)){const v=this.pdfiumModule.pdfium.getValue(P,"float"),C=this.pdfiumModule.pdfium.getValue(P+4,"float"),R=this.pdfiumModule.pdfium.getValue(P+8,"float"),U=this.pdfiumModule.pdfium.getValue(P+12,"float");if(v===R||C===U)return[P,u,m,d,_].forEach(O=>this.memoryManager.free(O)),{origin:{x:0,y:0},size:{width:0,height:0},isEmpty:!0};this.pdfiumModule.FPDF_PageToDevice(t,0,0,r.size.width,r.size.height,0,v,C,u,m),this.pdfiumModule.FPDF_PageToDevice(t,0,0,r.size.width,r.size.height,0,R,U,d,_);const V=this.pdfiumModule.pdfium.getValue(u,"i32"),$=this.pdfiumModule.pdfium.getValue(m,"i32"),X=this.pdfiumModule.pdfium.getValue(d,"i32"),oe=this.pdfiumModule.pdfium.getValue(_,"i32");b=Math.min(V,X),p=Math.min($,oe),M=Math.max(1,Math.abs(X-V)),E=Math.max(1,Math.abs(oe-$)),G=this.pdfiumModule.FPDFText_GetUnicode(o,e)===32}return[P,u,m,d,_].forEach(v=>this.memoryManager.free(v)),{origin:{x:b,y:p},size:{width:M,height:E},...G&&{isSpace:G}}}getPageGlyphs(r,t){this.logger.debug(h,D,"getPageGlyphs",r,t),this.logger.perf(h,D,"getPageGlyphs","Begin",r.id);const o=this.cache.getContext(r.id);if(!o)return this.logger.perf(h,D,"getPageGlyphs","End",r.id),y.reject({code:x.DocNotOpen,message:"document does not open"});const e=o.acquirePage(t.index),u=e.getTextPage(),m=this.pdfiumModule.FPDFText_CountChars(u),d=new Array(m);for(let _=0;_<m;_++){const P=this.readGlyphInfo(t,e.pagePtr,u,_);P.isEmpty||(d[_]={...P})}return e.release(),this.logger.perf(h,D,"getPageGlyphs","End",r.id),y.resolve(d)}readCharBox(r,t,o,e){const u=this.memoryManager.malloc(8),m=this.memoryManager.malloc(8),d=this.memoryManager.malloc(8),_=this.memoryManager.malloc(8);let P=0,b=0,p=0,M=0;if(this.pdfiumModule.FPDFText_GetCharBox(o,e,m,_,d,u)){const E=this.pdfiumModule.pdfium.getValue(u,"double"),G=this.pdfiumModule.pdfium.getValue(m,"double"),v=this.pdfiumModule.pdfium.getValue(d,"double"),C=this.pdfiumModule.pdfium.getValue(_,"double"),R=this.memoryManager.malloc(4),U=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(t,0,0,r.size.width,r.size.height,0,G,E,R,U),P=this.pdfiumModule.pdfium.getValue(R,"i32"),b=this.pdfiumModule.pdfium.getValue(U,"i32"),this.memoryManager.free(R),this.memoryManager.free(U),p=Math.ceil(Math.abs(C-G)),M=Math.ceil(Math.abs(E-v))}return this.memoryManager.free(u),this.memoryManager.free(m),this.memoryManager.free(d),this.memoryManager.free(_),{origin:{x:P,y:b},size:{width:p,height:M}}}readPageAnnotations(r,t){return r.borrowPage(t.index,o=>{const e=this.pdfiumModule.FPDFPage_GetAnnotCount(o.pagePtr),u=[];for(let m=0;m<e;m++)o.withAnnotation(m,d=>{const _=this.readPageAnnotation(r.docPtr,t,d,o);_&&u.push(_)});return u})}readPageAnnotationsRaw(r,t){const o=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(r.docPtr,t.index);if(o<=0)return[];const e=[];for(let u=0;u<o;++u){const m=this.pdfiumModule.EPDFPage_GetAnnotRaw(r.docPtr,t.index,u);if(m)try{const d=this.readPageAnnotation(r.docPtr,t,m);d&&e.push(d)}finally{this.pdfiumModule.FPDFPage_CloseAnnot(m)}}return e}getPageAnnotationsRaw(r,t){this.logger.debug(h,D,"getPageAnnotationsRaw",r,t),this.logger.perf(h,D,"GetPageAnnotationsRaw","Begin",`${r.id}-${t.index}`);const o=this.cache.getContext(r.id);if(!o)return y.reject({code:x.DocNotOpen,message:"document does not open"});const e=this.readPageAnnotationsRaw(o,t);return this.logger.perf(h,D,"GetPageAnnotationsRaw","End",`${r.id}-${t.index}`),this.logger.debug(h,D,"getPageAnnotationsRaw",`${r.id}-${t.index}`,e),y.resolve(e)}readPageAnnotation(r,t,o,e){let u=this.getAnnotString(o,"NM");u&&Jt(u)||(u=qt(),this.setAnnotString(o,"NM",u));const m=this.pdfiumModule.FPDFAnnot_GetSubtype(o);let d;switch(m){case L.TEXT:d=this.readPdfTextAnno(t,o,u);break;case L.FREETEXT:d=this.readPdfFreeTextAnno(t,o,u);break;case L.LINK:d=this.readPdfLinkAnno(t,r,o,u);break;case L.WIDGET:if(e)return this.readPdfWidgetAnno(t,o,e.getFormHandle(),u);case L.FILEATTACHMENT:d=this.readPdfFileAttachmentAnno(t,o,u);break;case L.INK:d=this.readPdfInkAnno(t,o,u);break;case L.POLYGON:d=this.readPdfPolygonAnno(t,o,u);break;case L.POLYLINE:d=this.readPdfPolylineAnno(t,o,u);break;case L.LINE:d=this.readPdfLineAnno(t,o,u);break;case L.HIGHLIGHT:d=this.readPdfHighlightAnno(t,o,u);break;case L.STAMP:d=this.readPdfStampAnno(t,o,u);break;case L.SQUARE:d=this.readPdfSquareAnno(t,o,u);break;case L.CIRCLE:d=this.readPdfCircleAnno(t,o,u);break;case L.UNDERLINE:d=this.readPdfUnderlineAnno(t,o,u);break;case L.SQUIGGLY:d=this.readPdfSquigglyAnno(t,o,u);break;case L.STRIKEOUT:d=this.readPdfStrikeOutAnno(t,o,u);break;case L.CARET:d=this.readPdfCaretAnno(t,o,u);break;default:d=this.readPdfAnno(t,m,o,u)}return d}readAnnotationColor(r,t=ae.Color){const o=this.memoryManager.malloc(4),e=this.memoryManager.malloc(4),u=this.memoryManager.malloc(4);let m;return this.pdfiumModule.EPDFAnnot_GetColor(r,t,o,e,u)&&(m={red:255&this.pdfiumModule.pdfium.getValue(o,"i32"),green:255&this.pdfiumModule.pdfium.getValue(e,"i32"),blue:255&this.pdfiumModule.pdfium.getValue(u,"i32")}),this.memoryManager.free(o),this.memoryManager.free(e),this.memoryManager.free(u),m}getAnnotationColor(r,t=ae.Color){const o=this.readAnnotationColor(r,t);return o?Qt(o):void 0}setAnnotationColor(r,t,o=ae.Color){const e=Zt(t);return this.pdfiumModule.EPDFAnnot_SetColor(r,o,255&e.red,255&e.green,255&e.blue)}getAnnotationOpacity(r){const t=this.memoryManager.malloc(4),o=this.pdfiumModule.EPDFAnnot_GetOpacity(r,t)?this.pdfiumModule.pdfium.getValue(t,"i32"):255;return this.memoryManager.free(t),pn(o)}setAnnotationOpacity(r,t){const o=Sn(t);return this.pdfiumModule.EPDFAnnot_SetOpacity(r,255&o)}getAnnotationTextAlignment(r){return this.pdfiumModule.EPDFAnnot_GetTextAlignment(r)}setAnnotationTextAlignment(r,t){return!!this.pdfiumModule.EPDFAnnot_SetTextAlignment(r,t)}getAnnotationVerticalAlignment(r){return this.pdfiumModule.EPDFAnnot_GetVerticalAlignment(r)}setAnnotationVerticalAlignment(r,t){return!!this.pdfiumModule.EPDFAnnot_SetVerticalAlignment(r,t)}getAnnotationDefaultAppearance(r){const t=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),e=this.memoryManager.malloc(4),u=this.memoryManager.malloc(4),m=this.memoryManager.malloc(4);if(!this.pdfiumModule.EPDFAnnot_GetDefaultAppearance(r,t,o,e,u,m))return void[t,o,e,u,m].forEach(E=>this.memoryManager.free(E));const d=this.pdfiumModule.pdfium,_=d.getValue(t,"i32"),P=d.getValue(o,"float"),b=255&d.getValue(e,"i32"),p=255&d.getValue(u,"i32"),M=255&d.getValue(m,"i32");return[t,o,e,u,m].forEach(E=>this.memoryManager.free(E)),{fontFamily:_,fontSize:P,fontColor:Qt({red:b,green:p,blue:M})}}setAnnotationDefaultAppearance(r,t,o,e){const{red:u,green:m,blue:d}=Zt(e);return!!this.pdfiumModule.EPDFAnnot_SetDefaultAppearance(r,t,o,255&u,255&m,255&d)}getBorderStyle(r){const t=this.memoryManager.malloc(4);let o=0,e=Te.UNKNOWN,u=!1;return e=this.pdfiumModule.EPDFAnnot_GetBorderStyle(r,t),o=this.pdfiumModule.pdfium.getValue(t,"float"),u=e!==Te.UNKNOWN,this.memoryManager.free(t),{ok:u,style:e,width:o}}setBorderStyle(r,t,o){return this.pdfiumModule.EPDFAnnot_SetBorderStyle(r,t,o)}getAnnotationIcon(r){return this.pdfiumModule.EPDFAnnot_GetIcon(r)}setAnnotationIcon(r,t){return this.pdfiumModule.EPDFAnnot_SetIcon(r,t)}getBorderEffect(r){const t=this.memoryManager.malloc(4),o=!!this.pdfiumModule.EPDFAnnot_GetBorderEffect(r,t),e=o?this.pdfiumModule.pdfium.getValue(t,"float"):0;return this.memoryManager.free(t),{ok:o,intensity:e}}getRectangleDifferences(r){const t=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),e=this.memoryManager.malloc(4),u=this.memoryManager.malloc(4),m=!!this.pdfiumModule.EPDFAnnot_GetRectangleDifferences(r,t,o,e,u),d=this.pdfiumModule.pdfium,_=d.getValue(t,"float"),P=d.getValue(o,"float"),b=d.getValue(e,"float"),p=d.getValue(u,"float");return this.memoryManager.free(t),this.memoryManager.free(o),this.memoryManager.free(e),this.memoryManager.free(u),{ok:m,left:_,top:P,right:b,bottom:p}}getAnnotationDate(r,t){const o=this.getAnnotString(r,t);return o?mt(o):void 0}setAnnotationDate(r,t,o){const e=pt(o);return this.setAnnotString(r,t,e)}getAttachmentDate(r,t){const o=this.getAttachmentString(r,t);return o?mt(o):void 0}setAttachmentDate(r,t,o){const e=pt(o);return this.setAttachmentString(r,t,e)}getBorderDashPattern(r){const t=this.pdfiumModule.EPDFAnnot_GetBorderDashPatternCount(r);if(t===0)return{ok:!1,pattern:[]};const o=this.memoryManager.malloc(4*t),e=!!this.pdfiumModule.EPDFAnnot_GetBorderDashPattern(r,o,t),u=[];if(e){const m=this.pdfiumModule.pdfium;for(let d=0;d<t;d++)u.push(m.getValue(o+4*d,"float"))}return this.memoryManager.free(o),{ok:e,pattern:u}}setBorderDashPattern(r,t){if(!t||t.length===0)return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(r,0,0);const o=t.map(d=>Number.isFinite(d)&&d>0?d:0).filter(d=>d>0);if(o.length===0)return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(r,0,0);const e=4*o.length,u=this.memoryManager.malloc(e);for(let d=0;d<o.length;d++)this.pdfiumModule.pdfium.setValue(u+4*d,o[d],"float");const m=!!this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(r,u,o.length);return this.memoryManager.free(u),m}getLineEndings(r){const t=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4);if(!this.pdfiumModule.EPDFAnnot_GetLineEndings(r,t,o))return this.memoryManager.free(t),void this.memoryManager.free(o);const e=this.pdfiumModule.pdfium.getValue(t,"i32"),u=this.pdfiumModule.pdfium.getValue(o,"i32");return this.memoryManager.free(t),this.memoryManager.free(o),{start:e,end:u}}setLineEndings(r,t,o){return!!this.pdfiumModule.EPDFAnnot_SetLineEndings(r,t,o)}getLinePoints(r,t){const o=this.memoryManager.malloc(8),e=this.memoryManager.malloc(8);if(!this.pdfiumModule.FPDFAnnot_GetLine(t,o,e))return this.memoryManager.free(o),void this.memoryManager.free(e);const u=this.pdfiumModule.pdfium,m=u.getValue(o+0,"float"),d=u.getValue(o+4,"float"),_=u.getValue(e+0,"float"),P=u.getValue(e+4,"float");return this.memoryManager.free(o),this.memoryManager.free(e),{start:this.convertPagePointToDevicePoint(r,{x:m,y:d}),end:this.convertPagePointToDevicePoint(r,{x:_,y:P})}}setLinePoints(r,t,o,e){const u=this.convertDevicePointToPagePoint(r,o),m=this.convertDevicePointToPagePoint(r,e);if(!u||!m)return!1;const d=this.memoryManager.malloc(16),_=this.pdfiumModule.pdfium;_.setValue(d+0,u.x,"float"),_.setValue(d+4,u.y,"float"),_.setValue(d+8,m.x,"float"),_.setValue(d+12,m.y,"float");const P=this.pdfiumModule.EPDFAnnot_SetLine(t,d,d+8);return this.memoryManager.free(d),!!P}getQuadPointsAnno(r,t){const o=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(t);if(o===0)return[];const e=[];for(let u=0;u<o;u++){const m=this.memoryManager.malloc(32);if(this.pdfiumModule.FPDFAnnot_GetAttachmentPoints(t,u,m)){const d=[],_=[];for(let E=0;E<4;E++){const G=m+8*E;d.push(this.pdfiumModule.pdfium.getValue(G,"float")),_.push(this.pdfiumModule.pdfium.getValue(G+4,"float"))}const P=this.convertPagePointToDevicePoint(r,{x:d[0],y:_[0]}),b=this.convertPagePointToDevicePoint(r,{x:d[1],y:_[1]}),p=this.convertPagePointToDevicePoint(r,{x:d[2],y:_[2]}),M=this.convertPagePointToDevicePoint(r,{x:d[3],y:_[3]});e.push({p1:P,p2:b,p3:p,p4:M})}this.memoryManager.free(m)}return e.map(An)}syncQuadPointsAnno(r,t,o){const e=this.pdfiumModule.pdfium,u=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(t),m=this.memoryManager.malloc(32),d=P=>{const b=en(P),p=this.convertDevicePointToPagePoint(r,b.p1),M=this.convertDevicePointToPagePoint(r,b.p2),E=this.convertDevicePointToPagePoint(r,b.p3),G=this.convertDevicePointToPagePoint(r,b.p4);e.setValue(m+0,p.x,"float"),e.setValue(m+4,p.y,"float"),e.setValue(m+8,M.x,"float"),e.setValue(m+12,M.y,"float"),e.setValue(m+16,G.x,"float"),e.setValue(m+20,G.y,"float"),e.setValue(m+24,E.x,"float"),e.setValue(m+28,E.y,"float")},_=Math.min(u,o.length);for(let P=0;P<_;P++)if(d(o[P]),!this.pdfiumModule.FPDFAnnot_SetAttachmentPoints(t,P,m))return this.memoryManager.free(m),!1;for(let P=u;P<o.length;P++)if(d(o[P]),!this.pdfiumModule.FPDFAnnot_AppendAttachmentPoints(t,m))return this.memoryManager.free(m),!1;return this.memoryManager.free(m),!0}redactTextInRects(r,t,o,e){const{recurseForms:u=!0,drawBlackBoxes:m=!1}=e??{};this.logger.debug("PDFiumEngine","Engine","redactTextInQuads",r.id,t.index,o.length);const d="RedactTextInQuads";this.logger.perf("PDFiumEngine","Engine",d,"Begin",`${r.id}-${t.index}`);const _=this.cache.getContext(r.id);if(!_)return this.logger.perf("PDFiumEngine","Engine",d,"End",`${r.id}-${t.index}`),y.reject({code:x.DocNotOpen,message:"document does not open"});const P=(o??[]).filter(G=>{var v,C,R,U;return G&&Number.isFinite((v=G.origin)==null?void 0:v.x)&&Number.isFinite((C=G.origin)==null?void 0:C.y)&&Number.isFinite((R=G.size)==null?void 0:R.width)&&Number.isFinite((U=G.size)==null?void 0:U.height)&&G.size.width>0&&G.size.height>0});if(P.length===0)return this.logger.perf("PDFiumEngine","Engine",d,"End",`${r.id}-${t.index}`),y.resolve(!1);const b=_.acquirePage(t.index),{ptr:p,count:M}=this.allocFSQuadsBufferFromRects(t,P);let E=!1;try{E=!!this.pdfiumModule.EPDFText_RedactInQuads(b.pagePtr,p,M,!!u,!!m)}finally{this.memoryManager.free(p)}return E&&(E=!!this.pdfiumModule.FPDFPage_GenerateContent(b.pagePtr)),b.disposeImmediate(),this.logger.perf("PDFiumEngine","Engine",d,"End",`${r.id}-${t.index}`),y.resolve(!!E)}allocFSQuadsBufferFromRects(r,t){const o=t.length,e=this.memoryManager.malloc(32*o),u=this.pdfiumModule.pdfium;for(let m=0;m<o;m++){const d=t[m],_=en(d),P=this.convertDevicePointToPagePoint(r,_.p1),b=this.convertDevicePointToPagePoint(r,_.p2),p=this.convertDevicePointToPagePoint(r,_.p3),M=this.convertDevicePointToPagePoint(r,_.p4),E=e+32*m;u.setValue(E+0,P.x,"float"),u.setValue(E+4,P.y,"float"),u.setValue(E+8,b.x,"float"),u.setValue(E+12,b.y,"float"),u.setValue(E+16,M.x,"float"),u.setValue(E+20,M.y,"float"),u.setValue(E+24,p.x,"float"),u.setValue(E+28,p.y,"float")}return{ptr:e,count:o}}getInkList(r,t){const o=[],e=this.pdfiumModule.FPDFAnnot_GetInkListCount(t);if(e<=0)return o;const u=this.pdfiumModule.pdfium;for(let m=0;m<e;m++){const d=[],_=this.pdfiumModule.FPDFAnnot_GetInkListPath(t,m,0,0);if(_>0){const P=this.memoryManager.malloc(8*_);this.pdfiumModule.FPDFAnnot_GetInkListPath(t,m,P,_);for(let b=0;b<_;b++){const p=P+8*b,M=u.getValue(p+0,"float"),E=u.getValue(p+4,"float"),G=this.convertPagePointToDevicePoint(r,{x:M,y:E});d.push({x:G.x,y:G.y})}this.memoryManager.free(P)}o.push({points:d})}return o}setInkList(r,t,o){const e=this.pdfiumModule.pdfium;for(const u of o){const m=u.points.length;if(m===0)continue;const d=this.memoryManager.malloc(8*m);for(let P=0;P<m;P++){const b=u.points[P],p=this.convertDevicePointToPagePoint(r,b);e.setValue(d+8*P+0,p.x,"float"),e.setValue(d+8*P+4,p.y,"float")}const _=this.pdfiumModule.FPDFAnnot_AddInkStroke(t,d,m);if(this.memoryManager.free(d),_===-1)return!1}return!0}readPdfTextAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.getAnnotString(t,"Contents")||"",p=this.getAnnotString(t,"State"),M=this.getAnnotString(t,"StateModel"),E=this.getAnnotationColor(t),G=this.getAnnotationOpacity(t),v=this.getInReplyToId(t),C=this.getAnnotationFlags(t),R=this.getAnnotationIcon(t);return{pageIndex:r.index,custom:e,id:o,type:L.TEXT,flags:C,contents:b,color:E??"#FFFF00",opacity:G,rect:m,inReplyToId:v,author:d,modified:_,created:P,state:p,stateModel:M,icon:R}}readPdfFreeTextAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"Contents")||"",_=this.getAnnotString(t,"T"),P=this.getAnnotationDate(t,"M"),b=this.getAnnotationDate(t,"CreationDate"),p=this.getAnnotString(t,"DS"),M=this.getAnnotationDefaultAppearance(t),E=this.getAnnotationColor(t),G=this.getAnnotationTextAlignment(t),v=this.getAnnotationVerticalAlignment(t),C=this.getAnnotationOpacity(t),R=this.getAnnotRichContent(t),U=this.getAnnotationFlags(t);return{pageIndex:r.index,custom:e,id:o,type:L.FREETEXT,fontFamily:M?.fontFamily??En.Unknown,fontSize:M?.fontSize??12,fontColor:M?.fontColor??"#000000",verticalAlign:v,backgroundColor:E,flags:U,opacity:C,textAlign:G,defaultStyle:p,richContent:R,contents:d,author:_,modified:P,created:b,rect:m}}readPdfLinkAnno(r,t,o,e){const u=this.getAnnotCustom(o),m=this.pdfiumModule.FPDFAnnot_GetLink(o);if(!m)return;const d=this.readPageAnnoRect(o),_=this.convertPageRectToDeviceRect(r,d),P=this.getAnnotString(o,"T"),b=this.getAnnotationDate(o,"M"),p=this.getAnnotationDate(o,"CreationDate"),M=this.getAnnotationFlags(o),E=this.readPdfLinkAnnoTarget(t,()=>this.pdfiumModule.FPDFLink_GetAction(m),()=>this.pdfiumModule.FPDFLink_GetDest(t,m));return{pageIndex:r.index,custom:u,id:e,type:L.LINK,flags:M,target:E,rect:_,author:P,modified:b,created:p}}readPdfWidgetAnno(r,t,o,e){const u=this.getAnnotCustom(t),m=this.readPageAnnoRect(t),d=this.convertPageRectToDeviceRect(r,m),_=this.getAnnotString(t,"T"),P=this.getAnnotationDate(t,"M"),b=this.getAnnotationDate(t,"CreationDate"),p=this.getAnnotationFlags(t),M=this.readPdfWidgetAnnoField(o,t);return{pageIndex:r.index,custom:u,id:e,type:L.WIDGET,flags:p,rect:d,field:M,author:_,modified:P,created:b}}readPdfFileAttachmentAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.getAnnotationFlags(t);return{pageIndex:r.index,custom:e,id:o,type:L.FILEATTACHMENT,flags:b,rect:m,author:d,modified:_,created:P}}readPdfInkAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.getAnnotationColor(t),p=this.getAnnotationOpacity(t),{width:M}=this.getBorderStyle(t),E=this.getInkList(r,t),G=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),v=this.getAnnotIntent(t),C=this.getAnnotationFlags(t),R=this.getAnnotString(t,"Contents")||"";return{pageIndex:r.index,custom:e,id:o,type:L.INK,...v&&{intent:v},contents:R,blendMode:G,flags:C,color:b??"#FF0000",opacity:p,strokeWidth:M===0?1:M,rect:m,inkList:E,author:d,modified:_,created:P}}readPdfPolygonAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.readPdfAnnoVertices(r,t),p=this.getAnnotString(t,"Contents")||"",M=this.getAnnotationFlags(t),E=this.getAnnotationColor(t),G=this.getAnnotationColor(t,ae.InteriorColor),v=this.getAnnotationOpacity(t);let C,{style:R,width:U}=this.getBorderStyle(t);if(R===Te.DASHED){const{ok:V,pattern:$}=this.getBorderDashPattern(t);V&&(C=$)}if(b.length>1){const V=b[0],$=b[b.length-1];V.x===$.x&&V.y===$.y&&b.pop()}return{pageIndex:r.index,custom:e,id:o,type:L.POLYGON,contents:p,flags:M,strokeColor:E??"#FF0000",color:G??"transparent",opacity:v,strokeWidth:U===0?1:U,strokeStyle:R,strokeDashArray:C,rect:m,vertices:b,author:d,modified:_,created:P}}readPdfPolylineAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.readPdfAnnoVertices(r,t),p=this.getAnnotString(t,"Contents")||"",M=this.getAnnotationColor(t),E=this.getAnnotationFlags(t),G=this.getAnnotationColor(t,ae.InteriorColor),v=this.getAnnotationOpacity(t);let C,{style:R,width:U}=this.getBorderStyle(t);if(R===Te.DASHED){const{ok:$,pattern:X}=this.getBorderDashPattern(t);$&&(C=X)}const V=this.getLineEndings(t);return{pageIndex:r.index,custom:e,id:o,type:L.POLYLINE,contents:p,flags:E,strokeColor:M??"#FF0000",color:G??"transparent",opacity:v,strokeWidth:U===0?1:U,strokeStyle:R,strokeDashArray:C,lineEndings:V,rect:m,vertices:b,author:d,modified:_,created:P}}readPdfLineAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.getLinePoints(r,t),p=this.getLineEndings(t),M=this.getAnnotString(t,"Contents")||"",E=this.getAnnotationColor(t),G=this.getAnnotationFlags(t),v=this.getAnnotationColor(t,ae.InteriorColor),C=this.getAnnotationOpacity(t);let R,{style:U,width:V}=this.getBorderStyle(t);if(U===Te.DASHED){const{ok:$,pattern:X}=this.getBorderDashPattern(t);$&&(R=X)}return{pageIndex:r.index,custom:e,id:o,type:L.LINE,flags:G,rect:m,contents:M,strokeWidth:V===0?1:V,strokeStyle:U,strokeDashArray:R,strokeColor:E??"#FF0000",color:v??"transparent",opacity:C,linePoints:b||{start:{x:0,y:0},end:{x:0,y:0}},lineEndings:p||{start:Xe.None,end:Xe.None},author:d,modified:_,created:P}}readPdfHighlightAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getQuadPointsAnno(r,t),_=this.getAnnotationColor(t),P=this.getAnnotationOpacity(t),b=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),p=this.getAnnotString(t,"T"),M=this.getAnnotationDate(t,"M"),E=this.getAnnotationDate(t,"CreationDate"),G=this.getAnnotString(t,"Contents")||"",v=this.getAnnotationFlags(t);return{pageIndex:r.index,custom:e,id:o,blendMode:b,type:L.HIGHLIGHT,rect:m,flags:v,contents:G,segmentRects:d,color:_??"#FFFF00",opacity:P,author:p,modified:M,created:E}}readPdfUnderlineAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.getQuadPointsAnno(r,t),p=this.getAnnotString(t,"Contents")||"",M=this.getAnnotationColor(t),E=this.getAnnotationOpacity(t),G=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),v=this.getAnnotationFlags(t);return{pageIndex:r.index,custom:e,id:o,blendMode:G,type:L.UNDERLINE,rect:m,flags:v,contents:p,segmentRects:b,color:M??"#FF0000",opacity:E,author:d,modified:_,created:P}}readPdfStrikeOutAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.getQuadPointsAnno(r,t),p=this.getAnnotString(t,"Contents")||"",M=this.getAnnotationColor(t),E=this.getAnnotationOpacity(t),G=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),v=this.getAnnotationFlags(t);return{pageIndex:r.index,custom:e,id:o,blendMode:G,type:L.STRIKEOUT,flags:v,rect:m,contents:p,segmentRects:b,color:M??"#FF0000",opacity:E,author:d,modified:_,created:P}}readPdfSquigglyAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.getQuadPointsAnno(r,t),p=this.getAnnotString(t,"Contents")||"",M=this.getAnnotationColor(t),E=this.getAnnotationOpacity(t),G=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),v=this.getAnnotationFlags(t);return{pageIndex:r.index,custom:e,id:o,blendMode:G,type:L.SQUIGGLY,rect:m,flags:v,contents:p,segmentRects:b,color:M??"#FF0000",opacity:E,author:d,modified:_,created:P}}readPdfCaretAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.getAnnotationFlags(t);return{pageIndex:r.index,custom:e,id:o,type:L.CARET,rect:m,flags:b,author:d,modified:_,created:P}}readPdfStampAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.readPageAnnoRect(t),m=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(t,"T"),_=this.getAnnotationDate(t,"M"),P=this.getAnnotationDate(t,"CreationDate"),b=this.getAnnotationFlags(t),p=this.getAnnotString(t,"Contents")||"";return{pageIndex:r.index,custom:e,id:o,type:L.STAMP,contents:p,rect:m,author:d,modified:_,created:P,flags:b}}readPdfPageObject(r){switch(this.pdfiumModule.FPDFPageObj_GetType(r)){case Ye.PATH:return this.readPathObject(r);case Ye.IMAGE:return this.readImageObject(r);case Ye.FORM:return this.readFormObject(r)}}readPathObject(r){const t=this.pdfiumModule.FPDFPath_CountSegments(r),o=this.memoryManager.malloc(4),e=this.memoryManager.malloc(4),u=this.memoryManager.malloc(4),m=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPageObj_GetBounds(r,o,e,u,m);const d={left:this.pdfiumModule.pdfium.getValue(o,"float"),bottom:this.pdfiumModule.pdfium.getValue(e,"float"),right:this.pdfiumModule.pdfium.getValue(u,"float"),top:this.pdfiumModule.pdfium.getValue(m,"float")};this.memoryManager.free(o),this.memoryManager.free(e),this.memoryManager.free(u),this.memoryManager.free(m);const _=[];for(let b=0;b<t;b++){const p=this.readPdfSegment(r,b);_.push(p)}const P=this.readPdfPageObjectTransformMatrix(r);return{type:Ye.PATH,bounds:d,segments:_,matrix:P}}readPdfSegment(r,t){const o=this.pdfiumModule.FPDFPath_GetPathSegment(r,t),e=this.pdfiumModule.FPDFPathSegment_GetType(o),u=this.pdfiumModule.FPDFPathSegment_GetClose(o),m=this.memoryManager.malloc(4),d=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPathSegment_GetPoint(o,m,d);const _=this.pdfiumModule.pdfium.getValue(m,"float"),P=this.pdfiumModule.pdfium.getValue(d,"float");return this.memoryManager.free(m),this.memoryManager.free(d),{type:e,point:{x:_,y:P},isClosed:u}}readImageObject(r){const t=this.pdfiumModule.FPDFImageObj_GetBitmap(r),o=this.pdfiumModule.FPDFBitmap_GetBuffer(t),e=this.pdfiumModule.FPDFBitmap_GetWidth(t),u=this.pdfiumModule.FPDFBitmap_GetHeight(t),m=this.pdfiumModule.FPDFBitmap_GetFormat(t),d=e*u,_=new Uint8ClampedArray(4*d);for(let p=0;p<d;p++)if(m===2){const M=this.pdfiumModule.pdfium.getValue(o+3*p,"i8"),E=this.pdfiumModule.pdfium.getValue(o+3*p+1,"i8"),G=this.pdfiumModule.pdfium.getValue(o+3*p+2,"i8");_[4*p]=G,_[4*p+1]=E,_[4*p+2]=M,_[4*p+3]=100}const P={data:_,width:e,height:u},b=this.readPdfPageObjectTransformMatrix(r);return{type:Ye.IMAGE,imageData:P,matrix:b}}readFormObject(r){const t=this.pdfiumModule.FPDFFormObj_CountObjects(r),o=[];for(let u=0;u<t;u++){const m=this.pdfiumModule.FPDFFormObj_GetObject(r,u),d=this.readPdfPageObject(m);d&&o.push(d)}const e=this.readPdfPageObjectTransformMatrix(r);return{type:Ye.FORM,objects:o,matrix:e}}readPdfPageObjectTransformMatrix(r){const t=this.memoryManager.malloc(24);if(this.pdfiumModule.FPDFPageObj_GetMatrix(r,t)){const o=this.pdfiumModule.pdfium.getValue(t,"float"),e=this.pdfiumModule.pdfium.getValue(t+4,"float"),u=this.pdfiumModule.pdfium.getValue(t+8,"float"),m=this.pdfiumModule.pdfium.getValue(t+12,"float"),d=this.pdfiumModule.pdfium.getValue(t+16,"float"),_=this.pdfiumModule.pdfium.getValue(t+20,"float");return this.memoryManager.free(t),{a:o,b:e,c:u,d:m,e:d,f:_}}return this.memoryManager.free(t),{a:1,b:0,c:0,d:1,e:0,f:0}}readStampAnnotationContents(r){const t=[],o=this.pdfiumModule.FPDFAnnot_GetObjectCount(r);for(let e=0;e<o;e++){const u=this.pdfiumModule.FPDFAnnot_GetObject(r,e),m=this.readPdfPageObject(u);m&&t.push(m)}return t}getStrokeWidth(r){const t=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),e=this.memoryManager.malloc(4),u=this.pdfiumModule.FPDFAnnot_GetBorder(r,t,o,e)?this.pdfiumModule.pdfium.getValue(e,"float"):1;return this.memoryManager.free(t),this.memoryManager.free(o),this.memoryManager.free(e),u}getAnnotationFlags(r){const t=this.pdfiumModule.FPDFAnnot_GetFlags(r);return Mn(t)}setAnnotationFlags(r,t){const o=yn(t);return this.pdfiumModule.FPDFAnnot_SetFlags(r,o)}readPdfCircleAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.getAnnotationFlags(t),m=this.readPageAnnoRect(t),d=this.convertPageRectToDeviceRect(r,m),_=this.getAnnotString(t,"T"),P=this.getAnnotationDate(t,"M"),b=this.getAnnotationDate(t,"CreationDate"),p=this.getAnnotString(t,"Contents")||"",M=this.getAnnotationColor(t,ae.InteriorColor),E=this.getAnnotationColor(t),G=this.getAnnotationOpacity(t);let v,{style:C,width:R}=this.getBorderStyle(t);if(C===Te.DASHED){const{ok:U,pattern:V}=this.getBorderDashPattern(t);U&&(v=V)}return{pageIndex:r.index,custom:e,id:o,type:L.CIRCLE,flags:u,color:M??"transparent",opacity:G,contents:p,strokeWidth:R,strokeColor:E??"#FF0000",strokeStyle:C,rect:d,author:_,modified:P,created:b,...v!==void 0&&{strokeDashArray:v}}}readPdfSquareAnno(r,t,o){const e=this.getAnnotCustom(t),u=this.getAnnotationFlags(t),m=this.readPageAnnoRect(t),d=this.convertPageRectToDeviceRect(r,m),_=this.getAnnotString(t,"T"),P=this.getAnnotationDate(t,"M"),b=this.getAnnotationDate(t,"CreationDate"),p=this.getAnnotString(t,"Contents")||"",M=this.getAnnotationColor(t,ae.InteriorColor),E=this.getAnnotationColor(t),G=this.getAnnotationOpacity(t);let v,{style:C,width:R}=this.getBorderStyle(t);if(C===Te.DASHED){const{ok:U,pattern:V}=this.getBorderDashPattern(t);U&&(v=V)}return{pageIndex:r.index,custom:e,id:o,type:L.SQUARE,flags:u,color:M??"transparent",opacity:G,contents:p,strokeColor:E??"#FF0000",strokeWidth:R,strokeStyle:C,rect:d,author:_,modified:P,created:b,...v!==void 0&&{strokeDashArray:v}}}readPdfAnno(r,t,o,e){const u=this.getAnnotCustom(o),m=this.readPageAnnoRect(o),d=this.convertPageRectToDeviceRect(r,m),_=this.getAnnotString(o,"T"),P=this.getAnnotationDate(o,"M"),b=this.getAnnotationDate(o,"CreationDate"),p=this.getAnnotationFlags(o);return{pageIndex:r.index,custom:u,id:e,flags:p,type:t,rect:d,author:_,modified:P,created:b}}getInReplyToId(r){const t=this.pdfiumModule.FPDFAnnot_GetLinkedAnnot(r,"IRT");if(t)return this.getAnnotString(t,"NM")}setInReplyToId(r,t,o){const e=this.getAnnotationByName(r,o);return!!e&&this.pdfiumModule.EPDFAnnot_SetLinkedAnnot(t,"IRT",e)}getAnnotString(r,t){const o=this.pdfiumModule.FPDFAnnot_GetStringValue(r,t,0,0);if(o===0)return;const e=2*(o+1),u=this.memoryManager.malloc(e);this.pdfiumModule.FPDFAnnot_GetStringValue(r,t,u,e);const m=this.pdfiumModule.pdfium.UTF16ToString(u);return this.memoryManager.free(u),m||void 0}getAttachmentString(r,t){const o=this.pdfiumModule.FPDFAttachment_GetStringValue(r,t,0,0);if(o===0)return;const e=2*(o+1),u=this.memoryManager.malloc(e);this.pdfiumModule.FPDFAttachment_GetStringValue(r,t,u,e);const m=this.pdfiumModule.pdfium.UTF16ToString(u);return this.memoryManager.free(u),m||void 0}getAttachmentNumber(r,t){const o=this.memoryManager.malloc(4);try{return this.pdfiumModule.EPDFAttachment_GetIntegerValue(r,t,o)?this.pdfiumModule.pdfium.getValue(o,"i32")>>>0:void 0}finally{this.memoryManager.free(o)}}getAnnotCustom(r){const t=this.getAnnotString(r,"EPDFCustom");if(t)try{return JSON.parse(t)}catch(o){return console.warn("Failed to parse annotation custom data as JSON:",o),void console.warn("Invalid JSON string:",t)}}setAnnotCustom(r,t){if(t==null)return this.setAnnotString(r,"EPDFCustom","");try{const o=JSON.stringify(t);return this.setAnnotString(r,"EPDFCustom",o)}catch(o){return console.warn("Failed to stringify annotation custom data as JSON:",o),console.warn("Invalid data object:",t),!1}}getAnnotIntent(r){const t=this.pdfiumModule.EPDFAnnot_GetIntent(r,0,0);if(t===0)return;const o=2*(t+1),e=this.memoryManager.malloc(o);this.pdfiumModule.EPDFAnnot_GetIntent(r,e,o);const u=this.pdfiumModule.pdfium.UTF16ToString(e);return this.memoryManager.free(e),u&&u!=="undefined"?u:void 0}setAnnotIntent(r,t){return this.pdfiumModule.EPDFAnnot_SetIntent(r,t)}getAnnotRichContent(r){const t=this.pdfiumModule.EPDFAnnot_GetRichContent(r,0,0);if(t===0)return;const o=2*(t+1),e=this.memoryManager.malloc(o);this.pdfiumModule.EPDFAnnot_GetRichContent(r,e,o);const u=this.pdfiumModule.pdfium.UTF16ToString(e);return this.memoryManager.free(e),u||void 0}getAnnotationByName(r,t){return this.withWString(t,o=>this.pdfiumModule.EPDFPage_GetAnnotByName(r,o))}removeAnnotationByName(r,t){return this.withWString(t,o=>this.pdfiumModule.EPDFPage_RemoveAnnotByName(r,o))}setAnnotString(r,t,o){return this.withWString(o,e=>this.pdfiumModule.FPDFAnnot_SetStringValue(r,t,e))}setAttachmentString(r,t,o){return this.withWString(o,e=>this.pdfiumModule.FPDFAttachment_SetStringValue(r,t,e))}readPdfAnnoVertices(r,t){const o=[],e=this.pdfiumModule.FPDFAnnot_GetVertices(t,0,0),u=this.memoryManager.malloc(8*e);this.pdfiumModule.FPDFAnnot_GetVertices(t,u,e);for(let m=0;m<e;m++){const d=this.pdfiumModule.pdfium.getValue(u+8*m,"float"),_=this.pdfiumModule.pdfium.getValue(u+8*m+4,"float"),{x:P,y:b}=this.convertPagePointToDevicePoint(r,{x:d,y:_}),p=o[o.length-1];p&&p.x===P&&p.y===b||o.push({x:P,y:b})}return this.memoryManager.free(u),o}setPdfAnnoVertices(r,t,o){const e=this.pdfiumModule.pdfium,u=this.memoryManager.malloc(8*o.length);o.forEach((d,_)=>{const P=this.convertDevicePointToPagePoint(r,d);e.setValue(u+8*_+0,P.x,"float"),e.setValue(u+8*_+4,P.y,"float")});const m=this.pdfiumModule.EPDFAnnot_SetVertices(t,u,o.length);return this.memoryManager.free(u),m}readPdfBookmarkTarget(r,t,o){const e=t();if(e)return{type:"action",action:this.readPdfAction(r,e)};{const u=o();if(u)return{type:"destination",destination:this.readPdfDestination(r,u)}}}readPdfWidgetAnnoField(r,t){const o=this.pdfiumModule.FPDFAnnot_GetFormFieldFlags(r,t),e=this.pdfiumModule.FPDFAnnot_GetFormFieldType(r,t),u=se(this.pdfiumModule.pdfium,(b,p)=>this.pdfiumModule.FPDFAnnot_GetFormFieldName(r,t,b,p),this.pdfiumModule.pdfium.UTF16ToString),m=se(this.pdfiumModule.pdfium,(b,p)=>this.pdfiumModule.FPDFAnnot_GetFormFieldAlternateName(r,t,b,p),this.pdfiumModule.pdfium.UTF16ToString),d=se(this.pdfiumModule.pdfium,(b,p)=>this.pdfiumModule.FPDFAnnot_GetFormFieldValue(r,t,b,p),this.pdfiumModule.pdfium.UTF16ToString),_=[];if(e===Ft.COMBOBOX||e===Ft.LISTBOX){const b=this.pdfiumModule.FPDFAnnot_GetOptionCount(r,t);for(let p=0;p<b;p++){const M=se(this.pdfiumModule.pdfium,(G,v)=>this.pdfiumModule.FPDFAnnot_GetOptionLabel(r,t,p,G,v),this.pdfiumModule.pdfium.UTF16ToString),E=this.pdfiumModule.FPDFAnnot_IsOptionSelected(r,t,p);_.push({label:M,isSelected:E})}}let P=!1;return e!==Ft.CHECKBOX&&e!==Ft.RADIOBUTTON||(P=this.pdfiumModule.FPDFAnnot_IsChecked(r,t)),{flag:o,type:e,name:u,alternateName:m,value:d,isChecked:P,options:_}}renderPageAnnotationRaw(r,t,o,e){const{scaleFactor:u=1,rotation:m=qe.Degree0,dpr:d=1,mode:_=Je.Normal}=e??{};this.logger.debug(h,D,"renderPageAnnotation",r,t,o,e),this.logger.perf(h,D,"RenderPageAnnotation","Begin",`${r.id}-${t.index}-${o.id}`);const P=new lt,b=this.cache.getContext(r.id);if(!b)return this.logger.perf(h,D,"RenderPageAnnotation","End",`${r.id}-${t.index}-${o.id}`),y.reject({code:x.DocNotOpen,message:"document does not open"});const p=b.acquirePage(t.index),M=this.getAnnotationByName(p.pagePtr,o.id);if(!M)return this.logger.perf(h,D,"RenderPageAnnotation","End",`${r.id}-${t.index}-${o.id}`),p.release(),y.reject({code:x.NotFound,message:"annotation not found"});const E=Math.max(.01,u*d),G=tn(o.rect),v=tn(Gn(t.size,G,m,E)),C=Math.max(1,v.size.width),R=Math.max(1,v.size.height),U=4*C,V=U*R,$=this.memoryManager.malloc(V),X=this.pdfiumModule.FPDFBitmap_CreateEx(C,R,4,$,U);this.pdfiumModule.FPDFBitmap_FillRect(X,0,0,C,R,0);const oe=nn(G,m,C,R),O=this.memoryManager.malloc(24);new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,O,6).set([oe.a,oe.b,oe.c,oe.d,oe.e,oe.f]);let K=!1;try{K=!!this.pdfiumModule.EPDF_RenderAnnotBitmap(X,p.pagePtr,M,_,O,16)}finally{this.memoryManager.free(O),this.pdfiumModule.FPDFBitmap_Destroy(X),this.pdfiumModule.FPDFPage_CloseAnnot(M),p.release()}if(!K)return this.memoryManager.free($),this.logger.perf(h,D,"RenderPageAnnotation","End",`${r.id}-${t.index}-${o.id}`),y.reject({code:x.Unknown,message:"EPDF_RenderAnnotBitmap failed"});const ue=this.pdfiumModule.pdfium.HEAPU8.subarray($,$+V),ge={data:new Uint8ClampedArray(ue),width:C,height:R};return P.resolve(ge),this.memoryManager.free($),P}renderRectEncoded(r,t,o,e){const u=new lt,m=e?.rotation??qe.Degree0,d=this.cache.getContext(r.id);if(!d)return y.reject({code:x.DocNotOpen,message:"document does not open"});const _=Math.max(.01,e?.scaleFactor??1)*Math.max(1,e?.dpr??1),P=o.size.width,b=o.size.height,p=!(1&~m),M=Math.max(1,Math.round((p?b:P)*_)),E=Math.max(1,Math.round((p?P:b)*_)),G=4*M,v=G*E,C=d.acquirePage(t.index),R=e?.withForms??!1?C.getFormHandle():void 0,U=this.memoryManager.malloc(v),V=this.pdfiumModule.FPDFBitmap_CreateEx(M,E,4,U,G);this.pdfiumModule.FPDFBitmap_FillRect(V,0,0,M,E,4294967295);const $=nn(o,m,M,E),X=this.memoryManager.malloc(24);new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,X,6).set([$.a,$.b,$.c,$.d,$.e,$.f]);const oe=this.memoryManager.malloc(16);new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,oe,4).set([0,0,M,E]);let O=16;e?.withAnnotations&&(O|=1);try{if(this.pdfiumModule.FPDF_RenderPageBitmapWithMatrix(V,C.pagePtr,X,oe,O),R!==void 0){const ge=(function(Ie,Ee,rt,ot){const de=Ee.origin.x,_e=Ee.origin.y,xe=de+Ee.size.width,Me=_e+Ee.size.height,je=rt.width,ve=rt.height,me=Math.hypot(Ie.a,Ie.b),z=Math.hypot(Ie.c,Ie.d),Oe=!(1&~ot),N=Oe?Math.max(1,Math.round(ve*me)):Math.max(1,Math.round(je*me)),Z=Oe?Math.max(1,Math.round(je*z)):Math.max(1,Math.round(ve*z));let ye,Ge;switch(ot){case qe.Degree0:ye=-Math.round(de*me),Ge=-Math.round(_e*z);break;case qe.Degree90:ye=Math.round((Me-ve)*me),Ge=-Math.round(de*z);break;case qe.Degree180:ye=Math.round((xe-je)*me),Ge=Math.round((Me-ve)*z);break;case qe.Degree270:ye=-Math.round(_e*me),Ge=Math.round((xe-je)*z);break;default:ye=-Math.round(de*me),Ge=-Math.round(_e*z)}return{startX:ye,startY:Ge,formsWidth:N,formsHeight:Z,scaleX:me,scaleY:z}})($,o,t.size,m),{startX:pe,startY:T,formsWidth:Re,formsHeight:Ae,scaleX:ze,scaleY:dt}=ge;this.pdfiumModule.FPDF_FFLDraw(R,V,C.pagePtr,pe,T,Re,Ae,m,O)}}finally{C.release(),this.memoryManager.free(X),this.memoryManager.free(oe)}this.logger.perf(h,D,"RenderRectEncodedData","Begin",`${r.id}-${t.index}`);const K=this.pdfiumModule.pdfium.HEAPU8.subarray(U,U+v);this.logger.perf(h,D,"RenderRectEncodedData","End",`${r.id}-${t.index}`),this.logger.perf(h,D,"RenderRectEncodedImageData","Begin",`${r.id}-${t.index}`);const ue={data:new Uint8ClampedArray(K),width:M,height:E};return this.logger.perf(h,D,"RenderRectEncodedImageData","End",`${r.id}-${t.index}`),u.resolve(ue),this.pdfiumModule.FPDFBitmap_Destroy(V),this.memoryManager.free(U),u}readPdfLinkAnnoTarget(r,t,o){const e=o();if(e)return{type:"destination",destination:this.readPdfDestination(r,e)};{const u=t();if(u)return{type:"action",action:this.readPdfAction(r,u)}}}createLocalDestPtr(r,t){var o,e;const u=this.pdfiumModule.FPDF_LoadPage(r,t.pageIndex);if(!u)return 0;try{if(t.zoom.mode===Pe.XYZ){const{x:_,y:P,zoom:b}=t.zoom.params;return this.pdfiumModule.EPDFDest_CreateXYZ(u,!0,_,!0,P,!0,b)}let m,d=[];switch(t.zoom.mode){case Pe.FitPage:m=Pe.FitPage;break;case Pe.FitHorizontal:m=Pe.FitHorizontal,d=[((o=t.view)==null?void 0:o[0])??0];break;case Pe.FitVertical:m=Pe.FitVertical,d=[((e=t.view)==null?void 0:e[0])??0];break;case Pe.FitRectangle:{const _=t.view??[];d=[_[0]??0,_[1]??0,_[2]??0,_[3]??0],m=Pe.FitRectangle}break;case Pe.Unknown:default:return 0}return this.withFloatArray(d,(_,P)=>this.pdfiumModule.EPDFDest_CreateView(u,m,_,P))}finally{this.pdfiumModule.FPDF_ClosePage(u)}}applyBookmarkTarget(r,t,o){if(o.type==="destination"){const u=this.createLocalDestPtr(r,o.destination);return u?!!this.pdfiumModule.EPDFBookmark_SetDest(r,t,u):!1}const e=o.action;switch(e.type){case ie.Goto:{const u=this.createLocalDestPtr(r,e.destination);if(!u)return!1;const m=this.pdfiumModule.EPDFAction_CreateGoTo(r,u);return!!m&&!!this.pdfiumModule.EPDFBookmark_SetAction(r,t,m)}case ie.URI:{const u=this.pdfiumModule.EPDFAction_CreateURI(r,e.uri);return!!u&&!!this.pdfiumModule.EPDFBookmark_SetAction(r,t,u)}case ie.LaunchAppOrOpenFile:{const u=this.withWString(e.path,m=>this.pdfiumModule.EPDFAction_CreateLaunch(r,m));return!!u&&!!this.pdfiumModule.EPDFBookmark_SetAction(r,t,u)}case ie.RemoteGoto:case ie.Unsupported:default:return!1}}readPdfAction(r,t){let o;switch(this.pdfiumModule.FPDFAction_GetType(t)){case ie.Unsupported:o={type:ie.Unsupported};break;case ie.Goto:{const e=this.pdfiumModule.FPDFAction_GetDest(r,t);if(e){const u=this.readPdfDestination(r,e);o={type:ie.Goto,destination:u}}else o={type:ie.Unsupported}}break;case ie.RemoteGoto:o={type:ie.Unsupported};break;case ie.URI:{const e=se(this.pdfiumModule.pdfium,(u,m)=>this.pdfiumModule.FPDFAction_GetURIPath(r,t,u,m),this.pdfiumModule.pdfium.UTF8ToString);o={type:ie.URI,uri:e}}break;case ie.LaunchAppOrOpenFile:{const e=se(this.pdfiumModule.pdfium,(u,m)=>this.pdfiumModule.FPDFAction_GetFilePath(t,u,m),this.pdfiumModule.pdfium.UTF8ToString);o={type:ie.LaunchAppOrOpenFile,path:e}}}return o}readPdfDestination(r,t){const o=this.pdfiumModule.FPDFDest_GetDestPageIndex(r,t),e=this.memoryManager.malloc(4),u=this.memoryManager.malloc(16),m=this.pdfiumModule.FPDFDest_GetView(t,e,u),d=this.pdfiumModule.pdfium.getValue(e,"i32"),_=[];for(let P=0;P<d;P++){const b=u+4*P;_.push(this.pdfiumModule.pdfium.getValue(b,"float"))}if(this.memoryManager.free(e),this.memoryManager.free(u),m===Pe.XYZ){const P=this.memoryManager.malloc(1),b=this.memoryManager.malloc(1),p=this.memoryManager.malloc(1),M=this.memoryManager.malloc(4),E=this.memoryManager.malloc(4),G=this.memoryManager.malloc(4);if(this.pdfiumModule.FPDFDest_GetLocationInPage(t,P,b,p,M,E,G)){const v=this.pdfiumModule.pdfium.getValue(P,"i8"),C=this.pdfiumModule.pdfium.getValue(b,"i8"),R=this.pdfiumModule.pdfium.getValue(p,"i8"),U=v?this.pdfiumModule.pdfium.getValue(M,"float"):0,V=C?this.pdfiumModule.pdfium.getValue(E,"float"):0,$=R?this.pdfiumModule.pdfium.getValue(G,"float"):0;return this.memoryManager.free(P),this.memoryManager.free(b),this.memoryManager.free(p),this.memoryManager.free(M),this.memoryManager.free(E),this.memoryManager.free(G),{pageIndex:o,zoom:{mode:m,params:{x:U,y:V,zoom:$}},view:_}}return this.memoryManager.free(P),this.memoryManager.free(b),this.memoryManager.free(p),this.memoryManager.free(M),this.memoryManager.free(E),this.memoryManager.free(G),{pageIndex:o,zoom:{mode:m,params:{x:0,y:0,zoom:0}},view:_}}return{pageIndex:o,zoom:{mode:m},view:_}}readPdfAttachment(r,t){const o=this.pdfiumModule.FPDFDoc_GetAttachment(r,t),e=se(this.pdfiumModule.pdfium,(P,b)=>this.pdfiumModule.FPDFAttachment_GetName(o,P,b),this.pdfiumModule.pdfium.UTF16ToString),u=se(this.pdfiumModule.pdfium,(P,b)=>this.pdfiumModule.EPDFAttachment_GetDescription(o,P,b),this.pdfiumModule.pdfium.UTF16ToString),m=se(this.pdfiumModule.pdfium,(P,b)=>this.pdfiumModule.FPDFAttachment_GetSubtype(o,P,b),this.pdfiumModule.pdfium.UTF16ToString),d=this.getAttachmentDate(o,"CreationDate"),_=se(this.pdfiumModule.pdfium,(P,b)=>this.pdfiumModule.FPDFAttachment_GetStringValue(o,"Checksum",P,b),this.pdfiumModule.pdfium.UTF16ToString);return{index:t,name:e,description:u,mimeType:m,size:this.getAttachmentNumber(o,"Size"),creationDate:d,checksum:_}}convertDevicePointToPagePoint(r,t){const o=r.size.width,e=r.size.height,u=3&r.rotation;return u===0?{x:t.x,y:e-t.y}:u===1?{x:t.y,y:t.x}:u===2?{x:o-t.x,y:t.y}:{x:e-t.y,y:o-t.x}}convertPagePointToDevicePoint(r,t){const o=r.size.width,e=r.size.height,u=3&r.rotation;return u===0?{x:t.x,y:e-t.y}:u===1?{x:t.y,y:t.x}:u===2?{x:o-t.x,y:t.y}:{x:o-t.y,y:e-t.x}}convertPageRectToDeviceRect(r,t){const{x:o,y:e}=this.convertPagePointToDevicePoint(r,{x:t.left,y:t.top});return{origin:{x:o,y:e},size:{width:Math.abs(t.right-t.left),height:Math.abs(t.top-t.bottom)}}}readPageAnnoAppearanceStreams(r){return{normal:this.readPageAnnoAppearanceStream(r,Je.Normal),rollover:this.readPageAnnoAppearanceStream(r,Je.Rollover),down:this.readPageAnnoAppearanceStream(r,Je.Down)}}readPageAnnoAppearanceStream(r,t=Je.Normal){const o=2*(this.pdfiumModule.FPDFAnnot_GetAP(r,t,0,0)+1),e=this.memoryManager.malloc(o);this.pdfiumModule.FPDFAnnot_GetAP(r,t,e,o);const u=this.pdfiumModule.pdfium.UTF16ToString(e);return this.memoryManager.free(e),u}setPageAnnoAppearanceStream(r,t=Je.Normal,o){const e=2*(o.length+1),u=this.memoryManager.malloc(e);try{return this.pdfiumModule.pdfium.stringToUTF16(o,u,e),!!this.pdfiumModule.FPDFAnnot_SetAP(r,t,u)}finally{this.memoryManager.free(u)}}setPageAnnoRect(r,t,o){const e=Math.floor(o.origin.x),u=Math.floor(o.origin.y),m=Math.floor(o.origin.x+o.size.width),d=Math.floor(o.origin.y+o.size.height),_=this.convertDevicePointToPagePoint(r,{x:e,y:u}),P=this.convertDevicePointToPagePoint(r,{x:m,y:u}),b=this.convertDevicePointToPagePoint(r,{x:m,y:d}),p=this.convertDevicePointToPagePoint(r,{x:e,y:d});let M=Math.min(_.x,P.x,b.x,p.x),E=Math.max(_.x,P.x,b.x,p.x),G=Math.min(_.y,P.y,b.y,p.y),v=Math.max(_.y,P.y,b.y,p.y);M>E&&([M,E]=[E,M]),G>v&&([G,v]=[v,G]);const C=this.memoryManager.malloc(16),R=this.pdfiumModule.pdfium;R.setValue(C+0,M,"float"),R.setValue(C+4,v,"float"),R.setValue(C+8,E,"float"),R.setValue(C+12,G,"float");const U=this.pdfiumModule.FPDFAnnot_SetRect(t,C);return this.memoryManager.free(C),!!U}readPageAnnoRect(r){const t=this.memoryManager.malloc(16),o={left:0,top:0,right:0,bottom:0};return this.pdfiumModule.FPDFAnnot_GetRect(r,t)&&(o.left=this.pdfiumModule.pdfium.getValue(t,"float"),o.top=this.pdfiumModule.pdfium.getValue(t+4,"float"),o.right=this.pdfiumModule.pdfium.getValue(t+8,"float"),o.bottom=this.pdfiumModule.pdfium.getValue(t+12,"float")),this.memoryManager.free(t),o}getHighlightRects(r,t,o,e){const u=this.pdfiumModule.FPDFText_CountRects(t,o,e),m=[],d=this.memoryManager.malloc(8),_=this.memoryManager.malloc(8),P=this.memoryManager.malloc(8),b=this.memoryManager.malloc(8);for(let p=0;p<u;p++){if(!this.pdfiumModule.FPDFText_GetRect(t,p,d,_,P,b))continue;const M=this.pdfiumModule.pdfium.getValue(d,"double"),E=this.pdfiumModule.pdfium.getValue(_,"double"),G=this.pdfiumModule.pdfium.getValue(P,"double"),v=this.pdfiumModule.pdfium.getValue(b,"double"),C=this.convertPagePointToDevicePoint(r,{x:M,y:E}),R=this.convertPagePointToDevicePoint(r,{x:G,y:E}),U=this.convertPagePointToDevicePoint(r,{x:G,y:v}),V=this.convertPagePointToDevicePoint(r,{x:M,y:v}),$=[C.x,R.x,U.x,V.x],X=[C.y,R.y,U.y,V.y],oe=Math.min(...$),O=Math.min(...X),K=Math.max(...$)-oe,ue=Math.max(...X)-O;m.push({origin:{x:oe,y:O},size:{width:Math.ceil(K),height:Math.ceil(ue)}})}return this.memoryManager.free(d),this.memoryManager.free(_),this.memoryManager.free(P),this.memoryManager.free(b),m}searchInPage(r,t,o,e){this.logger.debug(h,D,"searchInPage",r,t,o,e),this.logger.perf(h,D,"SearchInPage","Begin",`${r.id}-${t.index}`);const u=this.cache.getContext(r.id);if(!u)return this.logger.perf(h,D,"PreparePrintDocument","End",r.id),y.reject({code:x.DocNotOpen,message:"Document is not open"});const m=2*(o.length+1),d=this.memoryManager.malloc(m);this.pdfiumModule.pdfium.stringToUTF16(o,d,m);try{const _=this.searchAllInPage(u,t,d,e);return y.resolve(_)}finally{this.memoryManager.free(d)}}getAnnotationsBatch(r,t){this.logger.debug(h,D,"getAnnotationsBatch",r.id,t.length);const o=new lt;return queueMicrotask(()=>{this.logger.perf(h,D,"GetAnnotationsBatch","Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return void o.reject({code:x.DocNotOpen,message:"Document is not open"});const u={},m=t.length;for(let d=0;d<t.length;d++){const _=t[d],P=this.readPageAnnotationsRaw(e,_);u[_.index]=P,o.progress({pageIndex:_.index,result:P,completed:d+1,total:m})}this.logger.perf(h,D,"GetAnnotationsBatch","End",r.id),o.resolve(u)}),o}searchBatch(r,t,o,e){this.logger.debug(h,D,"searchBatch",r.id,t.length,o);const u=new lt;return queueMicrotask(()=>{this.logger.perf(h,D,"SearchBatch","Begin",r.id);const m=this.cache.getContext(r.id);if(!m)return void u.reject({code:x.DocNotOpen,message:"Document is not open"});const d=2*(o.length+1),_=this.memoryManager.malloc(d);this.pdfiumModule.pdfium.stringToUTF16(o,_,d);try{const P={},b=t.length;for(let p=0;p<t.length;p++){const M=t[p],E=this.searchAllInPage(m,M,_,e);P[M.index]=E,u.progress({pageIndex:M.index,result:E,completed:p+1,total:b})}this.logger.perf(h,D,"SearchBatch","End",r.id),u.resolve(P)}finally{this.memoryManager.free(_)}}),u}buildContext(r,t,o,e=30){const u=/[\s\u00A0.,;:!?()\[\]{}<>/\\\-"'`"\u2013\u2014]/;let m=t;for(;m>0&&u.test(r[m-1]);)m--;let d=0;for(;m>0&&d<e;)m--,u.test(r[m])||d++;m=(M=>{for(;M>0&&!u.test(r[M-1]);)M--;return M})(m);let _=t+o;for(;_<r.length&&u.test(r[_]);)_++;for(d=0;_<r.length&&d<e;)u.test(r[_])||d++,_++;_=(M=>{for(;M<r.length&&!u.test(r[M]);)M++;return M})(_);const P=r.slice(m,t).replace(/\s+/g," ").trimStart(),b=r.slice(t,t+o),p=r.slice(t+o,_).replace(/\s+/g," ").trimEnd();return{before:this.tidy(P),match:this.tidy(b),after:this.tidy(p),truncatedLeft:m>0,truncatedRight:_<r.length}}tidy(r){return r.replace(/-\uFFFE\s*/g,"").replace(/[\uFFFE\u00AD\u200B\u2060\uFEFF]/g,"").replace(/\s+/g," ")}searchAllInPage(r,t,o,e){return r.borrowPage(t.index,u=>{const m=u.getTextPage(),d=this.pdfiumModule.FPDFText_CountChars(m),_=this.memoryManager.malloc(2*(d+1));this.pdfiumModule.FPDFText_GetText(m,0,d,_);const P=this.pdfiumModule.pdfium.UTF16ToString(_);this.memoryManager.free(_);const b=[],p=this.pdfiumModule.FPDFText_FindStart(m,o,e,0);for(;this.pdfiumModule.FPDFText_FindNext(p);){const M=this.pdfiumModule.FPDFText_GetSchResultIndex(p),E=this.pdfiumModule.FPDFText_GetSchCount(p),G=this.getHighlightRects(t,m,M,E),v=this.buildContext(P,M,E);b.push({pageIndex:t.index,charIndex:M,charCount:E,rects:G,context:v})}return this.pdfiumModule.FPDFText_FindClose(p),b})}preparePrintDocument(r,t){const{includeAnnotations:o=!0,pageRange:e=null}=t??{};this.logger.debug(h,D,"preparePrintDocument",r,t),this.logger.perf(h,D,"PreparePrintDocument","Begin",r.id);const u=this.cache.getContext(r.id);if(!u)return this.logger.perf(h,D,"PreparePrintDocument","End",r.id),y.reject({code:x.DocNotOpen,message:"Document is not open"});const m=this.pdfiumModule.FPDF_CreateNewDocument();if(!m)return this.logger.perf(h,D,"PreparePrintDocument","End",r.id),y.reject({code:x.CantCreateNewDoc,message:"Cannot create print document"});try{const d=this.sanitizePageRange(e,r.pageCount);if(!this.pdfiumModule.FPDF_ImportPages(m,u.docPtr,d??"",0))return this.pdfiumModule.FPDF_CloseDocument(m),this.logger.error(h,D,"Failed to import pages for printing"),this.logger.perf(h,D,"PreparePrintDocument","End",r.id),y.reject({code:x.CantImportPages,message:"Failed to import pages for printing"});if(!o){const P=this.removeAnnotationsFromPrintDocument(m);if(!P.success)return this.pdfiumModule.FPDF_CloseDocument(m),this.logger.error(h,D,`Failed to remove annotations: ${P.error}`),this.logger.perf(h,D,"PreparePrintDocument","End",r.id),y.reject({code:x.Unknown,message:`Failed to prepare print document: ${P.error}`});this.logger.debug(h,D,`Removed ${P.annotationsRemoved} annotations from ${P.pagesProcessed} pages`)}const _=this.saveDocument(m);return this.pdfiumModule.FPDF_CloseDocument(m),this.logger.perf(h,D,"PreparePrintDocument","End",r.id),y.resolve(_)}catch(d){return m&&this.pdfiumModule.FPDF_CloseDocument(m),this.logger.error(h,D,"preparePrintDocument failed",d),this.logger.perf(h,D,"PreparePrintDocument","End",r.id),y.reject({code:x.Unknown,message:d instanceof Error?d.message:"Failed to prepare print document"})}}removeAnnotationsFromPrintDocument(r){let t=0,o=0;try{const e=this.pdfiumModule.FPDF_GetPageCount(r);for(let u=0;u<e;u++){const m=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(r,u);if(m<=0){o++;continue}let d=0;for(let _=m-1;_>=0;_--)this.pdfiumModule.EPDFPage_RemoveAnnotRaw(r,u,_)?(d++,t++):this.logger.warn(h,D,`Failed to remove annotation ${_} from page ${u}`);if(d>0){const _=this.pdfiumModule.FPDF_LoadPage(r,u);_&&(this.pdfiumModule.FPDFPage_GenerateContent(_),this.pdfiumModule.FPDF_ClosePage(_))}o++}return{success:!0,annotationsRemoved:t,pagesProcessed:o}}catch(e){return{success:!1,annotationsRemoved:t,pagesProcessed:o,error:e instanceof Error?e.message:"Unknown error during annotation removal"}}}sanitizePageRange(r,t){if(!r||r.trim()==="")return null;try{const o=[],e=r.split(",");for(const P of e){const b=P.trim();if(b.includes("-")){const[p,M]=b.split("-").map(R=>R.trim()),E=parseInt(p,10),G=parseInt(M,10);if(isNaN(E)||isNaN(G)){this.logger.warn(h,D,`Invalid range: ${b}`);continue}const v=Math.max(1,Math.min(E,t)),C=Math.max(1,Math.min(G,t));for(let R=v;R<=C;R++)o.includes(R)||o.push(R)}else{const p=parseInt(b,10);if(isNaN(p)){this.logger.warn(h,D,`Invalid page number: ${b}`);continue}const M=Math.max(1,Math.min(p,t));o.includes(M)||o.push(M)}}if(o.length===0)return this.logger.warn(h,D,"No valid pages in range, using all pages"),null;o.sort((P,b)=>P-b);const u=[];let m=o[0],d=o[0];for(let P=1;P<o.length;P++)o[P]===d+1||(m===d?u.push(m.toString()):d-m===1?(u.push(m.toString()),u.push(d.toString())):u.push(`${m}-${d}`),m=o[P]),d=o[P];m===d?u.push(m.toString()):d-m===1?(u.push(m.toString()),u.push(d.toString())):u.push(`${m}-${d}`);const _=u.join(",");return this.logger.debug(h,D,`Sanitized page range: "${r}" -> "${_}"`),_}catch(o){return this.logger.error(h,D,`Error sanitizing page range: ${o}`),null}}}async function Hn(H,r){const t=await fetch(H),o=await t.arrayBuffer(),e=await vn({wasmBinary:o}),u=new Vn(e,{logger:r?.logger,fontFallback:r?.fontFallback});return new Cn(u,{imageConverter:Tn,logger:r?.logger})}export{Hn as createPdfiumEngine};

import{r as l,u as T,j as e,a as E}from"./app-BOmU1wmL.js";import{S as k,I as H,C as I}from"./form-Cdl3Pe45.js";import{B as F}from"./button-BXeYMGgI.js";import{C as K,a as z,b as J,c as Q,d as W,e as X}from"./command-0ugShPvD.js";import{L as b}from"./label-dU9c1Gas.js";import{P as Z,a as ee,b as te}from"./popover-CW35KCFR.js";import{S as A}from"./spinner--AHlGxP7.js";import{T as re}from"./teacher-layouts-Ur2cbxUY.js";import{a as ie}from"./tasks-WJQL2uDA.js";import{O as ae,P as oe,u as se,l as le}from"./type-DDACwUq3.js";import{c as ne}from"./utils-e8IeQt0G.js";import{u as de,b as me}from"./index-D-fKvoRm.js";import ce from"./text-editor-BRyy4XKm.js";import{o as B,K as $,a as S,n as O,L as w,$ as ue,b as pe,_ as fe}from"./render-DLF3xvZl.js";import{C as xe}from"./chevrons-up-down-yk-dcHpn.js";import{C as he}from"./check-D2RIYBP2.js";import"./app-VvtKnDwK.js";import"./index-sq8JxwLA.js";import"./index-CtUadT9n.js";import"./index-CyaJm5Nq.js";import"./index-CTyL-A3x.js";import"./index-DdNxHDY2.js";import"./index-BdIQ-kbR.js";import"./index-CXwkwjvO.js";import"./index-C6gdkV91.js";import"./search-CS9TKoj2.js";import"./createLucideIcon-DUOuwx2-.js";import"./index-B-fAkSq4.js";import"./index-DTrOkFw6.js";import"./page-banner-C7OHPqMr.js";import"./index-BqTge0le.js";import"./index-CMWG4mbA.js";import"./index-fxZgv_cA.js";import"./iconBase-CPalTnLO.js";import"./arrow-left-CgAHiiqU.js";import"./app-logo-icon-CK9aNDB_.js";import"./user-profile-trigger-BYgeGczA.js";import"./sun-B3Xv17I3.js";import"./avatar-CufrlqXh.js";import"./avatar-fallback-BjXZxSaF.js";import"./use-initials-GDEZD6-s.js";import"./divider-BBgeuDb2.js";import"./profile-svg-Bwy5UQEi.js";import"./dropdown-menu-DRIWHMxB.js";import"./index-BwiOEFi6.js";import"./index-XA1OJB6Q.js";import"./index-1aSE4XS9.js";import"./logout-user-HcNmiAIC.js";import"./index-wHDUIrgA.js";import"./index-v3lNCs8j.js";import"./index-DGvaH1zc.js";import"./log-out-BmohMvgA.js";import"./index-8GFiKN7D.js";import"./index-DMEIf3eg.js";import"./index-B5Wz6g3U.js";import"./index-088ta_6r.js";import"./index-BhKAPyE2.js";import"./index-DH9SVvWg.js";import"./index-CJeVcETn.js";import"./index-CU8SWGOj.js";import"./index-BD3HuK-g.js";import"./index-C4OL-TuX.js";import"./index-Bwrcs2qz.js";import"./index-DerrCcFj.js";import"./index-D_EaEfK3.js";import"./index-oCkK5fXa.js";import"./index-CKQT5-Tp.js";import"./gauge-04CtoFE8.js";import"./calendar-B0CvDZ_G.js";import"./settings-Ch-IO4g_.js";import"./x-Cxqud0xV.js";import"./menu-VI9xwiLb.js";import"./lexical-headless-CJI_HsZI.js";import"./nodes-CImg-T9u.js";import"./editor-CO3KJCTx.js";import"./tooltip-B-9YRlG5.js";import"./index-Bs-2WC09.js";import"./content-editable-zq9nIIPc.js";import"./dialog-4kNTCLrK.js";import"./input-BasXNOLM.js";import"./trash-ZyzuEw0V.js";import"./separator-C2_OsKSl.js";import"./index-CaVr11ya.js";import"./index-CBdR2yVO.js";import"./chevron-up-CD7H7HTg.js";import"./chevron-down-Cr3D6SAa.js";import"./list-DNO3BUta.js";import"./image-BFEHe2fM.js";let ve=l.createContext(void 0);function Y(){return l.useContext(ve)}function ge(r){return typeof r!="object"||r===null?!1:"nodeType"in r}function q(r){return ge(r)&&"tagName"in r}function R(r){return q(r)&&"accessKey"in r}function be(r){return R(r)&&r.nodeName==="INPUT"}function M(r){return R(r)&&r.nodeName==="LABEL"}function je(r){return q(r)?r.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]'):!1}let ye=Symbol();function U(...r){let s=l.useRef(r);l.useEffect(()=>{s.current=r},[r]);let t=B(a=>{for(let o of s.current)o!=null&&(typeof o=="function"?o(a):o.current=a)});return r.every(a=>a==null||a?.[ye])?void 0:t}let D=l.createContext(null);D.displayName="DescriptionContext";function V(){let r=l.useContext(D);if(r===null){let s=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(s,V),s}return r}function Ne(){var r,s;return(s=(r=l.useContext(D))==null?void 0:r.value)!=null?s:void 0}let Ce="p";function _e(r,s){let t=l.useId(),a=S(),{id:o=`headlessui-description-${t}`,...m}=r,n=V(),c=U(s);O(()=>n.register(o),[o,n.register]);let u=a||!1,v=l.useMemo(()=>({...n.slot,disabled:u}),[n.slot,u]),p={ref:c,...n.props,id:o};return w()({ourProps:p,theirProps:m,slot:v,defaultTag:Ce,name:n.name||"Description"})}let ke=$(_e);Object.assign(ke,{});let P=l.createContext(null);P.displayName="LabelContext";function G(){let r=l.useContext(P);if(r===null){let s=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(s,G),s}return r}function Te(r){var s,t,a;let o=(t=(s=l.useContext(P))==null?void 0:s.value)!=null?t:void 0;return((a=void 0)!=null?a:0)>0?[o,...r].filter(Boolean).join(" "):o}let Fe="label";function $e(r,s){var t;let a=l.useId(),o=G(),m=Y(),n=S(),{id:c=`headlessui-label-${a}`,htmlFor:u=m??((t=o.props)==null?void 0:t.htmlFor),passive:v=!1,...p}=r,j=U(s);O(()=>o.register(c),[c,o.register]);let f=B(x=>{let g=x.currentTarget;if(!(x.target!==x.currentTarget&&je(x.target))&&(M(g)&&x.preventDefault(),o.props&&"onClick"in o.props&&typeof o.props.onClick=="function"&&o.props.onClick(x),M(g))){let d=document.getElementById(g.htmlFor);if(d){let _=d.getAttribute("disabled");if(_==="true"||_==="")return;let i=d.getAttribute("aria-disabled");if(i==="true"||i==="")return;(be(d)&&(d.type==="file"||d.type==="radio"||d.type==="checkbox")||d.role==="radio"||d.role==="checkbox"||d.role==="switch")&&d.click(),d.focus({preventScroll:!0})}}}),N=n||!1,C=l.useMemo(()=>({...o.slot,disabled:N}),[o.slot,N]),h={ref:j,...o.props,id:c,htmlFor:u,onClick:f};return v&&("onClick"in h&&(delete h.htmlFor,delete h.onClick),"onClick"in p&&delete p.onClick),w()({ourProps:h,theirProps:p,slot:C,defaultTag:u?Fe:"div",name:o.name||"Label"})}let Se=$($e);Object.assign(Se,{});let we="input";function De(r,s){let t=l.useId(),a=Y(),o=S(),{id:m=a||`headlessui-input-${t}`,disabled:n=o||!1,autoFocus:c=!1,invalid:u=!1,...v}=r,p=Te(),j=Ne(),{isFocused:f,focusProps:N}=ue({autoFocus:c}),{isHovered:C,hoverProps:h}=pe({isDisabled:n}),x=fe({ref:s,id:m,"aria-labelledby":p,"aria-describedby":j,"aria-invalid":u?"true":void 0,disabled:n||void 0,autoFocus:c},N,h),g=l.useMemo(()=>({disabled:n,invalid:u,hover:C,focus:f,autofocus:c}),[n,u,C,f,c]);return w()({ourProps:x,theirProps:v,slot:g,defaultTag:we,name:"Input"})}let Pe=$(De);function pr(){const{errors:r}=T().props,{domaines:s}=T().props,{course:t}=T().props,[a,o]=l.useState({title:t!==void 0?t.title:"",price:t!==void 0?t.price:"",level:t!==void 0?t.level:"",language:t!==void 0?t.language:"fr",course_type:t!==void 0?t.course_type:"",modality:t!==void 0?t.modality:"",academic_year:t!==void 0?t.academic_year:"",description:t!==void 0?t.description:"",cover:null,domaine_id:t!==void 0?t.domaine_id:"",estimated_days:t!==void 0?t.estimated_days:"",total_hours:t!==void 0?t.total_hours:"",start_date:t!==void 0?t.start_date:"",is_free:t==null?0:t.is_free===1,is_certifying:t==null?0:t.is_certifying===1,estimated_weeks:t!==void 0?t.estimated_weeks:""});function m(i){i.preventDefault(),o({...a,[i.target.name]:i.target.value})}function n(i){i.preventDefault(),o({...a,[i.target.name]:i.target.value})}function c(i){i.preventDefault(),o({...a,[i.target.name]:i.target.files==null?null:i.target.files[0]})}const[u,v]=l.useState(!1),[p,j]=l.useState(!1),[f,N]=l.useState(t!=null&&t.domaine_id!=null?t.domaine_id:0);function C(i){i.preventDefault(),h()}function h(){j(!0);async function i(){try{const y=t!=null?t.id:0;await ie(y).then(()=>{const L={...a,_method:t==null?"post":"put"};t!=null?E.post(de(t.id),L,{forceFormData:!0,onFinish:()=>j(!1)}):E.post(me(),L,{forceFormData:!0,onFinish:()=>j(!1)})})}catch(y){console.error("Failed to convert editor state to HTML",y)}}i()}function x(i){i.preventDefault(),h()}const g=[],d=new Date().getFullYear();for(let i=d;i>=d-10;i--)g.push(`${i}-${i+1}`);const _=a.description&&a.title&&a.price&&a.total_hours&&a.academic_year&&a.course_type&&a.level&&a.modality;return e.jsx(re,{title:t==null?"Ajouter un cours":`Modifier ${t.title}`,children:e.jsxs("div",{className:"mx-auto p-5 shadow md:max-w-4xl",children:[e.jsxs("div",{className:"mb-5 flex items-center justify-between border-b p-3",children:[e.jsx("h1",{className:"text-2xl font-bold",children:t==null?"Ajouter un cours":"Modifier le cours"}),e.jsxs(F,{className:"btn-primary",disabled:p||!_,onClick:x,children:[p&&e.jsx(A,{}),"Enregistrer"]})]}),e.jsxs("form",{className:"mb-5",method:"POST",id:"submitForm",encType:"multipart/form-data",onSubmit:C,children:[e.jsx(Pe,{type:"hidden",name:"domaine_id",id:"domaine_id",value:f===0?"":f,onChange:m}),e.jsxs("div",{className:"grid grid-cols-1 items-start gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{className:"mb-2 block font-medium text-gray-700",children:"Domaine du cours"}),e.jsxs(Z,{open:u,onOpenChange:v,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(F,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[f?s.find(i=>i.id===f)?.name:"Sélectionner un domaine...",e.jsx(xe,{className:"opacity-50"})]})}),e.jsx(te,{className:"w-full p-0",align:"start",children:e.jsxs(K,{children:[e.jsx(z,{placeholder:"Rechercher un domaine...",className:"h-9"}),e.jsxs(J,{children:[e.jsx(Q,{children:"Pas de domaine trouvée."}),e.jsx(W,{children:s.map(i=>e.jsxs(X,{value:`${i.id}`,onSelect:y=>{N(y===f.toFixed()?0:parseInt(y)),o({...a,domaine_id:y}),v(!1)},children:[i.name,e.jsx(he,{className:ne("ml-auto",f===i.id?"opacity-100":"opacity-0")})]},i.id))})]})]})})]})]}),e.jsx("div",{className:"grid gap-2",children:e.jsx(k,{label:"Année Scolaire",value:a.academic_year??"",onChange:i=>o({...a,academic_year:i}),required:!0,options:g.map(i=>({key:i,value:i})),error:r.academic_year})}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{className:"mb-2 block font-medium text-gray-700",children:"Titre du cours"}),e.jsx("input",{type:"text",className:"form-input",name:"title",placeholder:"Titre du cours",value:a.title,onChange:m,id:""}),e.jsx("p",{className:"text-xs text-red-500",children:r.title})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{className:"mb-2 block font-medium text-gray-700",children:"Prix du cours"}),e.jsx("input",{type:"number",className:"form-input",name:"price",value:a.price,placeholder:"Prix du cours",onChange:m,id:""}),e.jsx("p",{className:"text-xs text-red-500",children:r.price})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{className:"mb-2 block font-medium text-gray-700",children:"Durée en heure"}),e.jsx("input",{type:"number",className:"form-input",name:"total_hours",value:a.total_hours??"",placeholder:"Durée de la formation en heure",onChange:m,id:""}),e.jsx("p",{className:"text-xs text-red-500",children:r.total_hours})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{className:"mb-2 block font-medium text-gray-700",children:"Estimation en jours"}),e.jsx("input",{type:"number",className:"form-input",name:"estimated_days",value:a.estimated_days??"",placeholder:"Durée estimée en jours",onChange:m,id:""}),e.jsx("p",{className:"text-xs text-red-500",children:r.estimated_days})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{className:"mb-2 block font-medium text-gray-700",children:"Estimation en semaine"}),e.jsx("input",{type:"number",className:"form-input",name:"estimated_weeks",value:a.estimated_weeks??"",placeholder:"Durée estimée en semaine",onChange:m,id:""}),e.jsx("p",{className:"text-xs text-red-500",children:r.estimated_weeks})]}),e.jsx("div",{className:"grid gap-2",children:e.jsx(k,{label:"Type de cours",value:a.course_type??"",onChange:i=>o({...a,course_type:i}),required:!0,options:ae,error:r.course_type})}),e.jsx("div",{className:"grid gap-2",children:e.jsx(k,{label:"Niveau du cours",value:a.level??"",onChange:i=>o({...a,level:i}),required:!0,options:oe,error:r.level})}),e.jsx("div",{className:"grid gap-2",children:e.jsx(k,{label:"Modalité",value:a.modality??"",onChange:i=>o({...a,modality:i}),required:!0,options:se,error:r.modality})}),e.jsx("div",{className:"grid gap-2",children:e.jsx(k,{label:"Langue du cours",value:a.language??"",onChange:i=>o({...a,language:i}),options:le,error:r.language})}),e.jsx("div",{className:"grid gap-2",children:e.jsx(H,{label:"Date du début",type:"date",value:a.start_date??"",onChange:i=>o({...a,start_date:i}),error:r.start_date})}),e.jsxs("div",{className:"grid gap-2 md:col-span-2",children:[e.jsx(b,{className:"mb-2 block font-medium text-gray-700",children:"Petite description"}),e.jsx("textarea",{name:"description",className:"form-input",id:"",placeholder:"Petite descitpion",onChange:n,defaultValue:a.description??""}),e.jsx("p",{className:"text-xs text-red-500",children:r.description})]}),e.jsx("div",{className:"grid gap-2",children:e.jsx(I,{label:"Cours gratuit?",checked:a.is_free==1,onChange:i=>o({...a,is_free:i})})}),e.jsx("div",{className:"grid gap-2",children:e.jsx(I,{label:"Cours Certifiant?",checked:a.is_certifying==1,onChange:i=>o({...a,is_certifying:i})})}),e.jsxs("div",{className:"grid gap-2 md:col-span-2",children:[e.jsx(b,{className:"mb-2 block font-medium text-gray-700",children:"Image de couverture"}),t!=null&&t.cover_url!=null&&e.jsx("div",{className:"my-3",children:e.jsx("a",{href:t.cover_url,children:e.jsx("img",{src:t.cover_url,className:"max-h-[200px] w-full object-cover",alt:""})})}),e.jsx("input",{type:"file",className:"form-input",name:"cover",id:"",onChange:c}),e.jsx("p",{className:"text-xs text-red-500",children:r.cover})]})]}),e.jsxs("div",{className:"my-4",children:[e.jsx("h3",{className:"mb-3 text-2xl font-semibold",children:"Syllabus du cours"}),e.jsx(ce,{isNew:t==null}),e.jsx("p",{className:"text-xs text-red-500",children:r.syllabus})]}),e.jsxs(F,{type:"submit",className:"btn-primary mt-4 w-full",tabIndex:4,disabled:p||!_,"data-test":"create-category-button",children:[p&&e.jsx(A,{}),"Enregistrer le cours"]})]})]})})}export{pr as default};
